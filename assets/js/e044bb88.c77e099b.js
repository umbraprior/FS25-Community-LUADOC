"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[99404],{28453(e,n,r){r.d(n,{R:()=>t,x:()=>a});var l=r(96540);const i={},s=l.createContext(i);function t(e){const n=l.useContext(s);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),l.createElement(s.Provider,{value:n},e.children)}},94296(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"script/Specializations/PlaceableBuyable","title":"PlaceableBuyable","description":"PlaceableBuyable","source":"@site/../docs/script/Specializations/PlaceableBuyable.md","sourceDirName":"script/Specializations","slug":"/script/Specializations/PlaceableBuyable","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableBuyable","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"PlaceableBunkerSilo","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableBunkerSilo"},"next":{"title":"PlaceableBuyingStation","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableBuyingStation"}}');var i=r(74848),s=r(28453);const t={},a=void 0,c={},d=[{value:"PlaceableBuyable",id:"placeablebuyable",level:2},{value:"buyRequest",id:"buyrequest",level:3},{value:"onBuyingTriggerCallback",id:"onbuyingtriggercallback",level:3},{value:"onDelete",id:"ondelete",level:3},{value:"onLoad",id:"onload",level:3},{value:"prerequisitesPresent",id:"prerequisitespresent",level:3},{value:"registerEventListeners",id:"registereventlisteners",level:3},{value:"registerFunctions",id:"registerfunctions",level:3},{value:"registerOverwrittenFunctions",id:"registeroverwrittenfunctions",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"setOwnerFarmId",id:"setownerfarmid",level:3}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"placeablebuyable",children:"PlaceableBuyable"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Specialization for placeables"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Functions"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#buyrequest",children:"buyRequest"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onbuyingtriggercallback",children:"onBuyingTriggerCallback"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#ondelete",children:"onDelete"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onload",children:"onLoad"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#prerequisitespresent",children:"prerequisitesPresent"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registereventlisteners",children:"registerEventListeners"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registerfunctions",children:"registerFunctions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registeroverwrittenfunctions",children:"registerOverwrittenFunctions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#setownerfarmid",children:"setOwnerFarmId"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"buyrequest",children:"buyRequest"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"buyRequest()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"requestCallback"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"target"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableBuyable:buyRequest(requestCallback, target)\n    if g_guidedTourManager:getIsTourRunning() then\n        InfoDialog.show(g_i18n:getText( "guidedTour_feature_deactivated" ))\n        return\n    end\n\n    local playerFarmId = g_currentMission:getFarmId()\n\n    local price = self:getPrice()\n    if self.buysFarmland then\n        local farmlandId = self:getFarmlandId()\n        local farmland = g_farmlandManager:getFarmlandById(farmlandId)\n        if farmland ~ = nil and g_farmlandManager:getFarmlandOwner(farmlandId) ~ = playerFarmId then\n            price = price + farmland.price * self.buysFarmlandPriceScale\n        end\n    end\n\n    local placeable = self\n    local buyingEventCallback = function (statusCode)\n        if statusCode ~ = nil then\n            local dialogArgs = BuyExistingPlaceableEvent.DIALOG_MESSAGES[statusCode]\n            if dialogArgs ~ = nil then\n                InfoDialog.show(g_i18n:getText(dialogArgs.text), nil , nil , dialogArgs.dialogType)\n            end\n        end\n        g_messageCenter:unsubscribe(BuyExistingPlaceableEvent, placeable)\n\n        placeable:onBuy()\n    end\n\n    local dialogCallback = function (yes)\n        if yes then\n            g_messageCenter:subscribe(BuyExistingPlaceableEvent, buyingEventCallback)\n\n            g_client:getServerConnection():sendEvent(BuyExistingPlaceableEvent.new( self , playerFarmId))\n        end\n\n        if requestCallback ~ = nil then\n            if target ~ = nil then\n                target:requestCallback(yes)\n            else\n                    requestCallback(yes)\n                end\n            end\n        end\n\n        YesNoDialog.show(dialogCallback, nil , string.format(g_i18n:getText( "dialog_buyBuildingFor" ), self:getName(), g_i18n:formatMoney(price, 0 , true )))\n    end\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"onbuyingtriggercallback",children:"onBuyingTriggerCallback"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onBuyingTriggerCallback()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"triggerId"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"otherId"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"onEnter"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"onLeave"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"onStay"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"otherShapeId"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function PlaceableBuyable:onBuyingTriggerCallback(triggerId, otherId, onEnter, onLeave, onStay, otherShapeId)\n    if onEnter or onLeave then\n        if g_localPlayer and g_localPlayer.rootNode = = otherId then\n            local spec = self.spec_buyable\n            if onEnter and spec.isTriggerActive then\n                -- automatically perform action without manual activation on mobile\n                if Platform.gameplay.autoActivateTrigger and spec.activatable:getIsActivatable() then\n                    spec.activatable:run()\n                    return\n                end\n\n                g_currentMission.activatableObjectsSystem:addActivatable(spec.activatable)\n            end\n            if onLeave then\n                g_currentMission.activatableObjectsSystem:removeActivatable(spec.activatable)\n            end\n        end\n    end\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"ondelete",children:"onDelete"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onDelete()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function PlaceableBuyable:onDelete()\n    local spec = self.spec_buyable\n\n    g_currentMission.activatableObjectsSystem:removeActivatable(spec.activatable)\n    spec.activatable = nil\n\n    if spec.markerNode ~ = nil then\n        g_currentMission:removeTriggerMarker(spec.markerNode)\n    end\n\n    if spec.triggerNode ~ = nil then\n        removeTrigger(spec.triggerNode)\n    end\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"onload",children:"onLoad"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Called on loading"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onLoad(table savegame)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table"}),(0,i.jsx)(n.th,{children:"savegame"}),(0,i.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableBuyable:onLoad(savegame)\n    local spec = self.spec_buyable\n\n    spec.activatable = BuyBuildingActivatable.new( self )\n\n    spec.triggerNode = self.xmlFile:getValue( "placeable.buyable.trigger#node" , nil , self.components, self.i3dMappings)\n    if spec.triggerNode ~ = nil then\n        addTrigger(spec.triggerNode, "onBuyingTriggerCallback" , self )\n    end\n\n    spec.markerNode = self.xmlFile:getValue( "placeable.buyable.marker#node" , nil , self.components, self.i3dMappings)\n    spec.isTriggerActive = true\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"prerequisitespresent",children:"prerequisitesPresent"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Checks if all prerequisite specializations are loaded"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"prerequisitesPresent(table specializations)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table"}),(0,i.jsx)(n.th,{children:"specializations"}),(0,i.jsx)(n.th,{children:"specializations"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table"}),(0,i.jsx)(n.th,{children:"hasPrerequisite"}),(0,i.jsx)(n.th,{children:"true if all prerequisite specializations are loaded"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function PlaceableBuyable.prerequisitesPresent(specializations)\n    return true\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"registereventlisteners",children:"registerEventListeners"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerEventListeners()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableBuyable.registerEventListeners(placeableType)\n    SpecializationUtil.registerEventListener(placeableType, "onLoad" , PlaceableBuyable )\n    SpecializationUtil.registerEventListener(placeableType, "onDelete" , PlaceableBuyable )\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registerfunctions",children:"registerFunctions"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerFunctions()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableBuyable.registerFunctions(placeableType)\n    SpecializationUtil.registerFunction(placeableType, "onBuyingTriggerCallback" , PlaceableBuyable.onBuyingTriggerCallback)\n    SpecializationUtil.registerFunction(placeableType, "setIsBuyingTriggerActive" , PlaceableBuyable.setIsBuyingTriggerActive)\n    SpecializationUtil.registerFunction(placeableType, "buyRequest" , PlaceableBuyable.buyRequest)\n    SpecializationUtil.registerFunction(placeableType, "getHasBuyingTrigger" , PlaceableBuyable.getHasBuyingTrigger)\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registeroverwrittenfunctions",children:"registerOverwrittenFunctions"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerOverwrittenFunctions()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableBuyable.registerOverwrittenFunctions(placeableType)\n    SpecializationUtil.registerOverwrittenFunction(placeableType, "setOwnerFarmId" , PlaceableBuyable.setOwnerFarmId)\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"schema"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"basePath"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableBuyable.registerXMLPaths(schema, basePath)\n    schema:setXMLSpecializationType( "Buyable" )\n    schema:register(XMLValueType.NODE_INDEX, basePath .. ".buyable.trigger#node" , "Buying trigger" , nil , false )\n    schema:register(XMLValueType.NODE_INDEX, basePath .. ".buyable.marker#node" , "Marker node" , nil , false )\n    schema:setXMLSpecializationType()\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"setownerfarmid",children:"setOwnerFarmId"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"setOwnerFarmId()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"superFunc"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"farmId"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"noEventSend"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function PlaceableBuyable:setOwnerFarmId(superFunc, farmId, noEventSend)\n    superFunc( self , farmId, noEventSend)\n\n    self:setIsBuyingTriggerActive(farmId = = AccessHandler.EVERYONE)\nend\n\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);