"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[96398],{28453(e,n,l){l.d(n,{R:()=>s,x:()=>r});var t=l(96540);const a={},i=t.createContext(a);function s(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(i.Provider,{value:n},e.children)}},98736(e,n,l){l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"script/Specializations/PlaceableGreenhouse","title":"PlaceableGreenhouse","description":"PlaceableGreenhouse","source":"@site/../docs/script/Specializations/PlaceableGreenhouse.md","sourceDirName":"script/Specializations","slug":"/script/Specializations/PlaceableGreenhouse","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableGreenhouse","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"PlaceableFoliageAreas","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableFoliageAreas"},"next":{"title":"PlaceableHeapSpawner","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableHeapSpawner"}}');var a=l(74848),i=l(28453);const s={},r=void 0,c={},d=[{value:"PlaceableGreenhouse",id:"placeablegreenhouse",level:2},{value:"addPlantPlace",id:"addplantplace",level:3},{value:"getRandomGrowthInterval",id:"getrandomgrowthinterval",level:3},{value:"getRandomWateringInterval",id:"getrandomwateringinterval",level:3},{value:"initSpecialization",id:"initspecialization",level:3},{value:"loadPlantFromXml",id:"loadplantfromxml",level:3},{value:"onDelete",id:"ondelete",level:3},{value:"onFinalizePlacement",id:"onfinalizeplacement",level:3},{value:"onLoad",id:"onload",level:3},{value:"onOutputFillTypesChanged",id:"onoutputfilltypeschanged",level:3},{value:"onProductionStatusChanged",id:"onproductionstatuschanged",level:3},{value:"onUpdate",id:"onupdate",level:3},{value:"plantI3DLoadedCallback",id:"planti3dloadedcallback",level:3},{value:"prerequisitesPresent",id:"prerequisitespresent",level:3},{value:"registerEventListeners",id:"registereventlisteners",level:3},{value:"registerFunctions",id:"registerfunctions",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"setPlantAtPlace",id:"setplantatplace",level:3},{value:"updatePlantDistribution",id:"updateplantdistribution",level:3},{value:"updatePlantsStage",id:"updateplantsstage",level:3}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"placeablegreenhouse",children:"PlaceableGreenhouse"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"Specialization for placeables"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Functions"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#addplantplace",children:"addPlantPlace"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#getrandomgrowthinterval",children:"getRandomGrowthInterval"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#getrandomwateringinterval",children:"getRandomWateringInterval"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#initspecialization",children:"initSpecialization"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#loadplantfromxml",children:"loadPlantFromXml"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#ondelete",children:"onDelete"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#onfinalizeplacement",children:"onFinalizePlacement"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#onload",children:"onLoad"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#onoutputfilltypeschanged",children:"onOutputFillTypesChanged"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#onproductionstatuschanged",children:"onProductionStatusChanged"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#onupdate",children:"onUpdate"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#planti3dloadedcallback",children:"plantI3DLoadedCallback"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#prerequisitespresent",children:"prerequisitesPresent"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#registereventlisteners",children:"registerEventListeners"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#registerfunctions",children:"registerFunctions"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#setplantatplace",children:"setPlantAtPlace"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#updateplantdistribution",children:"updatePlantDistribution"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#updateplantsstage",children:"updatePlantsStage"})}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"addplantplace",children:"addPlantPlace"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"addPlantPlace()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"node"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"useRandomYRot"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse:addPlantPlace(node, useRandomYRot)\n    local spec = self.spec_greenhouse\n\n    useRandomYRot = Utils.getNoNil(useRandomYRot, true )\n    if useRandomYRot then\n        setRotation(node, 0 , math.random() * math.pi * 2 , 0 )\n    end\n    table.insert(spec.plantPlaces, { node = node, fillType = nil , stage = nil } )\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"getrandomgrowthinterval",children:"getRandomGrowthInterval"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"getRandomGrowthInterval()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse.getRandomGrowthInterval()\n    return math.random( PlaceableGreenhouse.GROWTH_INTERVAL_MIN, PlaceableGreenhouse.GROWTH_INTERVAL_MAX)\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"getrandomwateringinterval",children:"getRandomWateringInterval"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"getRandomWateringInterval()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse.getRandomWateringInterval()\n    return math.random( PlaceableGreenhouse.WATERING_INTERVAL_MIN, PlaceableGreenhouse.WATERING_INTERVAL_MAX)\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"initspecialization",children:"initSpecialization"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"initSpecialization()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function PlaceableGreenhouse.initSpecialization()\n    local plantXmlSchema = XMLSchema.new( "greenhousePlant" )\n    plantXmlSchema:register(XMLValueType.STRING, "greenhousePlant.i3dFilename" , "i3d file of plant" )\n    plantXmlSchema:register(XMLValueType.NODE_INDEX, "greenhousePlant.stages.growing(?)#node" , "Growing mesh" )\n    plantXmlSchema:register(XMLValueType.NODE_INDEX, "greenhousePlant.stages.withered#node" , "Withered mesh" )\n\n    I3DUtil.registerI3dMappingXMLPaths(plantXmlSchema, "greenhousePlant" )\n\n    PlaceableGreenhouse.plantXmlSchema = plantXmlSchema\nend\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"loadplantfromxml",children:"loadPlantFromXml"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"loadPlantFromXml()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"xmlFilename"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function PlaceableGreenhouse:loadPlantFromXml(xmlFilename)\n    local plant = {\n    i3dFilename = "" ,\n    i3dNode = nil ,\n    stages = { -- stagse are stored as child indices of meshes -> allows working on cloned nodes without managing node ids\n    growing = { } , -- growing stages from small to big\n    first = nil ,\n    last = nil ,\n    withered = nil ,\n    }\n    }\n\n    local plantXmlFile = XMLFile.load( "plantXml" , xmlFilename, PlaceableGreenhouse.plantXmlSchema)\n    if plantXmlFile ~ = nil then\n        local spec = self.spec_greenhouse\n        spec.plantXMLFiles[plantXmlFile] = true\n\n        local i3dFilename = plantXmlFile:getValue( "greenhousePlant.i3dFilename" )\n        if i3dFilename ~ = nil then\n            plant.i3dFilename = Utils.getFilename(i3dFilename, self.baseDirectory)\n\n            local loadingTask = self:createLoadingTask()\n\n            local arguments = {\n            plant = plant,\n            plantXmlFile = plantXmlFile,\n            loadingTask = loadingTask\n            }\n            plant.sharedLoadRequestId = g_i3DManager:loadSharedI3DFileAsync(plant.i3dFilename, false , false , self.plantI3DLoadedCallback, self , arguments)\n        end\n    end\n\n    return plant\nend\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"ondelete",children:"onDelete"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"onDelete()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse:onDelete()\n    local spec = self.spec_greenhouse\n\n    if spec.plantXMLFiles ~ = nil then\n        for plantXMLFile, _ in pairs(spec.plantXMLFiles) do\n            plantXMLFile:delete()\n            spec.plantXMLFiles[plantXMLFile] = nil\n        end\n    end\n\n    if spec.growthTimer ~ = nil then\n        spec.growthTimer:delete()\n    end\n    if spec.wateringTimer ~ = nil then\n        spec.wateringTimer:delete()\n    end\n\n    if spec.filltypeIdToPlant ~ = nil then\n        for _, plant in pairs(spec.filltypeIdToPlant) do\n            if plant.sharedLoadRequestId ~ = nil then\n                g_i3DManager:releaseSharedI3DFile(plant.sharedLoadRequestId)\n            end\n\n            if plant.i3dNode ~ = nil then\n                delete(plant.i3dNode)\n                plant.i3dNode = nil\n            end\n        end\n    end\n\n    g_effectManager:deleteEffects(spec.effects)\n    g_soundManager:deleteSamples(spec.samples)\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"onfinalizeplacement",children:"onFinalizePlacement"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"onFinalizePlacement()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse:onFinalizePlacement()\n    self.plantDistributionDirty = true\n    self.spec_greenhouse.wateringTimer:start()\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"onload",children:"onLoad"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"onLoad()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function PlaceableGreenhouse:onLoad(savegame)\n    local spec = self.spec_greenhouse\n    local xmlFile = self.xmlFile\n    local key = "placeable.greenhouse"\n\n    spec.filltypeIdToPlant = { }\n    spec.plantPlaces = { }\n\n    spec.activeFilltypes = { }\n    spec.hasWater = true\n    spec.plantXMLFiles = { }\n\n    for _, plantKey in xmlFile:iterator(key .. ".plants.plant" ) do\n        local fillTypeName = xmlFile:getValue(plantKey .. "#fillType" )\n        local fillType = g_fillTypeManager:getFillTypeIndexByName(fillTypeName)\n        if fillType ~ = nil then\n            local plantXmlFilename = xmlFile:getValue(plantKey .. "#xmlFilename" )\n            if plantXmlFilename ~ = nil then\n                plantXmlFilename = Utils.getFilename(plantXmlFilename, self.baseDirectory)\n                local plant = self:loadPlantFromXml(plantXmlFilename)\n                if plant ~ = nil then\n                    spec.filltypeIdToPlant[fillType] = plant\n                end\n            end\n        else\n                Logging.xmlWarning(xmlFile, "Unknown fillType \'%s\' for plant \'%s\'" , fillTypeName, plantKey)\n                end\n            end\n\n            for _, plantSpaceKey in xmlFile:iterator(key .. ".plantSpaces.space" ) do\n                local plantPlaceNode = self.xmlFile:getValue(plantSpaceKey .. "#node" , nil , self.components, self.i3dMappings)\n                local useRandomYRot = self.xmlFile:getValue(plantSpaceKey .. "#useRandomYRot" , true )\n                if plantPlaceNode ~ = nil then\n                    self:addPlantPlace(plantPlaceNode, useRandomYRot)\n                end\n            end\n\n            for _, plantParentKey in xmlFile:iterator(key .. ".plantSpaces.spacesParent" ) do\n                local parentNode = self.xmlFile:getValue(plantParentKey .. "#node" , nil , self.components, self.i3dMappings)\n                local useRandomYRot = self.xmlFile:getValue(plantParentKey .. "#useRandomYRot" , true )\n                local numChildren = getNumOfChildren(parentNode)\n                if numChildren > 0 then\n                    for i = 0 , numChildren - 1 do\n                        self:addPlantPlace(getChildAt(parentNode, i), useRandomYRot)\n                    end\n                else\n                        Logging.xmlWarning(xmlFile, "No i3d child nodes for \'%s\'" , plantParentKey)\n                        end\n                    end\n\n                    if self.isClient then\n                        spec.samples = { }\n                        spec.samples.watering = g_soundManager:loadSampleFromXML(xmlFile, key .. ".sounds" , "watering" , self.baseDirectory, self.components, 1 , AudioGroup.ENVIRONMENT, self.i3dMappings, nil )\n\n                        spec.effects = g_effectManager:loadEffect(xmlFile, key .. ".effectNodes" , self.components, self , self.i3dMappings)\n                    end\n\n                    spec.growthTimer = Timer.new( PlaceableGreenhouse.getRandomGrowthInterval())\n                    spec.growthTimer:setFinishCallback( function (timerInstance)\n                        timerInstance:setDuration( PlaceableGreenhouse.getRandomGrowthInterval())\n                        self:updatePlantsStage() -- restarts timer if reasonable\n                        end )\n                        spec.growthTimer:setScaleFunction( function ()\n                            return g_currentMission:getEffectiveTimeScale()\n                        end )\n\n                        spec.wateringTimer = Timer.new( PlaceableGreenhouse.getRandomWateringInterval())\n                        spec.wateringTimer:setFinishCallback( function (timerInstance)\n                            if spec.hasWater then\n                                g_effectManager:startEffects(spec.effects)\n                                g_soundManager:playSample(spec.samples.watering)\n\n                                Timer.createOneshot( PlaceableGreenhouse.WATERING_DURATION, function ()\n                                    g_effectManager:stopEffects(spec.effects)\n                                    g_soundManager:stopSample(spec.samples.watering)\n                                end , function () return g_currentMission:getEffectiveTimeScale() end )\n                                timerInstance:start() -- restart for next watering\n                                end\n                            end )\n                            spec.wateringTimer:setScaleFunction( function ()\n                                return g_currentMission:getEffectiveTimeScale()\n                            end )\n                        end\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"onoutputfilltypeschanged",children:"onOutputFillTypesChanged"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"onOutputFillTypesChanged()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"outputs"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"state"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse:onOutputFillTypesChanged(outputs, state)\n    local spec = self.spec_greenhouse\n\n    for _, output in pairs(outputs) do\n        local fillType = output.type\n        if state then\n            if spec.filltypeIdToPlant[fillType] ~ = nil then\n                spec.activeFilltypes[fillType] = true\n            end\n        else\n                spec.activeFilltypes[fillType] = nil\n            end\n        end\n\n        -- only directly updated visuals if during gameplay -> plants are updated expliclitly once after load onFinalizePlacement\n            if self:getIsSynchronized() then\n                self.plantDistributionDirty = true\n            end\n\n            self:raiseActive()\n        end\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"onproductionstatuschanged",children:"onProductionStatusChanged"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"onProductionStatusChanged()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"production"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"status"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse:onProductionStatusChanged(production, status )\n    local spec = self.spec_greenhouse\n\n    local hasWater = not( status = = ProductionPoint.PROD_STATUS.MISSING_INPUTS)\n\n    if spec.hasWater ~ = hasWater then\n        spec.hasWater = hasWater\n        self:updatePlantsStage()\n    end\n\n    if hasWater and next(spec.activeFilltypes) ~ = nil then\n        spec.wateringTimer:startIfNotRunning()\n    else\n            spec.wateringTimer:stop()\n        end\n    end\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"onupdate",children:"onUpdate"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"onUpdate()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse:onUpdate()\n    if self.plantDistributionDirty then\n        self:updatePlantDistribution()\n    end\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"planti3dloadedcallback",children:"plantI3DLoadedCallback"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"plantI3DLoadedCallback()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"i3dNode"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"failedReason"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"args"})]})]})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function PlaceableGreenhouse:plantI3DLoadedCallback(i3dNode, failedReason, args)\n    local spec = self.spec_greenhouse\n    local plant = args.plant\n    local plantXmlFile = args.plantXmlFile\n    local loadingTask = args.loadingTask\n\n    if i3dNode ~ = 0 then\n        local components = I3DUtil.loadI3DComponents(i3dNode)\n        local i3dMappings = I3DUtil.loadI3DMapping(plantXmlFile, "greenhousePlant" , components)\n\n        plant.i3dNode = i3dNode\n\n        plantXmlFile:iterate( "greenhousePlant.stages.growing" , function (index, key)\n            local growingNode = plantXmlFile:getValue(key .. "#node" , nil , components, i3dMappings)\n            if growingNode ~ = nil then\n                local childIndex = getChildIndex(growingNode)\n                table.insert(plant.stages.growing, childIndex)\n            end\n        end )\n\n        plant.stages.first = plant.stages.growing[ 1 ]\n        plant.stages.last = plant.stages.growing[#plant.stages.growing]\n\n        local witheredNode = plantXmlFile:getValue( "greenhousePlant.stages.withered#node" , nil , components, i3dMappings)\n        if witheredNode ~ = nil then\n            plant.stages.withered = getChildIndex(witheredNode)\n        end\n    end\n\n    plantXmlFile:delete()\n    spec.plantXMLFiles[plantXmlFile] = nil\n\n    self:finishLoadingTask(loadingTask)\nend\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"prerequisitespresent",children:"prerequisitesPresent"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"Checks if all prerequisite specializations are loaded"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"prerequisitesPresent(table specializations)"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"table"}),(0,a.jsx)(n.th,{children:"specializations"}),(0,a.jsx)(n.th,{children:"specializations"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"table"}),(0,a.jsx)(n.th,{children:"hasPrerequisite"}),(0,a.jsx)(n.th,{children:"true if all prerequisite specializations are loaded"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse.prerequisitesPresent(specializations)\n    return true\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"registereventlisteners",children:"registerEventListeners"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"registerEventListeners()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function PlaceableGreenhouse.registerEventListeners(placeableType)\n    SpecializationUtil.registerEventListener(placeableType, "onLoad" , PlaceableGreenhouse )\n    SpecializationUtil.registerEventListener(placeableType, "onDelete" , PlaceableGreenhouse )\n    SpecializationUtil.registerEventListener(placeableType, "onFinalizePlacement" , PlaceableGreenhouse )\n    SpecializationUtil.registerEventListener(placeableType, "onOutputFillTypesChanged" , PlaceableGreenhouse )\n    SpecializationUtil.registerEventListener(placeableType, "onProductionStatusChanged" , PlaceableGreenhouse )\n    SpecializationUtil.registerEventListener(placeableType, "onUpdate" , PlaceableGreenhouse )\nend\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"registerfunctions",children:"registerFunctions"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"registerFunctions()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function PlaceableGreenhouse.registerFunctions(placeableType)\n    SpecializationUtil.registerFunction(placeableType, "loadPlantFromXml" , PlaceableGreenhouse.loadPlantFromXml)\n    SpecializationUtil.registerFunction(placeableType, "plantI3DLoadedCallback" , PlaceableGreenhouse.plantI3DLoadedCallback)\n    SpecializationUtil.registerFunction(placeableType, "addPlantPlace" , PlaceableGreenhouse.addPlantPlace)\n    SpecializationUtil.registerFunction(placeableType, "updatePlantDistribution" , PlaceableGreenhouse.updatePlantDistribution)\n    SpecializationUtil.registerFunction(placeableType, "setPlantAtPlace" , PlaceableGreenhouse.setPlantAtPlace)\n    SpecializationUtil.registerFunction(placeableType, "updatePlantsStage" , PlaceableGreenhouse.updatePlantsStage)\nend\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"schema"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"basePath"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function PlaceableGreenhouse.registerXMLPaths(schema, basePath)\n    schema:setXMLSpecializationType( "Greenhouse" )\n    schema:register(XMLValueType.STRING, basePath .. ".greenhouse.plants.plant(?)#fillType" , "FillType of plant" )\n    schema:register(XMLValueType.STRING, basePath .. ".greenhouse.plants.plant(?)#xmlFilename" , "xml file of greenhouse plant" )\n\n    schema:register(XMLValueType.NODE_INDEX, basePath .. ".greenhouse.plantSpaces.space(?)#node" , "node where plant is placed" )\n    schema:register(XMLValueType.BOOL, basePath .. ".greenhouse.plantSpaces.space(?)#useRandomYRot" , "node is randomly rotated on the y axis" , true )\n    schema:register(XMLValueType.NODE_INDEX, basePath .. ".greenhouse.plantSpaces.spacesParent(?)#node" , "parent node of nodes where plants are placed" )\n    schema:register(XMLValueType.BOOL, basePath .. ".greenhouse.plantSpaces.spacesParent(?)#useRandomYRot" , "node is randomly rotated on the y axis" , true )\n\n    SoundManager.registerSampleXMLPaths(schema, basePath .. ".greenhouse.sounds" , "watering" )\n    EffectManager.registerEffectXMLPaths(schema, basePath .. ".greenhouse.effectNodes" )\n    schema:setXMLSpecializationType()\nend\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"setplantatplace",children:"setPlantAtPlace"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"setPlantAtPlace()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"fillType"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"plantPlace"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse:setPlantAtPlace(fillType, plantPlace)\n    local spec = self.spec_greenhouse\n\n    -- only update if required fillType differs from current one\n        if plantPlace.fillType ~ = fillType then\n            if plantPlace.fillType ~ = nil then\n                -- remove existing stages from other plant\n                for i = getNumOfChildren(plantPlace.node) - 1 , 0 , - 1 do\n                    local plantStage = getChildAt(plantPlace.node, i)\n                    delete(plantStage)\n                end\n                plantPlace.fillType = nil\n            end\n\n            local plant = spec.filltypeIdToPlant[fillType]\n            if plant ~ = nil then\n                local plantClone = clone(getChildAt(plant.i3dNode, 0 ), false , false , false )\n\n                for n = getNumOfChildren(plantClone) - 1 , 0 , - 1 do\n                    local plantStage = getChildAt(plantClone, n)\n                    link(plantPlace.node, plantStage, 0 )\n                end\n                plantPlace.fillType = fillType\n                plantPlace.stage = nil\n\n                delete(plantClone)\n            end\n        end\n    end\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"updateplantdistribution",children:"updatePlantDistribution"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"populates the plant nodes with cloned plants set in activeFilltypes"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"updatePlantDistribution()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse:updatePlantDistribution()\n    local spec = self.spec_greenhouse\n\n    local numActiveFilltypes = table.size(spec.activeFilltypes)\n    local numPlaces = #spec.plantPlaces\n\n    local fillTypesList = table.toList(spec.activeFilltypes)\n\n    for i = 1 , numPlaces do\n        -- rotate active fillTypes through places\n        local fillType = fillTypesList[(i % numActiveFilltypes) + 1 ]\n        local plantPlace = spec.plantPlaces[i]\n\n        self:setPlantAtPlace(fillType, plantPlace)\n    end\n\n    self.plantDistributionDirty = false\n    self:updatePlantsStage()\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"updateplantsstage",children:"updatePlantsStage"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"cycles throufh plants growth stages or sets plants to withered if no water is available"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"updatePlantsStage()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function PlaceableGreenhouse:updatePlantsStage()\n    local spec = self.spec_greenhouse\n\n    if table.size(spec.activeFilltypes) = = 0 then\n        return\n    end\n\n    if not spec.hasWater then\n        spec.growthTimer:stop()\n    else\n            spec.growthTimer:start()\n        end\n\n        for i = 1 , #spec.plantPlaces do\n            local plantPlace = spec.plantPlaces[i]\n\n            local plant = spec.filltypeIdToPlant[plantPlace.fillType]\n\n            local newStage\n            if not spec.hasWater then\n                newStage = plant.stages.withered\n            else\n                    newStage = (plantPlace.stage and(plantPlace.stage + 1 )) or plant.stages.first\n                    if newStage > plant.stages.last then\n                        newStage = plant.stages.first\n                    end\n                end\n\n                if plantPlace.stage ~ = newStage then\n                    for n = 0 , getNumOfChildren(plantPlace.node) - 1 do\n                        local plantStage = getChildAt(plantPlace.node, n)\n                        setVisibility(plantStage, n = = newStage)\n                    end\n                    plantPlace.stage = newStage\n                end\n            end\n        end\n\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}}}]);