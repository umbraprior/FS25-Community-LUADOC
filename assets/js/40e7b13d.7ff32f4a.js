"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[67653],{8407(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>m,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"script/GUI/NavigationMarker","title":"NavigationMarker","description":"NavigationMarker","source":"@site/../docs/script/GUI/NavigationMarker.md","sourceDirName":"script/GUI","slug":"/script/GUI/NavigationMarker","permalink":"/FS25-Community-LUADOC/script/GUI/NavigationMarker","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"MultiValueTween","permalink":"/FS25-Community-LUADOC/script/GUI/MultiValueTween"},"next":{"title":"OptionSliderElement","permalink":"/FS25-Community-LUADOC/script/GUI/OptionSliderElement"}}');var a=r(74848),l=r(28453);const i={},s=void 0,o={},c=[{value:"NavigationMarker",id:"navigationmarker",level:2},{value:"render",id:"render",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"navigationmarker",children:"NavigationMarker"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Functions"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#render",children:"render"})}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"render",children:"render"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"render()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function NavigationMarker:render()\n    if not self.isVisible then\n        return\n    end\n\n    new2DLayer()\n\n    local player = g_localPlayer\n    if player = = nil then\n        return\n    end\n\n    local x, y, z = g_localPlayer:getPosition()\n\n    local distance = MathUtil.vector3Length( self.worldPosX - x, self.worldPosY - y, self.worldPosZ - z)\n    if distance < self.minDistance then\n        return\n    end\n\n    local diff = distance - self.minDistance\n    local fadeFactor = MathUtil.lerp( 0 , 1 , math.min( 1 , diff))\n\n    local camera = g_cameraManager:getActiveCamera()\n    local cx, cy, cz = worldToLocal(camera, self.worldPosX, self.worldPosY, self.worldPosZ)\n\n    local nClip = getNearClip(camera)\n    if cz > - nClip then\n        local b = - nClip\n        local c = b / math.sin(getFovY(camera) * 0.5 )\n        local a = math.sqrt( - b * b + c * c)\n\n        cx = a * math.sign(cx)\n\n        b = - nClip\n        c = b / math.sin(getFovY(camera) * 0.5 * g_screenAspectRatio)\n        a = math.sqrt( - b * b + c * c)\n\n        cy = a * math.sign(cy)\n\n        -- cx = math.clamp(cx, -5, 5)\n        -- cy = math.clamp(cy, -5, 5)\n    end\n\n    cz = math.min(cz, - nClip)\n\n    local wx, wy, wz = localToWorld(camera, cx, cy, cz)\n    local sx, sy, _sz = project(wx, wy, wz)\n\n    -- if sz > 1 then\n        -- sx = sx * -1\n        -- end\n\n        local clampedX = sx\n        local isClampedX = false\n        if sx < self.borderX or sx > 1 - self.borderX then\n            clampedX = math.clamp(sx, self.borderX, 1 - self.borderX)\n            isClampedX = true\n        end\n\n        local clampedY = sy\n        local isClampedY = false\n        if sy < self.borderY or sy > 1 - self.borderY then\n            clampedY = math.clamp(sy, self.borderY, 1 - self.borderY)\n            isClampedY = true\n        end\n\n        -- if sx > -1 and sx < 2 and sy > -1 and sy < 2 then -- and sz < = 1\n            --TODO fix positioning\n            -- renderText(0.5, 0.5, 0.018, string.format("%.2f, %.2f, %.2f", sx, sy, sz))\n\n            local alpha = MathUtil.lerp( 0.4 , 1.0 , math.abs( math.sin(g_ time / 400 )))\n            self.overlayMarker:setColor( nil , nil , nil , alpha * fadeFactor)\n\n            self.overlayMarker:setPosition(clampedX, clampedY)\n            self.overlayMarker:render()\n\n            local needArrow = isClampedX or isClampedY\n            if needArrow then\n                local dx, dy = MathUtil.vector2Normalize(sx - 0.5 , sy - 0.5 )\n                local angle = - math.atan2(dx, dy) + math.pi * 0.5\n\n                self.overlayMarkerArrow:setColor( nil , nil , nil , alpha * fadeFactor)\n                self.overlayMarkerArrow:setRotation(angle, self.overlayMarkerArrow.width * 0.5 , self.overlayMarkerArrow.height * 0.5 )\n                self.overlayMarkerArrow:setPosition(clampedX + dx * self.width * 0.7 , clampedY + dy * self.height * 0.7 )\n                self.overlayMarkerArrow:render()\n            end\n\n            setTextColor( 1 , 1 , 1 , alpha * fadeFactor)\n            setTextBold( true )\n            setTextAlignment(RenderText.ALIGN_CENTER)\n            setTextLineHeightScale( 0.8 )\n            setTextVerticalAlignment(RenderText.VERTICAL_ALIGN_MIDDLE)\n            setTextWrapWidth( self.width * 0.1 , false )\n            renderText(clampedX, clampedY, self.textSize, g_i18n:formatDistance(distance))\n\n            setTextLineHeightScale(RenderText.DEFAULT_LINE_HEIGHT_SCALE)\n            setTextBold( false )\n            setTextWrapWidth( 0 )\n            setTextAlignment(RenderText.ALIGN_LEFT)\n            setTextVerticalAlignment(RenderText.VERTICAL_ALIGN_BASELINE)\n            -- end\n        end\n\n'})})]})}function m(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453(e,n,r){r.d(n,{R:()=>i,x:()=>s});var t=r(96540);const a={},l=t.createContext(a);function i(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);