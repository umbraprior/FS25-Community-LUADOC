"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[63369],{28453(e,n,r){r.d(n,{R:()=>l,x:()=>d});var s=r(96540);const i={},t=s.createContext(i);function l(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:n},e.children)}},55502(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>c,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"script/Wheels/WheelVisualPartTire","title":"WheelVisualPartTire","description":"WheelVisualPartTire","source":"@site/../docs/script/Wheels/WheelVisualPartTire.md","sourceDirName":"script/Wheels","slug":"/script/Wheels/WheelVisualPartTire","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelVisualPartTire","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"WheelVisualPartConnector","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelVisualPartConnector"},"next":{"title":"WheelXMLObject","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelXMLObject"}}');var i=r(74848),t=r(28453);const l={},d=void 0,a={},o=[{value:"WheelVisualPartTire",id:"wheelvisualparttire",level:2},{value:"loadFromXML",id:"loadfromxml",level:3},{value:"new",id:"new",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"setNode",id:"setnode",level:3},{value:"update",id:"update",level:3}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"wheelvisualparttire",children:"WheelVisualPartTire"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Visual tire that handles the tire deformation"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parent"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"?version=script&category=93&class=912",children:"WheelVisualPart"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Functions"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#loadfromxml",children:"loadFromXML"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#new",children:"new"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#setnode",children:"setNode"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#update",children:"update"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"loadfromxml",children:"loadFromXML"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"loadFromXML()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"xmlObject"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"key"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function WheelVisualPartTire:loadFromXML(xmlObject, key)\n    if not WheelVisualPartTire:superClass().loadFromXML( self , xmlObject, key) then\n        return false\n    end\n\n    self.maxDeformation = xmlObject:getValue(key .. "#maxDeformation" , 0 )\n    self.initialDeformation = xmlObject:getValue(key .. "#initialDeformation" , math.min( 0.04 , self.maxDeformation * 0.6 ))\n\n    return true\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"new",children:"new"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"new()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"name"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"visualWheel"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"linkNode"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"customMt"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelVisualPartTire.new(name, visualWheel, linkNode, customMt)\n    local self = WheelVisualPart.new(name, visualWheel, linkNode, WheelVisualPartTire _mt)\n\n    self.deformation = 0\n    self.derformationPrevDirty = false\n\n    return self\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"schema"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"key"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"name"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function WheelVisualPartTire.registerXMLPaths(schema, key, name)\n    WheelVisualPart.registerXMLPaths(schema, key, name)\n\n    schema:register(XMLValueType.FLOAT, key .. "#maxDeformation" , "Max.deformation" , 0 )\n    schema:register(XMLValueType.FLOAT, key .. "#initialDeformation" , "Tire deformation at initial compression value" , "min.0.04 and max.60% of the deformation" )\n\n    schema:register(XMLValueType.BOOL, key .. "#hasMudMesh" , "Tire has a mud mesh included" , false )\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"setnode",children:"setNode"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"setNode()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"node"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function WheelVisualPartTire:setNode(node)\n    WheelVisualPartTire:superClass().setNode( self , node)\n\n    self.tireNodes = { }\n    if getHasClassId( self.node, ClassIds.SHAPE) and(getHasShaderParameter( self.node, "morphPos" ) or getHasShaderParameter( self.node, "morphPosition" )) then\n        table.insert( self.tireNodes, self.node)\n    end\n\n    I3DUtil.iterateRecursively(node, function (subNode)\n        if getHasClassId(subNode, ClassIds.SHAPE) and(getHasShaderParameter(subNode, "morphPos" ) or getHasShaderParameter(subNode, "morphPosition" )) then\n            table.insert( self.tireNodes, subNode)\n        end\n    end )\n\n    for _, tireNode in ipairs( self.tireNodes) do\n        if getHasShaderParameter(tireNode, "morphPos" ) then\n            local x, y, z, _ = getShaderParameter(tireNode, "morphPos" )\n            setShaderParameter(tireNode, "morphPos" , nil , nil , nil , 0 , false )\n            setShaderParameter(tireNode, "prevMorphPos" , x, y, z, 0 , false )\n        elseif getHasShaderParameter(tireNode, "morphPosition" ) then -- support for old fs22 tires with old vehicle shader\n                local sx, sy, sz, _ = getShaderParameter(tireNode, "morphPosition" )\n                setShaderParameter(tireNode, "morphPos" , sx, sy, sz, 0 , false )\n                setShaderParameter(tireNode, "prevMorphPos" , sx, sy, sz, 0 , false )\n            end\n        end\n    end\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"update",children:"update"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"update()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"x"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"y"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"z"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"xDrive"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"suspensionLength"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"steeringAngle"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"changed"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function WheelVisualPartTire:update(x, y, z, xDrive, suspensionLength, steeringAngle, changed)\n    if self.node ~ = nil then\n        if Platform.gameplay.wheelVisualPressure then\n            local deformation = math.clamp( self.initialDeformation - suspensionLength, 0 , self.maxDeformation)\n            local prevDeformation, curDeformation\n\n            if math.abs(deformation - self.deformation) > Platform.gameplay.wheelVisualPressureUpdateThreshold then\n                prevDeformation = self.deformation\n                curDeformation = deformation\n\n                self.deformation = deformation\n                self.derformationPrevDirty = true\n\n                changed = true\n            end\n\n            -- one frame delayed we update prev deformation to match cur deformation(TAA)\n            if curDeformation = = nil and self.derformationPrevDirty then\n                prevDeformation = self.deformation\n                curDeformation = self.deformation\n\n                self.derformationPrevDirty = false\n            end\n\n            if curDeformation ~ = nil then\n                for _, tireNode in ipairs( self.tireNodes) do\n                    setShaderParameter(tireNode, "morphPos" , nil , nil , nil , curDeformation, false )\n                    setShaderParameter(tireNode, "prevMorphPos" , nil , nil , nil , prevDeformation, false )\n                end\n            end\n\n            suspensionLength = suspensionLength + deformation\n        end\n    end\n\n    return changed, suspensionLength\nend\n\n'})})]})}function c(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);