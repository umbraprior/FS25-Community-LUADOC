"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[21305],{28453(e,n,l){l.d(n,{R:()=>d,x:()=>t});var i=l(96540);const s={},a=i.createContext(s);function d(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),i.createElement(a.Provider,{value:n},e.children)}},72086(e,n,l){l.r(n),l.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>p,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"script/Wheels/WheelAxle","title":"WheelAxle","description":"WheelAxle","source":"@site/../docs/script/Wheels/WheelAxle.md","sourceDirName":"script/Wheels","slug":"/script/Wheels/WheelAxle","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelAxle","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Wheel","permalink":"/FS25-Community-LUADOC/script/Wheels/Wheel"},"next":{"title":"WheelChock","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelChock"}}');var s=l(74848),a=l(28453);const d={},t=void 0,r={},o=[{value:"WheelAxle",id:"wheelaxle",level:2},{value:"delete",id:"delete",level:3},{value:"fillDebugValues",id:"filldebugvalues",level:3},{value:"getDebugValueHeader",id:"getdebugvalueheader",level:3},{value:"loadFromXML",id:"loadfromxml",level:3},{value:"new",id:"new",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"update",id:"update",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"wheelaxle",children:"WheelAxle"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Handles the connection of two wheels on a vehicle, allowing for dynamic suspension adjustments based on axle load."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Functions"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#delete",children:"delete"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#filldebugvalues",children:"fillDebugValues"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getdebugvalueheader",children:"getDebugValueHeader"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#loadfromxml",children:"loadFromXML"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#new",children:"new"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#update",children:"update"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"delete",children:"delete"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"delete()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function WheelAxle:delete()\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"filldebugvalues",children:"fillDebugValues"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"fillDebugValues()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"debugTable"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function WheelAxle:fillDebugValues(debugTable)\n    local dynamicSuspension = self.dynamicSuspension\n    local physics1, physics2 = self.wheel1.physics, self.wheel2.physics\n    if dynamicSuspension ~ = nil then\n        debugTable[ 1 ] = debugTable[ 1 ] .. string.format( "%d\\n" , self.wheel1.wheelIndex)\n        debugTable[ 2 ] = debugTable[ 2 ] .. string.format( "%d\\n" , self.wheel2.wheelIndex)\n\n        debugTable[ 3 ] = debugTable[ 3 ] .. string.format( "%2.2f\\n" , physics1:getTireLoad() + physics2:getTireLoad())\n\n        local maxLoad = dynamicSuspension.maxLoad or(physics1.restLoad * 2 + physics2.restLoad * 2 )\n        debugTable[ 4 ] = debugTable[ 4 ] .. string.format( "%2.2f\\n" , maxLoad)\n\n        debugTable[ 5 ] = debugTable[ 5 ] .. string.format( "%.2f\\n" , dynamicSuspension.appliedAlpha)\n\n        local springMultiplier = MathUtil.lerp( 1 , dynamicSuspension.springLoadMultiplier, dynamicSuspension.appliedAlpha)\n        local dampingMultiplier = MathUtil.lerp( 1 , dynamicSuspension.dampingLoadMultiplier, dynamicSuspension.appliedAlpha)\n        debugTable[ 6 ] = debugTable[ 6 ] .. string.format( "x%.2f\\n" , springMultiplier)\n        debugTable[ 7 ] = debugTable[ 7 ] .. string.format( "x%.2f\\n" , dampingMultiplier)\n\n        if self.dynamicSuspension.componentJointIndex ~ = nil then\n            debugTable[ 8 ] = debugTable[ 8 ] .. string.format( "%d\\n" , self.dynamicSuspension.componentJointIndex)\n\n            local componentSpringMultiplier = MathUtil.lerp( 1 , dynamicSuspension.componentSpringLoadMultiplier, dynamicSuspension.appliedAlpha)\n            local componentDampingMultiplier = MathUtil.lerp( 1 , dynamicSuspension.componentDampingLoadMultiplier, dynamicSuspension.appliedAlpha)\n            debugTable[ 9 ] = debugTable[ 9 ] .. string.format( "x%.2f\\n" , componentSpringMultiplier)\n            debugTable[ 10 ] = debugTable[ 10 ] .. string.format( "x%.2f\\n" , componentDampingMultiplier)\n        else\n                debugTable[ 8 ] = debugTable[ 8 ] .. "n/a\\n"\n                debugTable[ 9 ] = debugTable[ 9 ] .. "n/a\\n"\n                debugTable[ 10 ] = debugTable[ 10 ] .. "n/a\\n"\n            end\n        end\n    end\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"getdebugvalueheader",children:"getDebugValueHeader"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getDebugValueHeader()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function WheelAxle.getDebugValueHeader()\n    return { "w1\\n" , "w2\\n" , "load\\n" , "maxLoad\\n" , "alpha\\n" , "spring\\n" , "damp\\n" , "compJ\\n" , "jSpring\\n" , "jDamp\\n" }\nend\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"loadfromxml",children:"loadFromXML"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"loadFromXML()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"xmlFile"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"any"}),(0,s.jsx)(n.td,{children:"key"})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function WheelAxle:loadFromXML(xmlFile, key)\n    self.wheelNode1 = xmlFile:getValue(key .. "#wheel1" , nil , self.vehicle.components, self.vehicle.i3dMappings)\n    self.wheelNode2 = xmlFile:getValue(key .. "#wheel2" , nil , self.vehicle.components, self.vehicle.i3dMappings)\n\n    if self.wheelNode1 = = nil or self.wheelNode2 = = nil then\n        Logging.xmlError(xmlFile, "WheelAxle \'%s\' missing wheel1 or wheel2" , key)\n        return false\n    end\n\n    self.wheel1 = self.vehicle:getWheelByWheelNode( self.wheelNode1)\n    self.wheel2 = self.vehicle:getWheelByWheelNode( self.wheelNode2)\n\n    -- if wheels are not available in a certain configuration, we ignore the definition silently\n        if self.wheel1 = = nil or self.wheel2 = = nil then\n            return false\n        end\n\n        local springLoadMultiplier = xmlFile:getValue(key .. ".dynamicSuspension#springLoadMultiplier" , 1 )\n        local dampingLoadMultiplier = xmlFile:getValue(key .. ".dynamicSuspension#dampingLoadMultiplier" , 1 )\n        if springLoadMultiplier ~ = 1 or dampingLoadMultiplier ~ = 1 then\n            self.dynamicSuspension = { }\n\n            self.dynamicSuspension.springLoadMultiplier = springLoadMultiplier\n            self.dynamicSuspension.dampingLoadMultiplier = dampingLoadMultiplier\n\n            self.dynamicSuspension.maxLoad = xmlFile:getValue(key .. ".dynamicSuspension#maxLoad" )\n            self.dynamicSuspension.interpolationTime = 1 / xmlFile:getValue(key .. ".dynamicSuspension#interpolationTime" , 1 )\n\n            self.dynamicSuspension.interpolatedAlpha = 0\n            self.dynamicSuspension.appliedAlpha = 0\n\n            if self.vehicle.setDependentComponentJointBaseFactors ~ = nil then\n                self.dynamicSuspension.componentJointIndex = xmlFile:getValue(key .. ".dynamicSuspension.componentJoint#index" , nil )\n                if self.dynamicSuspension.componentJointIndex ~ = nil then\n                    self.dynamicSuspension.componentSpringLoadMultiplier = xmlFile:getValue(key .. ".dynamicSuspension.componentJoint#springLoadMultiplier" , 1 )\n                    self.dynamicSuspension.componentDampingLoadMultiplier = xmlFile:getValue(key .. ".dynamicSuspension.componentJoint#dampingLoadMultiplier" , 1 )\n                end\n            end\n        end\n\n        return true\n    end\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"new",children:"new"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"new()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"vehicle"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"any"}),(0,s.jsx)(n.td,{children:"customMt"})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function WheelAxle.new(vehicle, customMt)\n    local self = setmetatable( { } , customMt or WheelAxle _mt)\n\n    self.vehicle = vehicle\n\n    return self\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"schema"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"any"}),(0,s.jsx)(n.td,{children:"key"})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function WheelAxle.registerXMLPaths(schema, key)\n    schema:register(XMLValueType.NODE_INDEX, key .. "#wheel1" , "First wheel of the axle" )\n    schema:register(XMLValueType.NODE_INDEX, key .. "#wheel2" , "Second wheel of the axle" )\n\n    schema:register(XMLValueType.FLOAT, key .. ".dynamicSuspension#springLoadMultiplier" , "Multiplier for spring value while maxLoad is applied on the wheels" , 1 )\n        schema:register(XMLValueType.FLOAT, key .. ".dynamicSuspension#dampingLoadMultiplier" , "Multiplier for damping value while maxLoad is applied on the wheels" , 1 )\n\n            schema:register(XMLValueType.FLOAT, key .. ".dynamicSuspension#maxLoad" , "Axle load as reference for springLoadMultiplier/dampingLoadMultiplier to adjust the physics behaviour in high load situations" , "restLoad of all wheels multiplied by 2" )\n                schema:register(XMLValueType.TIME, key .. ".dynamicSuspension#interpolationTime" , "Interpolation time for tire load" , 1 )\n\n                    schema:register(XMLValueType.INT, key .. ".dynamicSuspension.componentJoint#index" , "Index of the axle component joint" )\n                    schema:register(XMLValueType.FLOAT, key .. ".dynamicSuspension.componentJoint#springLoadMultiplier" , "Multiplier for component joint spring value while maxLoad is applied on the wheels" , 1 )\n                        schema:register(XMLValueType.FLOAT, key .. ".dynamicSuspension.componentJoint#dampingLoadMultiplier" , "Multiplier for component joint damping value while maxLoad is applied on the wheels" , 1 )\n                        end\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"update",children:"update"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"update()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"dt"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function WheelAxle:update(dt)\n    if self.dynamicSuspension ~ = nil then\n        local dynamicSuspension = self.dynamicSuspension\n        local physics1, physics2 = self.wheel1.physics, self.wheel2.physics\n\n        local axleLoad = physics1:getTireLoad() + physics2:getTireLoad()\n        if axleLoad ~ = 0 then -- zero while not added to physics yet\n            local restLoad = physics1.restLoad + physics2.restLoad\n            local maxLoad = self.maxLoad or(physics1.restLoad * 2 + physics2.restLoad * 2 )\n            local targetAlpha = MathUtil.inverseLerp(restLoad, maxLoad, axleLoad)\n\n            local direction = math.sign(targetAlpha - dynamicSuspension.interpolatedAlpha)\n            dynamicSuspension.interpolatedAlpha = math.clamp(dynamicSuspension.interpolatedAlpha + direction * dt * dynamicSuspension.interpolationTime, 0 , 1 )\n\n            if math.abs(dynamicSuspension.interpolatedAlpha - dynamicSuspension.appliedAlpha) > 0.05 then\n                dynamicSuspension.appliedAlpha = dynamicSuspension.interpolatedAlpha\n\n                local springMultiplier = MathUtil.lerp( 1 , dynamicSuspension.springLoadMultiplier, dynamicSuspension.appliedAlpha)\n                local dampingMultiplier = MathUtil.lerp( 1 , dynamicSuspension.dampingLoadMultiplier, dynamicSuspension.appliedAlpha)\n\n                physics1:setSuspensionMultipliers(springMultiplier, dampingMultiplier)\n                physics2:setSuspensionMultipliers(springMultiplier, dampingMultiplier)\n\n                if self.dynamicSuspension.componentJointIndex ~ = nil then\n                    local componentSpringLoadMultiplier = MathUtil.lerp( 1 , dynamicSuspension.componentSpringLoadMultiplier, dynamicSuspension.appliedAlpha)\n                    local componentDampingLoadMultiplier = MathUtil.lerp( 1 , dynamicSuspension.componentDampingLoadMultiplier, dynamicSuspension.appliedAlpha)\n\n                    self.vehicle:setDependentComponentJointBaseFactors(dynamicSuspension.componentJointIndex, componentSpringLoadMultiplier, componentDampingLoadMultiplier, true )\n                    self.vehicle:updateDependentComponentJointValues( false , true )\n                end\n            end\n        end\n    end\nend\n\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);