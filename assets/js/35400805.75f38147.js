"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[11054],{28453(e,n,r){r.d(n,{R:()=>i,x:()=>a});var l=r(96540);const s={},t=l.createContext(s);function i(e){const n=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),l.createElement(t.Provider,{value:n},e.children)}},40425(e,n,r){r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>h});const l=JSON.parse('{"id":"script/Player/PlayerSystem","title":"PlayerSystem","description":"PlayerSystem","source":"@site/../docs/script/Player/PlayerSystem.md","sourceDirName":"script/Player","slug":"/script/Player/PlayerSystem","permalink":"/FS25-Community-LUADOC/script/Player/PlayerSystem","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"PlayerMover","permalink":"/FS25-Community-LUADOC/script/Player/PlayerMover"},"next":{"title":"RollercoasterActivatable","permalink":"/FS25-Community-LUADOC/script/Rollercoaster/RollercoasterActivatable"}}');var s=r(74848),t=r(28453);const i={},a=void 0,d={},h=[{value:"PlayerSystem",id:"playersystem",level:2},{value:"addPlayer",id:"addplayer",level:3},{value:"debugDrawAllPlayers",id:"debugdrawallplayers",level:3},{value:"draw",id:"draw",level:3},{value:"getHasPlayerWithUniqueId",id:"gethasplayerwithuniqueid",level:3},{value:"getIsPlayerAdded",id:"getisplayeradded",level:3},{value:"getPlayerByConnection",id:"getplayerbyconnection",level:3},{value:"getPlayerByIndex",id:"getplayerbyindex",level:3},{value:"getPlayerByRootNode",id:"getplayerbyrootnode",level:3},{value:"getPlayerByUniqueId",id:"getplayerbyuniqueid",level:3},{value:"getPlayerByUserId",id:"getplayerbyuserid",level:3},{value:"getPlayerCount",id:"getplayercount",level:3},{value:"getPlayerDataByUniqueId",id:"getplayerdatabyuniqueid",level:3},{value:"saveHugeUnloadedPlayers",id:"savehugeunloadedplayers",level:3},{value:"saveToXMLFile",id:"savetoxmlfile",level:3},{value:"saveUnloadedPlayers",id:"saveunloadedplayers",level:3}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"playersystem",children:"PlayerSystem"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"The class responsible for managing all players of a mission."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Functions"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#addplayer",children:"addPlayer"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#debugdrawallplayers",children:"debugDrawAllPlayers"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#draw",children:"draw"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#gethasplayerwithuniqueid",children:"getHasPlayerWithUniqueId"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getisplayeradded",children:"getIsPlayerAdded"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getplayerbyconnection",children:"getPlayerByConnection"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getplayerbyindex",children:"getPlayerByIndex"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getplayerbyrootnode",children:"getPlayerByRootNode"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getplayerbyuniqueid",children:"getPlayerByUniqueId"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getplayerbyuserid",children:"getPlayerByUserId"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getplayercount",children:"getPlayerCount"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getplayerdatabyuniqueid",children:"getPlayerDataByUniqueId"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#savehugeunloadedplayers",children:"saveHugeUnloadedPlayers"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#savetoxmlfile",children:"saveToXMLFile"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#saveunloadedplayers",children:"saveUnloadedPlayers"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"addplayer",children:"addPlayer"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Adds the given player to this system."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"addPlayer(Player player)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Player"}),(0,s.jsx)(n.th,{children:"player"}),(0,s.jsx)(n.th,{children:"The player to add."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Player"}),(0,s.jsx)(n.th,{children:"success"}),(0,s.jsx)(n.th,{children:"False if the player has already been added; otherwise true."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function PlayerSystem:addPlayer(player)\n\n    --#debug Assert.isNotNil(player, "Player is nil!")\n    --#debug Assert.isClass(player, Player, "Player is not of class Player!")\n\n    -- If the player has already been added to this system, return false.\n    local existingPlayer = self:getPlayerByUserId(player.userId)\n    if existingPlayer ~ = nil then\n\n        -- If the existing player does not match the given player, it means there are two players with the same id in the world, so log an error.\n        if existingPlayer ~ = player then\n            Logging.error( "Player with user id %d exists in the system with table address of %s, but a player with the same user id tried to be added with a table address of %s!" ,\n            player.userId, tostring(existingPlayer), tostring(player))\n        end\n        return false\n    end\n\n    --#debug Assert.isNil(table.find(self.players, player), "Player already exists in array!")\n    --#debug Assert.hasNoKey(self.playersByUserId, player.userId, "Player already exists by user id!")\n\n    -- Handle logging.\n    --#debug player:debugLog(Player.DEBUG_DISPLAY_FLAG.INITIALISATION, "Player added to system")\n\n    -- Add the player to the collections.\n    table.insert( self.players, player)\n    self.playersByUserId[player.userId] = player\n    self.playersByRootNode[player.rootNode] = player\n    self.playersByConnection[player.connection] = player\n\n    -- If the player has a unique user id, add them to the collection immediately.\n    if not string.isNilOrWhitespace(player.uniqueUserId) then\n        self.playersByUniqueId[player.uniqueUserId] = player\n\n        -- Remove the player\'s data from the unloaded table.\n        if g_server ~ = nil and self.unloadedPlayerDataByUniqueId[player.uniqueUserId] ~ = nil then\n            self.unloadedPlayerDataByUniqueId[player.uniqueUserId] = nil\n            self.unloadedPlayerDataCount = self.unloadedPlayerDataCount - 1\n        end\n    end\n\n    -- If the player is the local player, set them as such.\n    if player.isOwner then\n        self:setLocalPlayer(player)\n    end\n\n    -- Return true, as the player was succesfully added.\n    return true\nend\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"debugdrawallplayers",children:"debugDrawAllPlayers"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Displays the debug information for all added players."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"debugDrawAllPlayers(float x, float y, float textSize)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"float"}),(0,s.jsx)(n.th,{children:"x"}),(0,s.jsx)(n.th,{children:"The x position on the screen to begin drawing the values."})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"float"}),(0,s.jsx)(n.td,{children:"y"}),(0,s.jsx)(n.td,{children:"The y position on the screen to begin drawing the values."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"float"}),(0,s.jsx)(n.td,{children:"textSize"}),(0,s.jsx)(n.td,{children:"The height of the text."})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:debugDrawAllPlayers(x, y, textSize)\n\n    for i, player in ipairs( self.players) do\n        player:debugDraw(x, y, textSize)\n        x = x + 0.2\n    end\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"draw",children:"draw"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"draw()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:draw()\n    for _, player in pairs( self.players) do\n        if not player.isDeleted then\n            player:drawUIInfo()\n        end\n    end\n\n    if PlayerSystem.DEBUG_ANIMATIONS then\n        local startPosX = 0.07\n        local lineOffsetY = 0.4\n        local posX = startPosX\n        local posY = 0.9\n        local textSize = getCorrectTextSize( 0.012 )\n        local numPlayer = 1\n\n        for _, player in pairs( self.players) do\n            local name = player:getNickname()\n            setTextBold( true )\n            renderText(posX, posY + 0.02 , textSize, name)\n            setTextBold( false )\n            player:drawDebug(posX, posY, textSize)\n            posX = posX + 0.1\n            numPlayer = numPlayer + 1\n\n            if numPlayer > 9 then\n                posX = startPosX\n                posY = posY - lineOffsetY\n                numPlayer = 1\n            end\n        end\n    end\n\n    if PlayerSystem.DEBUG_SOUNDS then\n        local startPosX = 0.07\n        local lineOffsetY = 0.4\n        local posX = startPosX\n        local posY = 0.9\n        local textSize = getCorrectTextSize( 0.012 )\n        local numPlayer = 1\n\n        for _, player in pairs( self.players) do\n            local name = player:getNickname()\n            setTextBold( true )\n            renderText(posX, posY + 0.02 , textSize, name)\n            setTextBold( false )\n            player.graphicsComponent.sounds:drawDebug(posX, posY, textSize)\n            posX = posX + 0.1\n            numPlayer = numPlayer + 1\n\n            if numPlayer > 9 then\n                posX = startPosX\n                posY = posY - lineOffsetY\n                numPlayer = 1\n            end\n        end\n    end\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"gethasplayerwithuniqueid",children:"getHasPlayerWithUniqueId"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Finds if a player or unloaded data exists for the given unique id."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getHasPlayerWithUniqueId(string uniqueId)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"uniqueId"}),(0,s.jsx)(n.th,{children:"The unique id of the player or data to check for."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"hasPlayer"}),(0,s.jsx)(n.th,{children:"True if the given unique id has a loaded or unloaded player associated with it."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:getHasPlayerWithUniqueId(uniqueId)\n    if g_server ~ = nil then\n        return uniqueId ~ = nil and( self.playersByUniqueId[uniqueId] ~ = nil or self.unloadedPlayerDataByUniqueId[uniqueId] ~ = nil )\n    else\n            return uniqueId ~ = nil and self.playersByUniqueId[uniqueId] ~ = nil\n        end\n    end\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getisplayeradded",children:"getIsPlayerAdded"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Finds if the given player is added to this system as an active player (not as unloaded data)."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getIsPlayerAdded(Player player)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Player"}),(0,s.jsx)(n.th,{children:"player"}),(0,s.jsx)(n.th,{children:"The player to check."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Player"}),(0,s.jsx)(n.th,{children:"isAdded"}),(0,s.jsx)(n.th,{children:"True if the player is in this system; otherwise false."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:getIsPlayerAdded(player)\n    return player ~ = nil and player.uniqueUserId ~ = nil and self:getPlayerByUniqueId(player.uniqueUserId) ~ = nil\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getplayerbyconnection",children:"getPlayerByConnection"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Gets the player from the given connection."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getPlayerByConnection(Connection connection)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Connection"}),(0,s.jsx)(n.th,{children:"connection"}),(0,s.jsx)(n.th,{children:"The connection of the player to get."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Connection"}),(0,s.jsx)(n.th,{children:"player"}),(0,s.jsx)(n.th,{children:"The found player."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:getPlayerByConnection(connection)\n    return self.playersByConnection[connection]\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getplayerbyindex",children:"getPlayerByIndex"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Gets the player from the given index."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getPlayerByIndex(integer index)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"integer"}),(0,s.jsx)(n.th,{children:"index"}),(0,s.jsx)(n.th,{children:"The index of the player to get."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"integer"}),(0,s.jsx)(n.th,{children:"player"}),(0,s.jsx)(n.th,{children:"The found player."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:getPlayerByIndex(index)\n    return self.players[index]\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getplayerbyrootnode",children:"getPlayerByRootNode"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Gets the player from the given root node."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getPlayerByRootNode(entityId rootNode)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"entityId"}),(0,s.jsx)(n.th,{children:"rootNode"}),(0,s.jsx)(n.th,{children:"The root node of the player to get."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"entityId"}),(0,s.jsx)(n.th,{children:"player"}),(0,s.jsx)(n.th,{children:"The found player."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:getPlayerByRootNode(rootNode)\n    return self.playersByRootNode[rootNode]\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getplayerbyuniqueid",children:"getPlayerByUniqueId"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Gets the player from the given unique id."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getPlayerByUniqueId(string uniqueId)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"uniqueId"}),(0,s.jsx)(n.th,{children:"The unique id of the player to get."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"player"}),(0,s.jsx)(n.th,{children:"The found player."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:getPlayerByUniqueId(uniqueId)\n    return self.playersByUniqueId[uniqueId]\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getplayerbyuserid",children:"getPlayerByUserId"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Gets the player from the given user id."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getPlayerByUserId(string userId)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"userId"}),(0,s.jsx)(n.th,{children:"The user id of the player to get."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"player"}),(0,s.jsx)(n.th,{children:"The found player."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:getPlayerByUserId(userId)\n    return self.playersByUserId[userId]\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getplayercount",children:"getPlayerCount"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Gets the count of players currently playing (excluding players not in the world, who have unloaded data)."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getPlayerCount()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"playerCount"}),(0,s.jsx)(n.th,{children:"The number of active players."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:getPlayerCount()\n    return # self.players\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getplayerdatabyuniqueid",children:"getPlayerDataByUniqueId"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Gets the player data from the given unique id."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getPlayerDataByUniqueId(string uniqueId)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"uniqueId"}),(0,s.jsx)(n.th,{children:"The unique id of the player data to get."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"playerData"}),(0,s.jsx)(n.th,{children:"The found player data."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlayerSystem:getPlayerDataByUniqueId(uniqueId)\n    if g_server ~ = nil then\n        return self.unloadedPlayerDataByUniqueId[uniqueId]\n    else\n            return nil\n        end\n    end\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"savehugeunloadedplayers",children:"saveHugeUnloadedPlayers"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Saves PlayerSystem.MAX_NUM_SAVED_PLAYERS unloaded players to the given file at the given key. Trims any players\nover the PlayerSystem.MAX_NUM_SAVED_PLAYERS count, sorted by time last played."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"saveHugeUnloadedPlayers(XMLFile xmlFile, string baseKey)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"XMLFile"}),(0,s.jsx)(n.th,{children:"xmlFile"}),(0,s.jsx)(n.th,{children:"The file to save to."})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"baseKey"}),(0,s.jsx)(n.td,{children:"The base node key to save to."})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function PlayerSystem:saveHugeUnloadedPlayers(xmlFile, baseKey)\n\n    -- All current players were already saved, so all indices must be relative to this.\n    local savedPlayerCount = self:getPlayerCount()\n\n    -- Create a list of the unloaded players and sort them by time last connected.\n    local sortedPlayerDataByLastPlayTime = table.create( self.unloadedPlayerDataCount)\n    for _, playerData in pairs( self.unloadedPlayerDataByUniqueId) do\n        table.insert(sortedPlayerDataByLastPlayTime, playerData)\n    end\n    table.sort(sortedPlayerDataByLastPlayTime, function (a, b) return a.lastConnectedDateTime > b.lastConnectedDateTime end )\n\n    -- Get the current date and time.\n    local currentYear, currentMonth, currentDay, currentHour, currentMinute = string.match(getDate( "%Y/%m/%d %H:%M" ), "(%d+)/(%d+)/(%d+) (%d+):(%d+)" )\n    currentYear, currentMonth, currentDay, currentHour, currentMinute = tonumber(currentYear), tonumber(currentMonth), tonumber(currentDay), tonumber(currentHour), tonumber(currentMinute)\n\n    -- Calculate the maximum number of seconds for a player have logged in during for them to be safe from deletion.\n        local maxSecondsSinceLastConnection = PlayerSystem.MAX_NUM_DAYS_OFFLINE * 24 * 60 * 60\n\n        -- Save the players.\n        for i, playerData in ipairs(sortedPlayerDataByLastPlayTime) do\n\n            -- If the limit of saved players has been hit, check the date last played.\n            if i + savedPlayerCount > PlayerSystem.MAX_NUM_SAVED_PLAYERS then\n\n                -- Get the date and time that the player last logged in.\n                local year, month, day, hour, minute = string.match(playerData.lastConnectedDateTime, "(%d+)/(%d+)/(%d+) (%d+):(%d+)" )\n                year, month, day, hour, minute = tonumber(year), tonumber(month), tonumber(day), tonumber(hour), tonumber(minute)\n\n                -- If the player has not been on for a while, stop saving all players from here.\n                    -- The table is sorted, so it is certain that any consecutive player will not have logged on recently enough.\n                    if year ~ = nil and math.abs(getDateDiffSeconds(year, month, day, hour, minute, 0 , currentYear, currentMonth, currentDay, currentHour, currentMinute, 0 )) > maxSecondsSinceLastConnection then\n                        Logging.xmlInfo(xmlFile, "Excluded %d players from player save:Limit reached and affected players did not join the server for more than %d days" , (savedPlayerCount + self.unloadedPlayerDataCount) - (i - 1 ), PlayerSystem.MAX_NUM_DAYS_OFFLINE)\n                            break\n                        end\n                    end\n\n                    -- Save the player data.\n                    Player.saveDataToXMLFile(xmlFile, playerData, string.format( "%s.player(%d)" , baseKey, (i + savedPlayerCount) - 1 ))\n                end\n            end\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"savetoxmlfile",children:"saveToXMLFile"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Saves all players to an xml file with the given filepath."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"saveToXMLFile(string xmlFilename)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"xmlFilename"}),(0,s.jsx)(n.th,{children:"The filename of the file to save to."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"string"}),(0,s.jsx)(n.th,{children:"success"}),(0,s.jsx)(n.th,{children:"True if the file was saved; otherwise false."})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function PlayerSystem:saveToXMLFile(xmlFilename)\n\n    --#debug Assert.isNotNil(g_server, "Players can only be saved on the server!")\n\n    -- Create the file.\n    local rootKey = "players"\n    local xmlFile = XMLFile.create( "Players" , xmlFilename, rootKey, PlayerSystem.savegameXMLSchema)\n    if xmlFile = = nil then\n        return false\n    end\n\n    -- Always save the players that are currently playing.\n    local savedPlayerCount = 0\n    for i, player in ipairs( self.players) do\n        player:saveToXMLFile(xmlFile, string.format( "%s.player(%d)" , rootKey, savedPlayerCount))\n        savedPlayerCount = savedPlayerCount + 1\n    end\n\n    -- Save the unloaded players, based on if there should be some pruned.\n        if savedPlayerCount + self.unloadedPlayerDataCount > = PlayerSystem.MAX_NUM_SAVED_PLAYERS then\n            self:saveHugeUnloadedPlayers(xmlFile, rootKey)\n        else\n                self:saveUnloadedPlayers(xmlFile, rootKey)\n            end\n\n            -- Finish saving and return true, as the saving was successful.\n            xmlFile:save()\n            xmlFile:delete()\n            return true\n        end\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"saveunloadedplayers",children:"saveUnloadedPlayers"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Saves all unloaded players to the given file at the given key. Does not trim any players."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"saveUnloadedPlayers(XMLFile xmlFile, string baseKey)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"XMLFile"}),(0,s.jsx)(n.th,{children:"xmlFile"}),(0,s.jsx)(n.th,{children:"The file to save to."})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"baseKey"}),(0,s.jsx)(n.td,{children:"The base node key to save to."})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function PlayerSystem:saveUnloadedPlayers(xmlFile, baseKey)\n\n    --#debug Assert.isNotNil(g_server, "Player system should only save from the server!")\n\n    -- All current players were already saved, so all indices must be relative to this.\n    local savedPlayerCount = self:getPlayerCount()\n\n    -- Save all unloaded players.\n    local currentPlayerDataCount = savedPlayerCount\n    for _, playerData in pairs( self.unloadedPlayerDataByUniqueId) do\n        Player.saveDataToXMLFile(xmlFile, playerData, string.format( "%s.player(%d)" , baseKey, currentPlayerDataCount))\n        currentPlayerDataCount = currentPlayerDataCount + 1\n    end\nend\n\n'})})]})}function c(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);