"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[69596],{11810(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>o,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"script/Specializations/ExtendedSprayerEffects","title":"ExtendedSprayerEffects","description":"ExtendedSprayerEffects","source":"@site/../docs/script/Specializations/ExtendedSprayerEffects.md","sourceDirName":"script/Specializations","slug":"/script/Specializations/ExtendedSprayerEffects","permalink":"/FS25-Community-LUADOC/script/Specializations/ExtendedSprayerEffects","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"ExtendedSprayer","permalink":"/FS25-Community-LUADOC/script/Specializations/ExtendedSprayer"},"next":{"title":"ExtendedWearable","permalink":"/FS25-Community-LUADOC/script/Specializations/ExtendedWearable"}}');var r=t(74848),i=t(28453);const a={},d=void 0,l={},c=[{value:"ExtendedSprayerEffects",id:"extendedsprayereffects",level:2},{value:"addExtendedSprayerNozzleEffect",id:"addextendedsprayernozzleeffect",level:3},{value:"addExtendedSprayerNozzleEffects",id:"addextendedsprayernozzleeffects",level:3},{value:"getAreEffectsVisible",id:"getareeffectsvisible",level:3},{value:"getNumExtendedSprayerNozzleEffectsActive",id:"getnumextendedsprayernozzleeffectsactive",level:3},{value:"initExtendedSprayerNozzleEffect",id:"initextendedsprayernozzleeffect",level:3},{value:"initSpecialization",id:"initspecialization",level:3},{value:"onDelete",id:"ondelete",level:3},{value:"onLoad",id:"onload",level:3},{value:"onPostLoad",id:"onpostload",level:3},{value:"onPreInitComponentPlacement",id:"onpreinitcomponentplacement",level:3},{value:"onUpdate",id:"onupdate",level:3},{value:"prerequisitesPresent",id:"prerequisitespresent",level:3},{value:"registerEventListeners",id:"registereventlisteners",level:3},{value:"registerFunctions",id:"registerfunctions",level:3},{value:"registerOverwrittenFunctions",id:"registeroverwrittenfunctions",level:3},{value:"updateExtendedSprayerNozzleEffects",id:"updateextendedsprayernozzleeffects",level:3},{value:"updateExtendedSprayerNozzleEffectsState",id:"updateextendedsprayernozzleeffectsstate",level:3},{value:"updateExtendedSprayerNozzleEffectState",id:"updateextendedsprayernozzleeffectstate",level:3}];function f(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"extendedsprayereffects",children:"ExtendedSprayerEffects"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Specialization to have individual nozzle effects for sprayers (controlled by ExtendedSprayer & WeedSpotSpray\nspecializations)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Functions"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#addextendedsprayernozzleeffect",children:"addExtendedSprayerNozzleEffect"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#addextendedsprayernozzleeffects",children:"addExtendedSprayerNozzleEffects"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#getareeffectsvisible",children:"getAreEffectsVisible"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#getnumextendedsprayernozzleeffectsactive",children:"getNumExtendedSprayerNozzleEffectsActive"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#initextendedsprayernozzleeffect",children:"initExtendedSprayerNozzleEffect"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#initspecialization",children:"initSpecialization"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#ondelete",children:"onDelete"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#onload",children:"onLoad"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#onpostload",children:"onPostLoad"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#onpreinitcomponentplacement",children:"onPreInitComponentPlacement"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#onupdate",children:"onUpdate"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#prerequisitespresent",children:"prerequisitesPresent"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#registereventlisteners",children:"registerEventListeners"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#registerfunctions",children:"registerFunctions"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#registeroverwrittenfunctions",children:"registerOverwrittenFunctions"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#updateextendedsprayernozzleeffects",children:"updateExtendedSprayerNozzleEffects"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#updateextendedsprayernozzleeffectsstate",children:"updateExtendedSprayerNozzleEffectsState"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#updateextendedsprayernozzleeffectstate",children:"updateExtendedSprayerNozzleEffectState"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"addextendedsprayernozzleeffect",children:"addExtendedSprayerNozzleEffect"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"addExtendedSprayerNozzleEffect()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"effectData"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"effectNode"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"linkNode"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"effectNodeData"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function ExtendedSprayerEffects:addExtendedSprayerNozzleEffect(effectData, effectNode, linkNode, effectNodeData)\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n    effectData.effectNode = effectNode\n\n    effectData.isActive = false\n    effectData.amountScale = 1\n\n    effectData.lastWorldTranslation = { 0 , 0 , 0 }\n    effectData.speed = 0\n\n    effectData.fadeCur = { - 1 , 1 }\n    effectData.fadeDir = ExtendedSprayerEffects.EFFECT_DIRECTION_OFF\n    effectData.state = ShaderPlaneEffect.STATE_OFF\n\n    setShaderParameter(effectNode, "fadeProgress" , effectData.fadeCur[ 1 ], effectData.fadeCur[ 2 ], 0.0 , 0.0 , false )\n    setShaderParameter(effectNode, "offsetUV" , math.random(), math.random(), 0.0 , 0.0 , false )\n\n    setShaderParameter(effectNode, "isPulsating" , spec.pwmEnabled and 1 or 0 , nil , nil , nil , false )\n    setShaderParameter(effectNode, "blinkMulti" , 1 , 1 , 100 , math.random() * 100 , false )\n\n    link(linkNode, effectNode)\n\n    if effectNodeData ~ = nil then\n        setTranslation(effectNode, effectNodeData.translation[ 1 ], effectNodeData.translation[ 2 ], effectNodeData.translation[ 3 ])\n        setRotation(effectNode, effectNodeData.rotation[ 1 ], effectNodeData.rotation[ 2 ], effectNodeData.rotation[ 3 ])\n    end\n\n    local _\n    effectData.xOffset, _, _ = localToLocal(effectNode, self:getParentComponent(linkNode), 0 , 0 , 0 )\n\n    return true\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"addextendedsprayernozzleeffects",children:"addExtendedSprayerNozzleEffects"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"addExtendedSprayerNozzleEffects()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"linkData"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function ExtendedSprayerEffects:addExtendedSprayerNozzleEffects(linkData)\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n\n    for _, effectNodeData in pairs(linkData.effectNodes) do\n        local linkNode\n        if effectNodeData.nodeName ~ = nil then\n            if self.i3dMappings[effectNodeData.nodeName] ~ = nil then\n                linkNode = self.i3dMappings[effectNodeData.nodeName].nodeId\n            end\n        end\n\n        if linkNode ~ = nil then\n            local effectNode = g_precisionFarming:getClonedSprayerEffectNode()\n            if effectNode ~ = nil then\n                local effectData = { }\n                if self:addExtendedSprayerNozzleEffect(effectData, effectNode, linkNode, effectNodeData) then\n                    table.insert(spec.sprayerEffects, effectData)\n                end\n            end\n        end\n    end\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"getareeffectsvisible",children:"getAreEffectsVisible"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"getAreEffectsVisible()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"superFunc"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function ExtendedSprayerEffects:getAreEffectsVisible(superFunc)\n    -- effects are fully overwritten by the nozzle effects\n    if self [ ExtendedSprayerEffects.SPEC_TABLE_NAME].hasCustomEffects then\n        return false\n    end\n\n    return superFunc( self )\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"getnumextendedsprayernozzleeffectsactive",children:"getNumExtendedSprayerNozzleEffectsActive"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"getNumExtendedSprayerNozzleEffectsActive()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function ExtendedSprayerEffects:getNumExtendedSprayerNozzleEffectsActive()\n    local specEffects = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n    if specEffects.hasCustomEffects then\n        local numActiveEffects = 0\n        for _, effectData in pairs(specEffects.sprayerEffects) do\n            if effectData.isActive then\n                numActiveEffects = numActiveEffects + 1\n            end\n        end\n\n        return numActiveEffects, numActiveEffects / specEffects.numCustomEffects\n    end\n\n    return 1 , 1\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"initextendedsprayernozzleeffect",children:"initExtendedSprayerNozzleEffect"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"initExtendedSprayerNozzleEffect()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"effectData"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function ExtendedSprayerEffects:initExtendedSprayerNozzleEffect(effectData)\n    local spec_variableWorkWidth = self.spec_variableWorkWidth\n    if spec_variableWorkWidth ~ = nil then\n        local numSections = #spec_variableWorkWidth.sections\n        if numSections > 0 then\n            local minWidth = 1\n            if #spec_variableWorkWidth.sectionNodes > 0 then\n                local sectionNode = spec_variableWorkWidth.sectionNodes[ 1 ]\n                minWidth = math.abs(sectionNode.startTransX or sectionNode.startTrans[ 1 ])\n            end\n\n            local x = effectData.xOffset or 0\n            if x > 0 then\n                effectData.sectionIndex = 0\n\n                for _, section in ipairs(spec_variableWorkWidth.sectionsLeft) do\n                    if x > minWidth and x < = section.widthAbs then\n                        effectData.sectionIndex = section.index\n                        break\n                    end\n                end\n            else\n                    effectData.sectionIndex = 0\n\n                    for _, section in ipairs(spec_variableWorkWidth.sectionsRight) do\n                        if x < - minWidth and x > = section.widthAbs then\n                            effectData.sectionIndex = section.index\n                            break\n                        end\n                    end\n                end\n            end\n        end\n    end\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"initspecialization",children:"initSpecialization"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Called while initializing the specialization"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"initSpecialization()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function ExtendedSprayerEffects.initSpecialization()\n    local schema = Vehicle.xmlSchema\n    schema:setXMLSpecializationType( "ExtendedSprayerEffects" )\n\n    schema:register(XMLValueType.INT, "vehicle.sprayer.nozzles(?)#foldingConfigurationIndex" , "Folding configuration index to use these nozzles" , 1 )\n\n    schema:register(XMLValueType.NODE_INDEX, "vehicle.sprayer.nozzles(?).nozzle(?)#node" , "Nozzle Node" )\n    schema:register(XMLValueType.VECTOR_TRANS, "vehicle.sprayer.nozzles(?).nozzle(?)#translation" , "Translation offset from the defined node" )\n    schema:register(XMLValueType.VECTOR_ROT, "vehicle.sprayer.nozzles(?).nozzle(?)#rotation" , "Rotation offset from the defined node" )\n\n    schema:setXMLSpecializationType()\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"ondelete",children:"onDelete"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"onDelete()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function ExtendedSprayerEffects:onDelete()\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n\n    if spec.soundSamplesBySection ~ = nil then\n        for _, sampleData in pairs(spec.soundSamplesBySection) do\n            g_soundManager:deleteSample(sampleData.turnOn)\n            g_soundManager:deleteSample(sampleData.turnOff)\n        end\n    end\n\n    g_soundManager:deleteSample(spec.spraySampleLeft)\n    g_soundManager:deleteSample(spec.spraySampleRight)\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"onload",children:"onLoad"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"onLoad()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function ExtendedSprayerEffects:onLoad(savegame)\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n\n    spec.pwmEnabled = ( self.configurations[ "pulseWidthModulation" ] or 1 ) > 1\n    spec.individualNozzleControl = spec.pwmEnabled or( self.getIsSpotSprayEnabled ~ = nil and self:getIsSpotSprayEnabled())\n\n    spec.effectFadeTime = 250\n    spec.effectsDirty = false\n\n    spec.sprayerEffects = { }\n    spec.sprayerEffectsBySection = { }\n    spec.soundSamplesBySection = { }\n\n    if g_precisionFarming ~ = nil then\n        local linkData, _ = g_precisionFarming:getSprayerNodeData( self.configFileName, self.configurations)\n        if linkData ~ = nil then\n            self:addExtendedSprayerNozzleEffects(linkData)\n        end\n    end\n\n    spec.nozzleNodesToDelete = { }\n    self.xmlFile:iterate( "vehicle.sprayer.nozzles" , function (index, nozzlesKey)\n        local foldingConfigIndex = self.xmlFile:getValue(nozzlesKey .. "#foldingConfigurationIndex" , 1 )\n\n        self.xmlFile:iterate(nozzlesKey .. ".nozzle" , function (_, key)\n            local linkNode = self.xmlFile:getValue(key .. "#node" , nil , self.components, self.i3dMappings)\n            if linkNode ~ = nil then\n                if foldingConfigIndex = = self.configurations[ "folding" ] or( self.configurations[ "folding" ] = = nil and foldingConfigIndex = = 1 ) then\n                    local effectNode = g_precisionFarming:getClonedSprayerEffectNode()\n                    if effectNode ~ = nil then\n                        local effectNodeData = { }\n                        effectNodeData.translation = self.xmlFile:getValue(key .. "#translation" , { 0 , 0 , 0 } , true )\n                        effectNodeData.rotation = self.xmlFile:getValue(key .. "#rotation" , { 0 , 0 , 0 } , true )\n\n                        local effectData = { }\n                        if self:addExtendedSprayerNozzleEffect(effectData, effectNode, linkNode, effectNodeData) then\n                            table.insert(spec.sprayerEffects, effectData)\n                        end\n                    end\n                else\n                        spec.nozzleNodesToDelete[linkNode] = true\n                    end\n                end\n            end )\n        end )\n\n        for i = 1 , #spec.nozzleNodesToDelete do\n            if entityExists(spec.nozzleNodesToDelete[i]) then\n                delete(spec.nozzleNodesToDelete[i])\n            end\n        end\n        spec.nozzleNodesToDelete = { }\n    end\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"onpostload",children:"onPostLoad"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"onPostLoad()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function ExtendedSprayerEffects:onPostLoad(savegame)\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n\n    for _, effectData in pairs(spec.sprayerEffects) do\n        self:initExtendedSprayerNozzleEffect(effectData)\n\n        if spec.sprayerEffectsBySection[effectData.sectionIndex] = = nil then\n            spec.sprayerEffectsBySection[effectData.sectionIndex] = { }\n        end\n        table.insert(spec.sprayerEffectsBySection[effectData.sectionIndex], effectData)\n    end\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"onpreinitcomponentplacement",children:"onPreInitComponentPlacement"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"onPreInitComponentPlacement()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function ExtendedSprayerEffects:onPreInitComponentPlacement(savegame)\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n\n    spec.numCustomEffects = #spec.sprayerEffects\n    spec.hasCustomEffects = spec.numCustomEffects > 0\n    if not spec.hasCustomEffects then\n        SpecializationUtil.removeEventListener( self , "onUpdate" , ExtendedSprayerEffects )\n    else\n            -- we disable the manual switching of the sections as we auto control them and hide the hud extension\n            SpecializationUtil.removeEventListener( self , "onDraw" , VariableWorkWidth )\n            SpecializationUtil.removeEventListener( self , "onRegisterActionEvents" , VariableWorkWidth )\n\n            local specSprayer = self.spec_sprayer\n            if specSprayer.samples ~ = nil then\n                g_soundManager:deleteSamples(specSprayer.samples.spray)\n                specSprayer.samples.spray = { }\n            end\n\n            for _, sprayType in pairs(specSprayer.sprayTypes) do\n                if sprayType.samples ~ = nil then\n                    g_soundManager:deleteSamples(sprayType.samples.spray)\n                    sprayType.samples.spray = { }\n                end\n            end\n\n            local leftX, leftY, leftZ, numLeft = 0 , 0 , 0 , 0\n            local rightX, rightY, rightZ, numRight = 0 , 0 , 0 , 0\n\n            for sectionIndex, sprayerEffects in pairs(spec.sprayerEffectsBySection) do\n                local linkNode = createTransformGroup( "sectionCenterNode" .. tostring(sectionIndex))\n                link( self.rootNode, linkNode)\n\n                local wx, wy, wz = 0 , 0 , 0\n                local isLeft = false\n                for i, effectData in ipairs(sprayerEffects) do\n                    local x, y, z = getWorldTranslation(effectData.effectNode)\n                    wx, wy, wz = wx + x, wy + y, wz + z\n\n                    local xOffset, _, _ = localToLocal(effectData.effectNode, self.rootNode, 0 , 0 , 0 )\n                    if xOffset > 0 then\n                        leftX, leftY, leftZ = leftX + x, leftY + y, leftZ + z\n                        numLeft = numLeft + 1\n\n                        isLeft = true\n                    else\n                            rightX, rightY, rightZ = rightX + x, rightY + y, rightZ + z\n                            numRight = numRight + 1\n                        end\n                    end\n\n                    local numEffects = #sprayerEffects\n                    wx = wx / numEffects\n                    wy = wy / numEffects\n                    wz = wz / numEffects\n                    setWorldTranslation(linkNode, wx, wy, wz)\n\n                    local sampleData = { }\n                    sampleData.linkNode = linkNode\n                    sampleData.sectionIndex = sectionIndex\n                    sampleData.sprayIsActive = false\n                    sampleData.isLeft = isLeft\n\n                    sampleData.turnOn = g_precisionFarming:getSprayerClonedSectionSamples( "turnOn" , linkNode, self )\n                    sampleData.turnOff = g_precisionFarming:getSprayerClonedSectionSamples( "turnOff" , linkNode, self )\n\n                    spec.soundSamplesBySection[sectionIndex] = sampleData\n                end\n\n                if numLeft > 0 then\n                    leftX, leftY, leftZ = leftX / numLeft, leftY / numLeft, leftZ / numLeft\n\n                    local sampleLinkNode = createTransformGroup( "sectionsLeftNode" )\n                    link( self.rootNode, sampleLinkNode)\n                    setWorldTranslation(sampleLinkNode, leftX, leftY, leftZ)\n                    spec.spraySampleLeft = g_precisionFarming:getSprayerClonedSectionSamples( "spray" , sampleLinkNode, self )\n                end\n\n                if numRight > 0 then\n                    rightX, rightY, rightZ = rightX / numRight, rightY / numRight, rightZ / numRight\n\n                    local sampleLinkNode = createTransformGroup( "sectionsRightNode" )\n                    link( self.rootNode, sampleLinkNode)\n                    setWorldTranslation(sampleLinkNode, rightX, rightY, rightZ)\n                    spec.spraySampleRight = g_precisionFarming:getSprayerClonedSectionSamples( "spray" , sampleLinkNode, self )\n                end\n\n                for _, sampleData in pairs(spec.soundSamplesBySection) do\n                    if sampleData.isLeft then\n                        sampleData.spray = spec.spraySampleLeft\n                    else\n                            sampleData.spray = spec.spraySampleRight\n                        end\n                    end\n                end\n            end\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"onupdate",children:"onUpdate"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Called on update"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"onUpdate(float dt, boolean isActiveForInput, boolean isSelected, )"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"float"}),(0,r.jsx)(n.th,{children:"dt"}),(0,r.jsx)(n.th,{children:"time since last call in ms"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"isActiveForInput"}),(0,r.jsx)(n.td,{children:"true if vehicle is active for input"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"isSelected"}),(0,r.jsx)(n.td,{children:"true if vehicle is selected"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"isSelected"}),(0,r.jsx)(n.td,{})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function ExtendedSprayerEffects:onUpdate(dt, isActiveForInput, isActiveForInputIgnoreSelection, isSelected)\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n\n    --#profile RemoteProfiler.zoneBeginN("ExtendedSprayerEffects:updateExtendedSprayerNozzleEffectState")\n\n    local isTurnedOn = self:getIsTurnedOn()\n    local lastSpeed = self:getLastSpeed()\n    if spec.individualNozzleControl then\n        self:updateExtendedSprayerNozzleEffectsState(spec.sprayerEffects, false , dt, isTurnedOn, lastSpeed)\n    else\n            for _, sprayerEffects in pairs(spec.sprayerEffectsBySection) do\n                self:updateExtendedSprayerNozzleEffectsState(sprayerEffects, true , dt, isTurnedOn, lastSpeed)\n            end\n        end\n\n        --#profile RemoteProfiler.zoneEnd()\n\n        --#profile RemoteProfiler.zoneBeginN("ExtendedSprayerEffects:updateExtendedSprayerNozzleEffects")\n        if spec.effectsDirty then\n            spec.effectsDirty = false\n\n            self:updateExtendedSprayerNozzleEffects(dt)\n            self:raiseActive()\n        end\n        --#profile RemoteProfiler.zoneEnd()\n    end\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"prerequisitespresent",children:"prerequisitesPresent"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Checks if all prerequisite specializations are loaded"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"prerequisitesPresent(table specializations)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"table"}),(0,r.jsx)(n.th,{children:"specializations"}),(0,r.jsx)(n.th,{children:"specializations"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"table"}),(0,r.jsx)(n.th,{children:"hasPrerequisite"}),(0,r.jsx)(n.th,{children:"true if all prerequisite specializations are loaded"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function ExtendedSprayerEffects.prerequisitesPresent(specializations)\n    return SpecializationUtil.hasSpecialization( Sprayer , specializations) and SpecializationUtil.hasSpecialization( ExtendedSprayer , specializations)\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"registereventlisteners",children:"registerEventListeners"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"registerEventListeners()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"vehicleType"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function ExtendedSprayerEffects.registerEventListeners(vehicleType)\n    SpecializationUtil.registerEventListener(vehicleType, "onLoad" , ExtendedSprayerEffects )\n    SpecializationUtil.registerEventListener(vehicleType, "onPostLoad" , ExtendedSprayerEffects )\n    SpecializationUtil.registerEventListener(vehicleType, "onPreInitComponentPlacement" , ExtendedSprayerEffects )\n    SpecializationUtil.registerEventListener(vehicleType, "onUpdate" , ExtendedSprayerEffects )\n    SpecializationUtil.registerEventListener(vehicleType, "onDelete" , ExtendedSprayerEffects )\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"registerfunctions",children:"registerFunctions"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"registerFunctions()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"vehicleType"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function ExtendedSprayerEffects.registerFunctions(vehicleType)\n    SpecializationUtil.registerFunction(vehicleType, "addExtendedSprayerNozzleEffects" , ExtendedSprayerEffects.addExtendedSprayerNozzleEffects)\n    SpecializationUtil.registerFunction(vehicleType, "addExtendedSprayerNozzleEffect" , ExtendedSprayerEffects.addExtendedSprayerNozzleEffect)\n    SpecializationUtil.registerFunction(vehicleType, "initExtendedSprayerNozzleEffect" , ExtendedSprayerEffects.initExtendedSprayerNozzleEffect)\n    SpecializationUtil.registerFunction(vehicleType, "updateExtendedSprayerNozzleEffectsState" , ExtendedSprayerEffects.updateExtendedSprayerNozzleEffectsState)\n    SpecializationUtil.registerFunction(vehicleType, "updateExtendedSprayerNozzleEffectState" , ExtendedSprayerEffects.updateExtendedSprayerNozzleEffectState)\n    SpecializationUtil.registerFunction(vehicleType, "updateExtendedSprayerNozzleEffects" , ExtendedSprayerEffects.updateExtendedSprayerNozzleEffects)\n    SpecializationUtil.registerFunction(vehicleType, "getNumExtendedSprayerNozzleEffectsActive" , ExtendedSprayerEffects.getNumExtendedSprayerNozzleEffectsActive)\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"registeroverwrittenfunctions",children:"registerOverwrittenFunctions"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"registerOverwrittenFunctions()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"vehicleType"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function ExtendedSprayerEffects.registerOverwrittenFunctions(vehicleType)\n    SpecializationUtil.registerOverwrittenFunction(vehicleType, "getAreEffectsVisible" , ExtendedSprayerEffects.getAreEffectsVisible)\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"updateextendedsprayernozzleeffects",children:"updateExtendedSprayerNozzleEffects"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"updateExtendedSprayerNozzleEffects()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"dt"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function ExtendedSprayerEffects:updateExtendedSprayerNozzleEffects(dt)\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n    for _, effectData in pairs(spec.sprayerEffects) do\n        local fadeSpeedScale = 1\n\n        if effectData.state = = ShaderPlaneEffect.STATE_TURNING_ON or effectData.state = = ShaderPlaneEffect.STATE_TURNING_OFF then\n            effectData.fadeCur[ 1 ] = math.max( math.min(effectData.fadeCur[ 1 ] + effectData.fadeDir[ 1 ] * (dt / (spec.effectFadeTime * fadeSpeedScale)), 1 ), - 1 )\n            effectData.fadeCur[ 2 ] = math.max( math.min(effectData.fadeCur[ 2 ] + effectData.fadeDir[ 2 ] * (dt / (spec.effectFadeTime * fadeSpeedScale)), 1 ), - 1 )\n\n            setShaderParameter(effectData.effectNode, "fadeProgress" , effectData.fadeCur[ 1 ], effectData.fadeCur[ 2 ], 0.0 , 0.0 , false )\n\n            if effectData.state = = ShaderPlaneEffect.STATE_TURNING_OFF then\n                if effectData.fadeCur[ 1 ] = = 1 and effectData.fadeCur[ 2 ] = = - 1 then\n                    effectData.state = ShaderPlaneEffect.STATE_OFF\n                end\n            elseif effectData.state = = ShaderPlaneEffect.STATE_TURNING_ON then\n                    if effectData.fadeCur[ 1 ] = = 1 and effectData.fadeCur[ 2 ] = = 1 then\n                        effectData.state = ShaderPlaneEffect.STATE_ON\n                    end\n                end\n\n                spec.effectsDirty = true\n            end\n\n            if spec.pwmEnabled then\n                local pauseTicks = 1 + math.max( math.floor(( 1 - effectData.amountScale) * 5 ), 0 )\n                setShaderParameter(effectData.effectNode, "blinkMulti" , nil , pauseTicks, nil , nil , false )\n            end\n        end\n    end\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"updateextendedsprayernozzleeffectsstate",children:"updateExtendedSprayerNozzleEffectsState"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"updateExtendedSprayerNozzleEffectsState()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"sprayerEffects"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"useFullSection"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"dt"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"isTurnedOn"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"lastSpeed"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function ExtendedSprayerEffects:updateExtendedSprayerNozzleEffectsState(sprayerEffects, useFullSection, dt, isTurnedOn, lastSpeed)\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n\n    local anyEffectActive = false\n    for _, effectData in pairs(sprayerEffects) do\n        local isActive, amountScale = self:updateExtendedSprayerNozzleEffectState(effectData, dt, isTurnedOn, lastSpeed)\n\n        effectData.isDirty = isActive ~ = effectData.isActive\n        effectData.isActive = isActive\n\n        if amountScale ~ = effectData.amountScale then\n            effectData.amountScale = amountScale\n            spec.effectsDirty = true\n        end\n\n        if useFullSection and isActive then\n            anyEffectActive = true\n            break\n        end\n    end\n\n    -- as soon as we turn on one nozzle of the section, we turn on all\n    if useFullSection then\n        if anyEffectActive then\n            for _, effectData in pairs(sprayerEffects) do\n                if not effectData.isActive then\n                    effectData.isActive = true\n                    effectData.isDirty = true\n                end\n            end\n        end\n    end\n\n    for _, effectData in pairs(sprayerEffects) do\n        if effectData.isDirty then\n            effectData.isDirty = false\n            spec.effectsDirty = true\n\n            if effectData.isActive then\n                if effectData.state ~ = ShaderPlaneEffect.STATE_ON and effectData.state ~ = ShaderPlaneEffect.STATE_TURNING_ON then\n                    effectData.state = ShaderPlaneEffect.STATE_TURNING_ON\n                    effectData.fadeDir = ExtendedSprayerEffects.EFFECT_DIRECTION_START\n                    effectData.fadeCur[ 1 ] = - 1\n                    effectData.fadeCur[ 2 ] = 1\n                end\n            else\n                    if effectData.state ~ = ShaderPlaneEffect.STATE_OFF and effectData.state ~ = ShaderPlaneEffect.STATE_TURNING_OFF then\n                        effectData.state = ShaderPlaneEffect.STATE_TURNING_OFF\n                        effectData.fadeDir = ExtendedSprayerEffects.EFFECT_DIRECTION_STOP\n                    end\n                end\n\n                local sampleData = spec.soundSamplesBySection[effectData.sectionIndex]\n                if sampleData ~ = nil then\n                    local sprayIsActive = g_soundManager:getIsSamplePlaying(sampleData.spray)\n\n                    if effectData.isActive then\n                        if not g_soundManager:getIsSamplePlaying(sampleData.turnOn) then\n                            g_soundManager:playSample(sampleData.turnOn)\n                        end\n\n                        if not sprayIsActive then\n                            g_soundManager:playSample(sampleData.spray, 0 , sampleData.turnOn)\n                        end\n                    end\n\n                    if not effectData.isActive then\n                        if not g_soundManager:getIsSamplePlaying(sampleData.turnOff) then\n                            g_soundManager:playSample(sampleData.turnOff)\n                        end\n\n                        local anyOtherEffectActive = false\n                        for sectionIndex, otherSampleData in pairs(spec.soundSamplesBySection) do\n                            if otherSampleData ~ = sampleData and otherSampleData.spray = = sampleData.spray then\n                                local otherEffects = spec.sprayerEffectsBySection[sectionIndex]\n                                for _, otherEffect in pairs(otherEffects) do\n                                    if otherEffect.isActive then\n                                        anyOtherEffectActive = true\n                                        break\n                                    end\n                                end\n                            end\n                        end\n\n                        if not anyOtherEffectActive and sprayIsActive then\n                            g_soundManager:stopSample(sampleData.spray)\n                        end\n                    end\n                end\n            end\n        end\n    end\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"updateextendedsprayernozzleeffectstate",children:"updateExtendedSprayerNozzleEffectState"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"updateExtendedSprayerNozzleEffectState()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"effectData"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"dt"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"isTurnedOn"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"lastSpeed"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function ExtendedSprayerEffects:updateExtendedSprayerNozzleEffectState(effectData, dt, isTurnedOn, lastSpeed)\n    if effectData.sectionIndex ~ = 0 then\n        if not self.spec_variableWorkWidth.sections[effectData.sectionIndex].isActive then\n            return false , 1\n        end\n    end\n\n    local spec = self [ ExtendedSprayerEffects.SPEC_TABLE_NAME]\n    if spec.pwmEnabled then\n        local x, y, z = getWorldTranslation(effectData.effectNode)\n        local lx, ly, lz = effectData.lastWorldTranslation[ 1 ], effectData.lastWorldTranslation[ 2 ], effectData.lastWorldTranslation[ 3 ]\n        local distance = MathUtil.vector3Length(x - lx, y - ly, z - lz)\n        effectData.speed = distance / (g_physicsDt * 0.001 ) * 3.6\n        effectData.lastWorldTranslation[ 1 ], effectData.lastWorldTranslation[ 2 ], effectData.lastWorldTranslation[ 3 ] = x, y, z\n\n        return isTurnedOn, math.min(effectData.speed / self.speedLimit, 1 )\n    else\n            if (lastSpeed or 1 ) < 0.1 then\n                isTurnedOn = false\n            end\n        end\n\n        return isTurnedOn, 1\n    end\n\n"})})]})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(f,{...e})}):f(e)}},28453(e,n,t){t.d(n,{R:()=>a,x:()=>d});var s=t(96540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);