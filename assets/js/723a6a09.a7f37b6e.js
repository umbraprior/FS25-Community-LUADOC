"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[15366],{28453(e,n,i){i.d(n,{R:()=>c,x:()=>t});var s=i(96540);const r={},l=s.createContext(r);function c(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(l.Provider,{value:n},e.children)}},90555(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"script/Specializations/TipOccluder","title":"TipOccluder","description":"TipOccluder","source":"@site/../docs/script/Specializations/TipOccluder.md","sourceDirName":"script/Specializations","slug":"/script/Specializations/TipOccluder","permalink":"/FS25-Community-LUADOC/script/Specializations/TipOccluder","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"TestAreas","permalink":"/FS25-Community-LUADOC/script/Specializations/TestAreas"},"next":{"title":"TireTracks","permalink":"/FS25-Community-LUADOC/script/Specializations/TireTracks"}}');var r=i(74848),l=i(28453);const c={},t=void 0,o={},d=[{value:"TipOccluder",id:"tipoccluder",level:2},{value:"getRequiresTipOcclusionArea",id:"getrequirestipocclusionarea",level:3},{value:"getTipOcclusionAreas",id:"gettipocclusionareas",level:3},{value:"getWheelsWithTipOcclisionAreaGroupId",id:"getwheelswithtipocclisionareagroupid",level:3},{value:"initSpecialization",id:"initspecialization",level:3},{value:"onLoad",id:"onload",level:3},{value:"onLoadFinished",id:"onloadfinished",level:3},{value:"prerequisitesPresent",id:"prerequisitespresent",level:3},{value:"registerEventListeners",id:"registereventlisteners",level:3},{value:"registerFunctions",id:"registerfunctions",level:3},{value:"registerOverwrittenFunctions",id:"registeroverwrittenfunctions",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"tipoccluder",children:"TipOccluder"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Specialization allowing vehicles to prevent tipping filltypes in specified areas (e.g. below wheels)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Functions"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#getrequirestipocclusionarea",children:"getRequiresTipOcclusionArea"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#gettipocclusionareas",children:"getTipOcclusionAreas"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#getwheelswithtipocclisionareagroupid",children:"getWheelsWithTipOcclisionAreaGroupId"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#initspecialization",children:"initSpecialization"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#onload",children:"onLoad"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#onloadfinished",children:"onLoadFinished"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#prerequisitespresent",children:"prerequisitesPresent"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#registereventlisteners",children:"registerEventListeners"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#registerfunctions",children:"registerFunctions"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#registeroverwrittenfunctions",children:"registerOverwrittenFunctions"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"getrequirestipocclusionarea",children:"getRequiresTipOcclusionArea"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"getRequiresTipOcclusionArea()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function TipOccluder:getRequiresTipOcclusionArea()\n    return false\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"gettipocclusionareas",children:"getTipOcclusionAreas"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"getTipOcclusionAreas()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function TipOccluder:getTipOcclusionAreas()\n    return self.spec_tipOccluder.tipOcclusionAreas\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"getwheelswithtipocclisionareagroupid",children:"getWheelsWithTipOcclisionAreaGroupId"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"getWheelsWithTipOcclisionAreaGroupId()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"wheels"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"groupId"})]})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function TipOccluder:getWheelsWithTipOcclisionAreaGroupId(wheels, groupId)\n    local returnWheels = { }\n    for _,wheel in pairs(wheels) do\n        if wheel.physics.tipOcclusionAreaGroupId = = groupId then\n            table.insert(returnWheels, wheel)\n        end\n    end\n    return returnWheels\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"initspecialization",children:"initSpecialization"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"initSpecialization()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function TipOccluder.initSpecialization()\n    local schema = Vehicle.xmlSchema\n    schema:setXMLSpecializationType( "TipOccluder" )\n\n    schema:register(XMLValueType.NODE_INDEX, "vehicle.tipOccluder.occlusionArea(?)#start" , "Start node" )\n    schema:register(XMLValueType.NODE_INDEX, "vehicle.tipOccluder.occlusionArea(?)#width" , "Width node" )\n    schema:register(XMLValueType.NODE_INDEX, "vehicle.tipOccluder.occlusionArea(?)#height" , "Height node" )\n\n    schema:setXMLSpecializationType()\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"onload",children:"onLoad"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"onLoad()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function TipOccluder:onLoad(savegame)\n    local spec = self.spec_tipOccluder\n\n    XMLUtil.checkDeprecatedXMLElements( self.xmlFile, "vehicle.tipOcclusionAreas.tipOcclusionArea" , "vehicle.tipOccluder.occlusionArea" ) --FS17 to FS19\n\n    -- load tip occlusion areas\n    spec.tipOcclusionAreas = { }\n    local i = 0\n    while true do\n        local key = string.format( "vehicle.tipOccluder.occlusionArea(%d)" , i)\n        if not self.xmlFile:hasProperty(key) then\n            break\n        end\n        local entry = { }\n        entry.start = self.xmlFile:getValue(key .. "#start" , nil , self.components, self.i3dMappings)\n        entry.width = self.xmlFile:getValue(key .. "#width" , nil , self.components, self.i3dMappings)\n        entry.height = self.xmlFile:getValue(key .. "#height" , nil , self.components, self.i3dMappings)\n        if entry.start ~ = nil and entry.width ~ = nil and entry.height ~ = nil then\n            table.insert(spec.tipOcclusionAreas, entry)\n        end\n        i = i + 1\n    end\n\n    spec.createdTipOcclusionAreaGroupIds = { }\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"onloadfinished",children:"onLoadFinished"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"onLoadFinished()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function TipOccluder:onLoadFinished(savegame)\n    if self.getWheels ~ = nil then\n        for i, wheel in ipairs( self:getWheels()) do\n            local spec = self.spec_tipOccluder\n            local wheelGroupId = wheel.physics.tipOcclusionAreaGroupId\n            if wheelGroupId ~ = nil then\n                local vehicleRootNode = self.components[ 1 ].node\n                local doCreate = true\n                local area\n                for groupId, occluderArea in pairs(spec.createdTipOcclusionAreaGroupIds) do\n                    if groupId = = wheelGroupId then\n                        doCreate = false\n                        area = occluderArea\n                        break\n                    end\n                end\n\n                -- the first wheel with the group id creates the area, the other just recalculate the area\n                if doCreate then\n                    local start = createTransformGroup( string.format( "tipOcclusionAreaGroupId%d" , wheelGroupId))\n                    local width = createTransformGroup( string.format( "tipOcclusionAreaGroupId%d" , wheelGroupId))\n                    local height = createTransformGroup( string.format( "tipOcclusionAreaGroupId%d" , wheelGroupId))\n                    link(vehicleRootNode, start)\n                    link(vehicleRootNode, width)\n                    link(vehicleRootNode, height)\n\n                    area = { start = start, width = width, height = height }\n                    table.insert(spec.tipOcclusionAreas, area)\n                    spec.createdTipOcclusionAreaGroupIds[wheelGroupId] = area\n                end\n\n                if area ~ = nil then\n                    local xMax = - math.huge\n                    local xMin = math.huge\n                    local zMax = - math.huge\n                    local zMin = math.huge\n\n                    -- get other wheels with the same area group id\n                    local usedWheels = self:getWheelsWithTipOcclisionAreaGroupId( self:getWheels(), wheelGroupId)\n\n                    -- also include myself into the calculation\n                    table.insert(usedWheels, wheel)\n\n                    local rootNodeToUse = usedWheels[#usedWheels].node\n\n                    link(rootNodeToUse, area.start)\n                    link(rootNodeToUse, area.width)\n                    link(rootNodeToUse, area.height)\n\n                    for _,usedWheel in pairs(usedWheels) do\n                        local x,_,z = localToLocal(usedWheel.driveNode, rootNodeToUse, usedWheel.physics.wheelShapeWidth - 0.5 * usedWheel.physics.width, 0 , - usedWheel.physics.radius)\n                        xMax = math.max(x, xMax)\n                        zMin = math.min(z, zMin)\n                        x,_,z = localToLocal(usedWheel.driveNode, rootNodeToUse, - usedWheel.physics.wheelShapeWidth + 0.5 * usedWheel.physics.width, 0 , usedWheel.physics.radius)\n                        xMin = math.min(x, xMin)\n                        zMax = math.max(z, zMax)\n                    end\n\n                    setTranslation(area.start, xMax, 0 ,zMin)\n                    setTranslation(area.width, xMin, 0 ,zMin)\n                    setTranslation(area.height, xMax, 0 ,zMax)\n                end\n            end\n        end\n    end\n\n    if self:getRequiresTipOcclusionArea() then\n        if # self.spec_tipOccluder.tipOcclusionAreas = = 0 then\n            Logging.xmlDevWarning( self.xmlFile, "No TipOcclusionArea defined" )\n        end\n    end\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"prerequisitespresent",children:"prerequisitesPresent"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"prerequisitesPresent()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"specializations"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function TipOccluder.prerequisitesPresent(specializations)\n    return true\nend\n\n"})}),"\n",(0,r.jsx)(n.h3,{id:"registereventlisteners",children:"registerEventListeners"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"registerEventListeners()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"vehicleType"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function TipOccluder.registerEventListeners(vehicleType)\n    SpecializationUtil.registerEventListener(vehicleType, "onLoad" , TipOccluder )\n    SpecializationUtil.registerEventListener(vehicleType, "onLoadFinished" , TipOccluder )\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"registerfunctions",children:"registerFunctions"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"registerFunctions()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"vehicleType"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'function TipOccluder.registerFunctions(vehicleType)\n    SpecializationUtil.registerFunction(vehicleType, "getTipOcclusionAreas" , TipOccluder.getTipOcclusionAreas)\n    SpecializationUtil.registerFunction(vehicleType, "getWheelsWithTipOcclisionAreaGroupId" , TipOccluder.getWheelsWithTipOcclisionAreaGroupId)\n    SpecializationUtil.registerFunction(vehicleType, "getRequiresTipOcclusionArea" , TipOccluder.getRequiresTipOcclusionArea)\nend\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"registeroverwrittenfunctions",children:"registerOverwrittenFunctions"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"registerOverwrittenFunctions()"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,r.jsx)(n.table,{children:(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"any"}),(0,r.jsx)(n.th,{children:"vehicleType"})]})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function TipOccluder.registerOverwrittenFunctions(vehicleType)\nend\n\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);