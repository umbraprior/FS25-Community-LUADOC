"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[91553],{28453(e,n,l){l.d(n,{R:()=>d,x:()=>r});var s=l(96540);const i={},t=s.createContext(i);function d(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(t.Provider,{value:n},e.children)}},74350(e,n,l){l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>a,frontMatter:()=>d,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"script/Wheels/WheelChock","title":"WheelChock","description":"WheelChock","source":"@site/../docs/script/Wheels/WheelChock.md","sourceDirName":"script/Wheels","slug":"/script/Wheels/WheelChock","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelChock","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"WheelAxle","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelAxle"},"next":{"title":"WheelDebug","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelDebug"}}');var i=l(74848),t=l(28453);const d={},r=void 0,o={},h=[{value:"WheelChock",id:"wheelchock",level:2},{value:"delete",id:"delete",level:3},{value:"loadFromXML",id:"loadfromxml",level:3},{value:"new",id:"new",level:3},{value:"onI3DLoaded",id:"oni3dloaded",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"update",id:"update",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"wheelchock",children:"WheelChock"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Handles loading and placement of wheel chocks below wheels"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Functions"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#delete",children:"delete"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#loadfromxml",children:"loadFromXML"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#new",children:"new"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#oni3dloaded",children:"onI3DLoaded"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#update",children:"update"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"delete",children:"delete"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"delete()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelChock:delete()\n    if self.node ~ = nil then\n        delete( self.node)\n        self.node = nil\n    end\n\n    if self.sharedLoadRequestId ~ = nil then\n        g_i3DManager:releaseSharedI3DFile( self.sharedLoadRequestId)\n        self.sharedLoadRequestId = nil\n    end\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"loadfromxml",children:"loadFromXML"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"loadFromXML()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"xmlObject"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"key"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function WheelChock:loadFromXML(xmlObject, key)\n    local vehicle = self.wheel.vehicle\n\n    self.filename = xmlObject:getValue(key .. "#filename" , "$data/shared/assets/wheelChocks/wheelChock01.i3d" )\n    self.filename = Utils.getFilename( self.filename, self.wheel.baseDirectory)\n    if self.filename = = nil then\n        xmlObject:xmlWarning(key .. "#filename" , "Invalid filename given for wheel chock" )\n            return false\n        end\n\n        self.parkingNode = xmlObject:getValue(key .. "#parkingNode" , nil , vehicle.components, vehicle.i3dMappings)\n        self.scale = xmlObject:getValue(key .. "#scale" , "1 1 1" , true )\n        self.isInverted = xmlObject:getValue(key .. "#isInverted" , false )\n        self.isParked = xmlObject:getValue(key .. "#isParked" , false )\n\n        self.offset = xmlObject:getValue(key .. "#offset" , "0 0 0" , true )\n\n        local material = VehicleMaterial.new( self.wheel.baseDirectory)\n        if material:loadFromXML(xmlObject, key, self.wheel.vehicle.customEnvironment) then\n            self.material = material\n        end\n\n        vehicle:onLoadWheelChockFromXML( self , xmlObject, key)\n\n        self.sharedLoadRequestId = vehicle:loadSubSharedI3DFile( self.filename, false , false , self.onI3DLoaded, self )\n\n        return true\n    end\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"new",children:"new"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"new()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"wheel"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"customMt"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelChock.new(wheel, customMt)\n    local self = setmetatable( { } , customMt or WheelChock _mt)\n\n    self.wheel = wheel\n\n    self.isInParkingPosition = false\n    self.wheelRadiusOffset = 0\n\n    return self\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"oni3dloaded",children:"onI3DLoaded"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Called when wheel chock i3d was loaded"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onI3DLoaded(integer i3dNode, table args, )"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"integer"}),(0,i.jsx)(n.th,{children:"i3dNode"}),(0,i.jsx)(n.th,{children:"i3dNode of wheel chock"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"table"}),(0,i.jsx)(n.td,{children:"args"}),(0,i.jsx)(n.td,{children:"arguments"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"args"}),(0,i.jsx)(n.td,{})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function WheelChock:onI3DLoaded(i3dNode, failedReason, args)\n    if i3dNode ~ = 0 then\n        local _\n        self.node = getChildAt(i3dNode, 0 )\n        local posRefNode = I3DUtil.indexToObject( self.node, getUserAttribute( self.node, "posRefNode" ))\n        if posRefNode ~ = nil then\n            _, self.height, self.zOffset = localToLocal(posRefNode, self.node, 0 , 0 , 0 )\n            self.height = self.height * self.scale[ 2 ]\n            self.zOffset = self.zOffset * self.scale[ 3 ]\n\n            setScale( self.node, self.scale[ 1 ], self.scale[ 2 ], self.scale[ 3 ])\n\n            self.parkedNode = I3DUtil.indexToObject( self.node, getUserAttribute( self.node, "parkedNode" ))\n            self.linkedNode = I3DUtil.indexToObject( self.node, getUserAttribute( self.node, "linkedNode" ))\n\n            if self.material ~ = nil then\n                self.material:apply( self.node, "wheelChock_main_mat" )\n            end\n\n            self:update()\n        else\n                Logging.warning( "Missing \'posRefNode\'-userattribute for wheel-chock \'%s\'!" , self.filename)\n                end\n\n                delete(i3dNode)\n            end\n        end\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"schema"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"key"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function WheelChock.registerXMLPaths(schema, key)\n    schema:addDelayedRegistrationPath(key, "WheelChock" )\n\n    schema:register(XMLValueType.STRING, key .. "#filename" , "Path to wheel chock i3d" , "$data/shared/assets/wheelChocks/wheelChock01.i3d" )\n    schema:register(XMLValueType.VECTOR_SCALE, key .. "#scale" , "Scale" , "1 1 1" )\n    schema:register(XMLValueType.NODE_INDEX, key .. "#parkingNode" , "Parking node" )\n    schema:register(XMLValueType.BOOL, key .. "#isInverted" , "Is inverted(In front or back of the wheel)" , false )\n    schema:register(XMLValueType.BOOL, key .. "#isParked" , "Default is parked" , false )\n    schema:register(XMLValueType.VECTOR_TRANS, key .. "#offset" , "Translation offset" , "0 0 0" )\n\n    VehicleMaterial.registerXMLPaths(schema, key)\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"update",children:"update"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"update()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"isInParkingPosition"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelChock:update(isInParkingPosition)\n    if self.node = = nil then\n        return\n    end\n\n    if isInParkingPosition = = nil then\n        isInParkingPosition = self.isInParkingPosition\n    end\n\n    if not self.wheel.vehicle:getIsWheelChockAllowed( self ) then\n        isInParkingPosition = true\n    end\n\n    self.isInParkingPosition = isInParkingPosition\n\n    if isInParkingPosition then\n        if self.parkingNode ~ = nil then\n            setTranslation( self.node, 0 , 0 , 0 )\n            setRotation( self.node, 0 , 0 , 0 )\n            link( self.parkingNode, self.node)\n            setVisibility( self.node, true )\n        else\n                setVisibility( self.node, false )\n            end\n        else\n                setVisibility( self.node, true )\n                setScale( self.node, 1 , 1 , 1 )\n                local wheel = self.wheel\n\n                local radiusChockHeightOffset = math.max(wheel.physics.radius - self.wheelRadiusOffset - self.height, 0.01 )\n                local angle = math.acos(radiusChockHeightOffset / wheel.physics.radius)\n                local zWheelIntersection = wheel.physics.radius * math.sin(angle)\n                local zChockOffset = - zWheelIntersection - self.zOffset\n\n                link(wheel.node, self.node)\n\n                local _, yRot, _ = localRotationToLocal(getParent(wheel.repr), wheel.node, getRotation(wheel.repr))\n                if self.isInverted then\n                    yRot = yRot + math.pi\n                end\n                setRotation( self.node, 0 , yRot, 0 )\n\n                local dirX, dirY, dirZ = localDirectionToLocal( self.node, wheel.node, 0 , 0 , 1 )\n                local normX, normY, normZ = localDirectionToLocal( self.node, wheel.node, 1 , 0 , 0 )\n\n                local posX, posY, posZ = localToLocal(wheel.driveNode, wheel.node, 0 , 0 , 0 )\n                posX = posX + normX * self.offset[ 1 ] + dirX * (zChockOffset + self.offset[ 3 ])\n                posY = posY + normY * self.offset[ 1 ] + dirY * (zChockOffset + self.offset[ 3 ]) - wheel.physics.radius + self.wheelRadiusOffset + self.offset[ 2 ]\n                posZ = posZ + normZ * self.offset[ 1 ] + dirZ * (zChockOffset + self.offset[ 3 ])\n\n                setTranslation( self.node, posX, posY, posZ)\n                setScale( self.node, self.scale[ 1 ], self.scale[ 2 ], self.scale[ 3 ])\n            end\n\n            if self.parkedNode ~ = nil then\n                setVisibility( self.parkedNode, isInParkingPosition)\n            end\n\n            if self.linkedNode ~ = nil then\n                setVisibility( self.linkedNode, not isInParkingPosition)\n            end\n\n            return true\n        end\n\n"})})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);