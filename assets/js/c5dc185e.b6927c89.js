"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[19841],{28453(e,n,i){i.d(n,{R:()=>a,x:()=>r});var l=i(96540);const s={},t=l.createContext(s);function a(e){const n=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),l.createElement(t.Provider,{value:n},e.children)}},42690(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"script/Specializations/PlaceableWeighingStation","title":"PlaceableWeighingStation","description":"PlaceableWeighingStation","source":"@site/../docs/script/Specializations/PlaceableWeighingStation.md","sourceDirName":"script/Specializations","slug":"/script/Specializations/PlaceableWeighingStation","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableWeighingStation","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"PlaceableWeatherStation","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableWeatherStation"},"next":{"title":"PlaceableWindTurbine","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableWindTurbine"}}');var s=i(74848),t=i(28453);const a={},r=void 0,c={},d=[{value:"PlaceableWeighingStation",id:"placeableweighingstation",level:2},{value:"onDelete",id:"ondelete",level:3},{value:"onLoad",id:"onload",level:3},{value:"onWeighingTriggerCallback",id:"onweighingtriggercallback",level:3},{value:"prerequisitesPresent",id:"prerequisitespresent",level:3},{value:"registerEventListeners",id:"registereventlisteners",level:3},{value:"registerFunctions",id:"registerfunctions",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"setWeightDisplay",id:"setweightdisplay",level:3},{value:"updateWeightDisplay",id:"updateweightdisplay",level:3}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"placeableweighingstation",children:"PlaceableWeighingStation"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Specialization for placeables"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Functions"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#ondelete",children:"onDelete"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#onload",children:"onLoad"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#onweighingtriggercallback",children:"onWeighingTriggerCallback"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#prerequisitespresent",children:"prerequisitesPresent"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#registereventlisteners",children:"registerEventListeners"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#registerfunctions",children:"registerFunctions"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#setweightdisplay",children:"setWeightDisplay"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#updateweightdisplay",children:"updateWeightDisplay"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"ondelete",children:"onDelete"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"onDelete()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlaceableWeighingStation:onDelete()\n    local spec = self.spec_weighingStation\n\n    if spec.trigger ~ = nil then\n        removeTrigger(spec.trigger)\n        spec.trigger = nil\n    end\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"onload",children:"onLoad"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Called on loading"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"onLoad(table savegame)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"table"}),(0,s.jsx)(n.th,{children:"savegame"}),(0,s.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function PlaceableWeighingStation:onLoad(savegame)\n    local spec = self.spec_weighingStation\n\n    local key = "placeable.weighingStation"\n\n    spec.trigger = self.xmlFile:getValue(key .. "#triggerNode" , nil , self.components, self.i3dMappings)\n    if spec.trigger = = nil then\n        Logging.xmlError( self.xmlFile, "Missing vehicle triggerNode for weighing station" )\n            return\n        end\n\n        addTrigger(spec.trigger, "onWeighingTriggerCallback" , self )\n        spec.triggerVehicleNodes = { }\n        spec.vehicles = { }\n\n        spec.displays = { }\n        self.xmlFile:iterate(key .. ".display" , function (_, displayKey)\n            local displayNode = self.xmlFile:getValue(displayKey .. "#node" , nil , self.components, self.i3dMappings)\n            if displayNode ~ = nil then\n                local fontName = string.upper( self.xmlFile:getValue(displayKey .. "#font" , "DIGIT" ))\n                local fontMaterial = g_materialManager:getFontMaterial(fontName, self.customEnvironment)\n\n                if fontMaterial ~ = nil then\n                    local display = { }\n\n                    local alignmentStr = self.xmlFile:getValue(displayKey .. "#alignment" , "RIGHT" )\n                    local alignment = RenderText[ "ALIGN_" .. string.upper(alignmentStr)] or RenderText.ALIGN_RIGHT\n\n                    local size = self.xmlFile:getValue(displayKey .. "#size" , 0.03 )\n                    local scaleX = self.xmlFile:getValue(displayKey .. "#scaleX" , 1 )\n                    local scaleY = self.xmlFile:getValue(displayKey .. "#scaleY" , 1 )\n                    local mask = self.xmlFile:getValue(displayKey .. "#mask" , "00.0" )\n                    local emissiveScale = self.xmlFile:getValue(displayKey .. "#emissiveScale" , 0.2 )\n                    local color = self.xmlFile:getValue(displayKey .. "#color" , { 0.9 , 0.9 , 0.9 , 1 } , true )\n                    local hiddenColor = self.xmlFile:getValue(displayKey .. "#hiddenColor" , nil , true )\n\n                    display.displayNode = displayNode\n                    display.formatStr, display.formatPrecision = Utils.maskToFormat(mask)\n\n                    display.characterLine = CharacterLine.new(displayNode, fontMaterial, mask:len())\n                    display.characterLine:setSizeAndScale(size, scaleX, scaleY)\n                    display.characterLine:setTextAlignment(alignment)\n                    display.characterLine:setColor(color, hiddenColor, emissiveScale)\n\n                    table.insert(spec.displays, display)\n                end\n            end\n        end )\n\n        self:setWeightDisplay( 0 )\n    end\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"onweighingtriggercallback",children:"onWeighingTriggerCallback"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Trigger callback"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"onWeighingTriggerCallback(integer triggerId, integer otherId, boolean onEnter, boolean onLeave, boolean onStay)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"integer"}),(0,s.jsx)(n.th,{children:"triggerId"}),(0,s.jsx)(n.th,{children:"id of trigger"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"integer"}),(0,s.jsx)(n.td,{children:"otherId"}),(0,s.jsx)(n.td,{children:"id of actor"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:"onEnter"}),(0,s.jsx)(n.td,{children:"on enter"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:"onLeave"}),(0,s.jsx)(n.td,{children:"on leave"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:"onStay"}),(0,s.jsx)(n.td,{children:"on stay"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlaceableWeighingStation:onWeighingTriggerCallback(triggerId, otherId, onEnter, onLeave, onStay)\n    if onEnter or onLeave then\n        local spec = self.spec_weighingStation\n        if onEnter then\n            spec.triggerVehicleNodes[otherId] = true\n        else\n                -- on leave\n                spec.triggerVehicleNodes[otherId] = nil\n            end\n\n            self:updateWeightDisplay()\n        end\n    end\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"prerequisitespresent",children:"prerequisitesPresent"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Checks if all prerequisite specializations are loaded"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"prerequisitesPresent(table specializations)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"table"}),(0,s.jsx)(n.th,{children:"specializations"}),(0,s.jsx)(n.th,{children:"specializations"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"table"}),(0,s.jsx)(n.th,{children:"hasPrerequisite"}),(0,s.jsx)(n.th,{children:"true if all prerequisite specializations are loaded"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlaceableWeighingStation.prerequisitesPresent(specializations)\n    return true\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"registereventlisteners",children:"registerEventListeners"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"registerEventListeners()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function PlaceableWeighingStation.registerEventListeners(placeableType)\n    SpecializationUtil.registerEventListener(placeableType, "onLoad" , PlaceableWeighingStation )\n    SpecializationUtil.registerEventListener(placeableType, "onDelete" , PlaceableWeighingStation )\nend\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"registerfunctions",children:"registerFunctions"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"registerFunctions()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function PlaceableWeighingStation.registerFunctions(placeableType)\n    SpecializationUtil.registerFunction(placeableType, "onWeighingTriggerCallback" , PlaceableWeighingStation.onWeighingTriggerCallback)\n    SpecializationUtil.registerFunction(placeableType, "updateWeightDisplay" , PlaceableWeighingStation.updateWeightDisplay)\n    SpecializationUtil.registerFunction(placeableType, "setWeightDisplay" , PlaceableWeighingStation.setWeightDisplay)\nend\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"schema"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"any"}),(0,s.jsx)(n.td,{children:"basePath"})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function PlaceableWeighingStation.registerXMLPaths(schema, basePath)\n    schema:setXMLSpecializationType( "WeighingStation" )\n\n    schema:register(XMLValueType.NODE_INDEX, basePath .. ".weighingStation#triggerNode" , "Vehicle trigger" )\n\n    schema:register(XMLValueType.NODE_INDEX, basePath .. ".weighingStation.display(?)#node" , "Display start node" )\n    schema:register(XMLValueType.STRING, basePath .. ".weighingStation.display(?)#font" , "Display font name" )\n    schema:register(XMLValueType.STRING, basePath .. ".weighingStation.display(?)#alignment" , "Display text alignment" )\n    schema:register(XMLValueType.FLOAT, basePath .. ".weighingStation.display(?)#size" , "Display text size" )\n    schema:register(XMLValueType.FLOAT, basePath .. ".weighingStation.display(?)#scaleX" , "Display text x scale" )\n    schema:register(XMLValueType.FLOAT, basePath .. ".weighingStation.display(?)#scaleY" , "Display text y scale" )\n    schema:register(XMLValueType.STRING, basePath .. ".weighingStation.display(?)#mask" , "Display text mask" )\n    schema:register(XMLValueType.FLOAT, basePath .. ".weighingStation.display(?)#emissiveScale" , "Display emissive scale" )\n    schema:register(XMLValueType.COLOR, basePath .. ".weighingStation.display(?)#color" , "Display text color" )\n    schema:register(XMLValueType.COLOR, basePath .. ".weighingStation.display(?)#hiddenColor" , "Display text hidden color" )\n\n    schema:setXMLSpecializationType()\nend\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"setweightdisplay",children:"setWeightDisplay"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"setWeightDisplay()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"mass"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlaceableWeighingStation:setWeightDisplay(mass)\n    local spec = self.spec_weighingStation\n    for _, display in ipairs(spec.displays) do\n        local int, floatPart = math.modf(mass)\n\n        local value = string.format(display.formatStr, int, math.abs( math.floor(floatPart * ( 10 ^ display.formatPrecision))))\n        display.characterLine:setText(value)\n    end\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"updateweightdisplay",children:"updateWeightDisplay"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"updateWeightDisplay()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function PlaceableWeighingStation:updateWeightDisplay()\n    local spec = self.spec_weighingStation\n\n    -- resolve nodes to vehicles, add to table to eliminate duplicates\n    for node, _ in pairs(spec.triggerVehicleNodes) do\n        if entityExists(node) then\n            local vehicle = g_currentMission:getNodeObject(node)\n            if vehicle ~ = nil and vehicle.getTotalMass ~ = nil then\n                spec.vehicles[vehicle] = true\n            end\n        else\n                -- vehicle does not exist anymore\n                spec.triggerVehicleNodes[node] = nil\n            end\n        end\n\n        local mass = 0\n        for vehicle in pairs(spec.vehicles) do\n            mass = mass + vehicle:getTotalMass( true )\n        end\n        table.clear(spec.vehicles)\n\n        self:setWeightDisplay(mass * 1000 )\n    end\n\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);