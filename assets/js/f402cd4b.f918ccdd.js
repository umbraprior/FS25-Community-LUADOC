"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[91232],{28453(n,e,i){i.d(e,{R:()=>s,x:()=>d});var t=i(96540);const r={},l=t.createContext(r);function s(n){const e=t.useContext(l);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),t.createElement(l.Provider,{value:e},n.children)}},59050(n,e,i){i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"script/GUI/OverlayManager","title":"OverlayManager","description":"OverlayManager","source":"@site/../docs/script/GUI/OverlayManager.md","sourceDirName":"script/GUI","slug":"/script/GUI/OverlayManager","permalink":"/FS25-Community-LUADOC/script/GUI/OverlayManager","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Overlay","permalink":"/FS25-Community-LUADOC/script/GUI/Overlay"},"next":{"title":"PagingElement","permalink":"/FS25-Community-LUADOC/script/GUI/PagingElement"}}');var r=i(74848),l=i(28453);const s={},d=void 0,c={},o=[{value:"OverlayManager",id:"overlaymanager",level:2},{value:"addTextureConfigFile",id:"addtextureconfigfile",level:3},{value:"createOverlay",id:"createoverlay",level:3},{value:"getConfigMetaData",id:"getconfigmetadata",level:3},{value:"getSliceInfoById",id:"getsliceinfobyid",level:3}];function a(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h2,{id:"overlaymanager",children:"OverlayManager"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Description"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"reads UVs of overlays from an XML file, stores them, and creates new overlays for other scripts to use"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Functions"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#addtextureconfigfile",children:"addTextureConfigFile"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#createoverlay",children:"createOverlay"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#getconfigmetadata",children:"getConfigMetaData"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#getsliceinfobyid",children:"getSliceInfoById"})}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"addtextureconfigfile",children:"addTextureConfigFile"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Description"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"Adds a texture config file to the overlay manager. reads meta information like slices filename and resolution, and\nthen reads information for all given slices, and saves them"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"addTextureConfigFile(string filename, string prefix, string? customEnv)"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"string"}),(0,r.jsx)(e.th,{children:"filename"}),(0,r.jsx)(e.th,{children:"name of the texture config file, that contains all other data"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"string"}),(0,r.jsx)(e.td,{children:"prefix"}),(0,r.jsx)(e.td,{children:"for this texture config file, is used in front of slice id when creating overlays"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"string?"}),(0,r.jsx)(e.td,{children:"customEnv"}),(0,r.jsx)(e.td,{children:"custom environment for mod namespace"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Code"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-lua",children:'function OverlayManager:addTextureConfigFile(filename, prefix, customEnv)\n    if customEnv ~ = nil then\n        prefix = customEnv .. "." .. prefix\n    end\n\n    if filename = = nil then\n        Logging.warning( "Filename for texture config file is empty" )\n            return\n        end\n\n        --if we already have a config file with this prefix loaded, we stop\n            if self.textureConfigs[prefix] ~ = nil and not g_gui.currentlyReloading then\n                Logging.warning( "Texture config file with prefix \'%s\' already exists" , prefix)\n                return\n            end\n\n            local xmlFile = XMLFile.load( "TextureConfig" , filename)\n            local directory = Utils.getDirectory(filename)\n\n            --failed to load xml with given filename\n            if xmlFile = = nil then\n                Logging.warning( "Failed to load XML file from path \'%s\'" , filename)\n                return\n            end\n\n            local textureConfig = { }\n            textureConfig.xmlFilename = filename\n\n            local imageFilename = xmlFile:getString( "texture.meta.filename" )\n            if imageFilename = = nil then\n                Logging.xmlWarning(xmlFile, "Missing filename in meta data" )\n                return\n            end\n            textureConfig.imageFilename = directory .. imageFilename\n\n            local imageWidth = xmlFile:getInt( "texture.meta.size#width" )\n            if imageWidth = = nil then\n                Logging.xmlWarning(xmlFile, "Missing imageWidth in meta data" )\n                return\n            end\n\n            local imageHeight = xmlFile:getInt( "texture.meta.size#height" )\n            if imageHeight = = nil then\n                Logging.xmlWarning(xmlFile, "Missing imageHeight in meta data" )\n                return\n            end\n\n            textureConfig.imageSize = { imageWidth, imageHeight }\n\n            textureConfig.slices = { }\n\n            xmlFile:iterate( "texture.slices.slice" , function (num, key)\n                local slice = { }\n                local id = xmlFile:getString(key .. "#id" )\n                if id = = nil then\n                    Logging.xmlWarning(xmlFile, "Missing ID for slice nr. %i" , num)\n                        return\n                    end\n                    slice.sliceId = prefix .. "." .. id\n\n                    local uvsStr = xmlFile:getString(key .. "#uvs" )\n                    if uvsStr = = nil then\n                        Logging.xmlWarning(xmlFile, "Missing UVs for slice with ID %s" , slice.sliceId)\n                            return\n                        end\n\n                        local _, _, width, height = unpack( GuiUtils.getNormalizedScreenValues(uvsStr))\n\n                        if width = = nil then\n                            slice.width = 0\n                            Logging.xmlWarning(xmlFile, "Missing width for slice with ID %s" , slice.sliceId)\n                            else\n                                    slice.width = GuiUtils.getNormalizedXValue(width)\n                                end\n\n                                if height = = nil then\n                                    slice.height = 0\n                                    Logging.xmlWarning(xmlFile, "Missing height for slice with ID %s" , slice.sliceId)\n                                    else\n                                            slice.height = GuiUtils.getNormalizedYValue(height)\n                                        end\n\n                                        local _, _, widthStr, heightStr = unpack( string.split(uvsStr, " " ))\n\n                                        slice.uvsStr = uvsStr\n                                        slice.size = { width, height }\n                                        slice.sizeStr = widthStr .. " " .. heightStr\n                                        slice.imageSize = textureConfig.imageSize\n                                        slice.filename = textureConfig.imageFilename\n                                        slice.uvs = GuiUtils.getUVs(uvsStr, textureConfig.imageSize, { 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 } )\n\n                                        if textureConfig.slices[id] ~ = nil then\n                                            Logging.xmlWarning(xmlFile, "Duplicate slice ID %s" , slice.sliceId)\n                                        end\n\n                                        textureConfig.slices[id] = slice\n                                    end )\n\n                                    self.textureConfigs[prefix] = textureConfig\n\n                                    xmlFile:delete()\n                                end\n\n'})}),"\n",(0,r.jsx)(e.h3,{id:"createoverlay",children:"createOverlay"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Description"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"Returns an overlay with previously loaded data for the given identifier"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"createOverlay(string identifier, float? posX, float? posY, float? width, float? height, string? customEnv)"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"string"}),(0,r.jsx)(e.th,{children:"identifier"}),(0,r.jsx)(e.th,{children:'format: "prefix.sliceId" first dot (.) is used as separator, creates overlay with data for slice with name sliceId in texture config file with name prefix'})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"float?"}),(0,r.jsx)(e.td,{children:"posX"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"float?"}),(0,r.jsx)(e.td,{children:"posY"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"float?"}),(0,r.jsx)(e.td,{children:"width"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"float?"}),(0,r.jsx)(e.td,{children:"height"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"string?"}),(0,r.jsx)(e.td,{children:"customEnv"}),(0,r.jsx)(e.td,{children:"needed for mod support"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,r.jsx)(e.table,{children:(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"string?"}),(0,r.jsx)(e.th,{children:"overlay"}),(0,r.jsx)(e.th,{children:"Overlay instance or nil on error"})]})})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Code"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-lua",children:'function OverlayManager:createOverlay(identifier, posX, posY, width, height, customEnv)\n    local identifierSplit = string.split(identifier, "." )\n    local prefix = identifierSplit[ 1 ]\n    local sliceId = identifierSplit[ 2 ]\n\n    if prefix = = nil or sliceId = = nil then\n        Logging.warning( "Identifier \'%s\' does not contain prefix or slice ID" , identifier)\n        return nil\n    end\n\n    if customEnv ~ = nil then\n        prefix = customEnv .. "." .. prefix\n    end\n\n    local textureConfig = self.textureConfigs[prefix]\n\n    if textureConfig = = nil then\n        Logging.warning( "No texture config with prefix \'%s\' found" , prefix)\n        return nil\n    end\n\n    local slice = textureConfig.slices[sliceId]\n\n    if slice = = nil then\n        Logging.xmlWarning(textureConfig.xmlFilename, "No slice with ID \'%s\' found in texture config \'%s\'" , sliceId, prefix)\n        return nil\n    end\n\n    posX = posX or 0\n    posY = posY or 0\n\n    width = width or slice.width\n    height = height or slice.height\n\n    local overlay = Overlay.new(textureConfig.imageFilename, posX, posY, width, height)\n    overlay:setUVs(slice.uvs)\n\n    return overlay\nend\n\n'})}),"\n",(0,r.jsx)(e.h3,{id:"getconfigmetadata",children:"getConfigMetaData"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Description"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"Returns the texture config meta data for a given config file"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"getConfigMetaData(string configPrefix, string? customEnv)"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"string"}),(0,r.jsx)(e.th,{children:"configPrefix"}),(0,r.jsx)(e.th,{children:"prefix that was used to add the texture config file to the overlay manager"})]})}),(0,r.jsx)(e.tbody,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"string?"}),(0,r.jsx)(e.td,{children:"customEnv"}),(0,r.jsx)(e.td,{children:"needed for mod support"})]})})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,r.jsx)(e.table,{children:(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"string?"}),(0,r.jsx)(e.th,{children:"metadata"}),(0,r.jsx)(e.th,{children:"{filename=string, imageSize={width, height}}"})]})})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Code"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-lua",children:'function OverlayManager:getConfigMetaData(configPrefix, customEnv)\n    if configPrefix = = nil then\n        Logging.warning( "Texture config prefix is empty" )\n        return nil\n    end\n\n    if customEnv ~ = nil then\n        configPrefix = customEnv .. "." .. configPrefix\n    end\n\n    local textureConfig = self.textureConfigs[configPrefix]\n\n    if textureConfig = = nil then\n        Logging.warning( "No texture config with prefix \'%s\' found" , configPrefix)\n        return nil\n    end\n\n    local metadata = { filename = textureConfig.imageFilename, imageSize = textureConfig.imageSize }\n\n    return metadata\nend\n\n'})}),"\n",(0,r.jsx)(e.h3,{id:"getsliceinfobyid",children:"getSliceInfoById"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Description"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"Returns the texture config data for the given identifier"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Definition"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"getSliceInfoById(string identifier, string? customEnv)"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"string"}),(0,r.jsx)(e.th,{children:"identifier"}),(0,r.jsx)(e.th,{children:'format: "prefix.sliceId" first dot (.) is used as separator, creates overlay with data for slice with name sliceId in texture config file with name prefix'})]})}),(0,r.jsx)(e.tbody,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"string?"}),(0,r.jsx)(e.td,{children:"customEnv"}),(0,r.jsx)(e.td,{children:"needed for mod support"})]})})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,r.jsx)(e.table,{children:(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"string?"}),(0,r.jsx)(e.th,{children:"slice"}),(0,r.jsx)(e.th,{children:"slice table or nil on error"})]})})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Code"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-lua",children:'function OverlayManager:getSliceInfoById(identifier, customEnv)\n    if identifier = = nil then\n        return nil\n    end\n\n    local identifierSplit = string.split(identifier, "." )\n    local prefix = identifierSplit[ 1 ]\n    local sliceId = identifierSplit[ 2 ]\n\n    if prefix = = nil or sliceId = = nil then\n        Logging.warning( "Identifier \'%s\' does not contain prefix or slice ID" , identifier)\n        return nil\n    end\n\n    if customEnv ~ = nil then\n        prefix = customEnv .. "." .. prefix\n    end\n\n    local textureConfig = self.textureConfigs[prefix]\n\n    if textureConfig = = nil then\n        Logging.warning( "No texture config with prefix \'%s\' found" , prefix)\n        return nil\n    end\n\n    local slice = textureConfig.slices[sliceId]\n\n    if slice = = nil then\n        Logging.warning( "No slice with ID \'%s\' found in texture config \'%s\'" , sliceId, prefix)\n        return nil\n    end\n\n    return slice\nend\n\n'})})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}}}]);