"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[83116],{28453(e,n,t){t.d(n,{R:()=>r,x:()=>h});var l=t(96540);const i={},s=l.createContext(i);function r(e){const n=l.useContext(s);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function h(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),l.createElement(s.Provider,{value:n},e.children)}},92593(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>h,default:()=>a,frontMatter:()=>r,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"script/Wheels/WheelDestruction","title":"WheelDestruction","description":"WheelDestruction","source":"@site/../docs/script/Wheels/WheelDestruction.md","sourceDirName":"script/Wheels","slug":"/script/Wheels/WheelDestruction","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelDestruction","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"WheelDebug","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelDebug"},"next":{"title":"WheelEffects","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelEffects"}}');var i=t(74848),s=t(28453);const r={},h=void 0,d={},o=[{value:"WheelDestruction",id:"wheeldestruction",level:2},{value:"destroyFruitArea",id:"destroyfruitarea",level:3},{value:"destroySnowArea",id:"destroysnowarea",level:3},{value:"drawAreas",id:"drawareas",level:3},{value:"finalize",id:"finalize",level:3},{value:"loadFromXML",id:"loadfromxml",level:3},{value:"new",id:"new",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"setIsCareWheel",id:"setiscarewheel",level:3},{value:"smoothHeightAtPosition",id:"smoothheightatposition",level:3},{value:"update",id:"update",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"wheeldestruction",children:"WheelDestruction"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Handles crop destruction and density height deformation of the wheels"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Functions"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#destroyfruitarea",children:"destroyFruitArea"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#destroysnowarea",children:"destroySnowArea"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#drawareas",children:"drawAreas"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#finalize",children:"finalize"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#loadfromxml",children:"loadFromXML"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#new",children:"new"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#setiscarewheel",children:"setIsCareWheel"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#smoothheightatposition",children:"smoothHeightAtPosition"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#update",children:"update"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"destroyfruitarea",children:"destroyFruitArea"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"destroyFruitArea()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"x0"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"z0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"x1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"z1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"x2"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"z2"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelDestruction:destroyFruitArea(x0,z0, x1,z1, x2,z2)\n    FSDensityMapUtil.updateWheelDestructionArea(x0,z0, x1,z1, x2,z2)\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"destroysnowarea",children:"destroySnowArea"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"destroySnowArea()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"x0"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"z0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"x1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"z1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"x2"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"z2"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelDestruction:destroySnowArea(x0,z0, x1,z1, x2,z2)\n    local snowSystem = g_currentMission.snowSystem\n\n    local worldSnowHeight = snowSystem.height\n    local curHeight = snowSystem:getSnowHeightAtArea(x0,z0, x1,z1, x2,z2)\n\n    -- Reduce only when it is fresh snow\n    local reduceSnow = MathUtil.equalEpsilon(worldSnowHeight, curHeight, 0.005 )\n    -- Detect unmelted heaps\n    local isOnSnowHeap = worldSnowHeight < 0.005 and curHeight > 1\n\n    -- Melt only if height is substantial\n        if curHeight > SnowSystem.MIN_LAYER_HEIGHT and(reduceSnow or isOnSnowHeap) then\n            local sink = 0.7 * worldSnowHeight\n            if isOnSnowHeap then\n                sink = 0.1 * curHeight\n            end\n\n            local sinkLayers = math.floor( math.min(sink, curHeight) / SnowSystem.MIN_LAYER_HEIGHT)\n            if sinkLayers > 0 then\n                snowSystem:removeSnow(x0,z0, x1,z1, x2,z2, sinkLayers)\n            end\n        end\n    end\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"drawareas",children:"drawAreas"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"drawAreas()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelDestruction:drawAreas()\n    if not self.isCareWheel then\n        for _, visualWheel in ipairs( self.wheel.visualWheels) do\n            local repr = self.wheel.repr\n            local width = 0.5 * visualWheel.width\n            local length = math.min( 0.5 , 0.5 * visualWheel.width)\n            local xShift, yShift, zShift = localToLocal(visualWheel.node, repr, 0 , 0 , 0 )\n\n            local x0, y0, z0 = localToWorld(repr, xShift + width, yShift, zShift - length)\n            local x1, _, z1 = localToWorld(repr, xShift - width, yShift, zShift - length)\n            local x2, _, z2 = localToWorld(repr, xShift + width, yShift, zShift + length)\n\n            local x, z, widthX, widthZ, heightX, heightZ = MathUtil.getXZWidthAndHeight(x0, z0, x1, z1, x2, z2)\n            DebugUtil.drawDebugParallelogram(x, z, widthX, widthZ, heightX, heightZ, y0, 1 , 1 , 0 , 0.05 , true )\n        end\n\n        if # self.wheel.visualWheels = = 0 then\n            local repr = self.wheel.repr\n            local width = 0.5 * self.wheel.physics.width\n            local length = math.min( 0.5 , 0.5 * self.wheel.physics.width)\n            local xShift, yShift, zShift = localToLocal( self.wheel.driveNode, repr, 0 , 0 , 0 )\n\n            local x0, y0, z0 = localToWorld(repr, xShift + width, yShift, zShift - length)\n            local x1, _, z1 = localToWorld(repr, xShift - width, yShift, zShift - length)\n            local x2, _, z2 = localToWorld(repr, xShift + width, yShift, zShift + length)\n\n            local x, z, widthX, widthZ, heightX, heightZ = MathUtil.getXZWidthAndHeight(x0, z0, x1, z1, x2, z2)\n            DebugUtil.drawDebugParallelogram(x, z, widthX, widthZ, heightX, heightZ, y0, 1 , 1 , 0 , 0.05 , true )\n        end\n    end\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"finalize",children:"finalize"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"finalize()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelDestruction:finalize()\n    for _, visualWheel in ipairs( self.wheel.visualWheels) do\n        local destructionNode = { }\n        destructionNode.node = visualWheel.node\n        destructionNode.width = visualWheel.width\n        destructionNode.radius = visualWheel.radius\n        table.insert( self.destructionNodes, destructionNode)\n    end\n\n    -- if we don't have any visual wheel, we destruct at the physical wheel(crawlers etc.)\n        if # self.wheel.visualWheels = = 0 then\n            local destructionNode = { }\n            destructionNode.node = self.wheel.driveNode\n            destructionNode.width = self.wheel.physics.width\n            destructionNode.radius = self.wheel.physics.radius\n            table.insert( self.destructionNodes, destructionNode)\n        end\n    end\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"loadfromxml",children:"loadFromXML"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"loadFromXML()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"xmlObject"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function WheelDestruction:loadFromXML(xmlObject)\n    xmlObject:checkDeprecatedXMLElements( ".tire#isCareWheel" , "#isCareWheel" )\n\n    self.isCareWheel = xmlObject:getValue( "#isCareWheel" , false )\n    self.smoothGroundRadius = xmlObject:getValue( ".physics#smoothGroundRadius" , math.max( 0.6 , self.wheel.physics.width * 0.75 ))\n\n    return true\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"new",children:"new"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"new()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"wheel"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelDestruction.new(wheel)\n    local self = setmetatable( { } , { __index = WheelDestruction } )\n\n    self.wheel = wheel\n    self.vehicle = wheel.vehicle\n\n    self.destructionNodes = { }\n    self.wheelSmoothAccumulation = 0\n\n    return self\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"schema"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"key"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function WheelDestruction.registerXMLPaths(schema, key)\n    schema:register(XMLValueType.BOOL, key .. "#isCareWheel" , "Is care wheel" , false )\n    schema:register(XMLValueType.FLOAT, key .. ".physics#smoothGroundRadius" , "Smooth ground radius" , "width * 0.75" )\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"setiscarewheel",children:"setIsCareWheel"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"setIsCareWheel()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"isCareWheel"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelDestruction:setIsCareWheel(isCareWheel)\n    self.isCareWheel = isCareWheel\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"smoothheightatposition",children:"smoothHeightAtPosition"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"smoothHeightAtPosition()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"x"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"y"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"z"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"radius"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"amount"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelDestruction:smoothHeightAtPosition(x, y, z, radius, amount)\n    local smoothYOffset = - 0.1\n    local heightType = DensityMapHeightUtil.getHeightTypeDescAtWorldPos(x, y, z, radius)\n    if heightType ~ = nil and heightType.allowsSmoothing then\n        local terrainHeightUpdater = g_densityMapHeightManager:getTerrainDetailHeightUpdater()\n        if terrainHeightUpdater ~ = nil then\n            local terrainHeight = getTerrainHeightAtWorldPos(g_terrainNode, x, y, z)\n            local physicsDeltaHeight = y - terrainHeight\n            local deltaHeight = (physicsDeltaHeight + heightType.collisionBaseOffset) / heightType.collisionScale\n            deltaHeight = math.min( math.max(deltaHeight, physicsDeltaHeight + heightType.minCollisionOffset), physicsDeltaHeight + heightType.maxCollisionOffset)\n            deltaHeight = math.max(deltaHeight + smoothYOffset, 0 )\n            local internalHeight = terrainHeight + deltaHeight\n            smoothDensityMapHeightAtWorldPos(terrainHeightUpdater, x, internalHeight, z, amount, heightType.index, 0.0 , radius, radius + 1.2 , 0 )\n            if VehicleDebug.state = = VehicleDebug.DEBUG_ATTRIBUTES then\n                DebugUtil.drawDebugCircle(x, internalHeight, z, radius, 10 )\n            end\n        end\n    end\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"update",children:"update"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"update()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"dt"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"allowFoliageDestruction"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function WheelDestruction:update(dt, allowFoliageDestruction)\n    if g_server ~ = nil or self.vehicle.currentUpdateDistance < WheelDestruction.MAX_UPDATE_DISTANCE then\n        if allowFoliageDestruction and self.vehicle.lastSpeedReal > 0.0002 then\n            local hasContact = self.wheel.physics.contact ~ = WheelContactType.NONE\n            local doFruitDestruction = hasContact and not self.isCareWheel\n            local doSnowDestruction = hasContact and self.wheel.physics.hasSnowContact\n            if doFruitDestruction or doSnowDestruction then\n                for _, destructionNode in ipairs( self.destructionNodes) do\n                    local repr = self.wheel.repr\n                    local width = 0.5 * destructionNode.width\n                    local length = math.min( 0.5 , 0.5 * destructionNode.width)\n                    local xShift, yShift, zShift = localToLocal(destructionNode.node, repr, 0 , 0 , 0 )\n\n                    if doFruitDestruction then\n                        local x0, _, z0 = localToWorld(repr, xShift + width, yShift, zShift - length)\n                        local x1, _, z1 = localToWorld(repr, xShift - width, yShift, zShift - length)\n                        local x2, _, z2 = localToWorld(repr, xShift + width, yShift, zShift + length)\n                        if g_farmlandManager:getIsOwnedByFarmAtWorldPosition( self.vehicle:getActiveFarm(), x0, z0) then\n                            self:destroyFruitArea(x0, z0, x1, z1, x2, z2)\n                        end\n                    end\n\n                    if doSnowDestruction then\n                        local snowOffset = destructionNode.radius * 0.75 * self.vehicle.movingDirection\n                        local x3, _, z3 = localToWorld(repr, xShift + width, yShift, zShift - length + snowOffset)\n                        local x4, _, z4 = localToWorld(repr, xShift - width, yShift, zShift - length + snowOffset)\n                        local x5, _, z5 = localToWorld(repr, xShift + width, yShift, zShift + length + snowOffset)\n\n                        self:destroySnowArea(x3, z3, x4, z4, x5, z5)\n                    end\n                end\n            end\n        end\n\n        if Platform.gameplay.wheelDensityHeightSmooth then\n            -- smoothing of tipAny\n            local wheelSmoothAmount = 0\n            if self.vehicle.lastSpeedReal > 0.0002 then -- start smoothing if driving faster than 0.7km/h\n                wheelSmoothAmount = self.wheelSmoothAccumulation + math.max( self.vehicle.lastMovedDistance * 1.2 , 0.0003 * dt) -- smooth 1.2m per meter driving or at least 0.3m/s\n                local rounded = DensityMapHeightUtil.getRoundedHeightValue(wheelSmoothAmount)\n                self.wheelSmoothAccumulation = wheelSmoothAmount - rounded\n            else\n                    self.wheelSmoothAccumulation = 0\n                end\n\n                if wheelSmoothAmount > 0 then\n                    for _, destructionNode in ipairs( self.destructionNodes) do\n                        local xOffset, _, _ = localToLocal(destructionNode.node, self.wheel.repr, 0 , 0 , 0 )\n\n                        local x, y, z = localToLocal( self.wheel.node, self.wheel.repr, self.wheel.physics.netInfo.x, self.wheel.physics.netInfo.y, self.wheel.physics.netInfo.z)\n                        x, y, z = localToWorld( self.wheel.repr, x + xOffset, y - self.wheel.physics.radius, z)\n\n                        self:smoothHeightAtPosition(x, y, z, self.smoothGroundRadius, wheelSmoothAmount)\n                    end\n                end\n            end\n        end\n    end\n\n"})})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);