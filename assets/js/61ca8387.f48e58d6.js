"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[65036],{28453(n,e,i){i.d(e,{R:()=>l,x:()=>a});var t=i(96540);const s={},r=t.createContext(s);function l(n){const e=t.useContext(r);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),t.createElement(r.Provider,{value:e},n.children)}},59740(n,e,i){i.r(e),i.d(e,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"script/Objects/AnimatedObject","title":"AnimatedObject","description":"AnimatedObject","source":"@site/../docs/script/Objects/AnimatedObject.md","sourceDirName":"script/Objects","slug":"/script/Objects/AnimatedObject","permalink":"/FS25-Community-LUADOC/script/Objects/AnimatedObject","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"AnimatedMapObject","permalink":"/FS25-Community-LUADOC/script/Objects/AnimatedMapObject"},"next":{"title":"Basketball","permalink":"/FS25-Community-LUADOC/script/Objects/Basketball"}}');var s=i(74848),r=i(28453);const l={},a=void 0,d={},o=[{value:"AnimatedObject",id:"animatedobject",level:2},{value:"delete",id:"delete",level:3},{value:"hourChanged",id:"hourchanged",level:3},{value:"load",id:"load",level:3},{value:"loadFrameValues",id:"loadframevalues",level:3},{value:"loadFromXMLFile",id:"loadfromxmlfile",level:3},{value:"new",id:"new",level:3},{value:"readStream",id:"readstream",level:3},{value:"readUpdateStream",id:"readupdatestream",level:3},{value:"registerSavegameXMLPaths",id:"registersavegamexmlpaths",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"setAnimTime",id:"setanimtime",level:3},{value:"setFrameValues",id:"setframevalues",level:3},{value:"triggerCallback",id:"triggercallback",level:3},{value:"update",id:"update",level:3},{value:"writeStream",id:"writestream",level:3},{value:"writeUpdateStream",id:"writeupdatestream",level:3}];function c(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h2,{id:"animatedobject",children:"AnimatedObject"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Class for animated objects"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Parent"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"?version=script&category=&class=",children:"Object"})}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Functions"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#delete",children:"delete"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#hourchanged",children:"hourChanged"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#load",children:"load"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#loadframevalues",children:"loadFrameValues"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#loadfromxmlfile",children:"loadFromXMLFile"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#new",children:"new"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#readstream",children:"readStream"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#readupdatestream",children:"readUpdateStream"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#registersavegamexmlpaths",children:"registerSavegameXMLPaths"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#setanimtime",children:"setAnimTime"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#setframevalues",children:"setFrameValues"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#triggercallback",children:"triggerCallback"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#update",children:"update"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#writestream",children:"writeStream"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#writeupdatestream",children:"writeUpdateStream"})}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"delete",children:"delete"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Delete animated object"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"delete()"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:delete()\n\n    if self.triggerNode ~ = nil then\n        removeTrigger( self.triggerNode)\n        for i = 0 , getNumOfChildren( self.triggerNode) - 1 do\n            removeTrigger(getChildAt( self.triggerNode, i))\n        end\n        self.triggerNode = nil\n    end\n\n    if self.samplesMoving ~ = nil then\n        g_soundManager:deleteSamples( self.samplesMoving)\n        self.samplesMoving = nil\n    end\n    if self.samplePosEnd ~ = nil then\n        g_soundManager:deleteSample( self.samplePosEnd)\n        self.samplePosEnd = nil\n    end\n    if self.sampleNegEnd ~ = nil then\n        g_soundManager:deleteSample( self.sampleNegEnd)\n        self.sampleNegEnd = nil\n    end\n\n    if self.animation ~ = nil and self.animation.sharedLoadRequestId ~ = nil then\n        g_i3DManager:releaseSharedI3DFile( self.animation.sharedLoadRequestId)\n        self.animation.sharedLoadRequestId = nil\n    end\n\n    if g_currentMission ~ = nil then\n        g_currentMission.activatableObjectsSystem:removeActivatable( self.activatable)\n    end\n\n    if g_messageCenter ~ = nil then\n        g_messageCenter:unsubscribeAll( self )\n    end\n\n    self.isDeleted = true\n\n    AnimatedObject:superClass().delete( self )\nend\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"hourchanged",children:"hourChanged"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Called on hour change"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"hourChanged()"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:hourChanged()\n    if not self.isServer then\n        return\n    end\n\n    if g_currentMission = = nil or g_currentMission.environment = = nil then\n        return\n    end\n\n    if self.openingHours ~ = nil then\n        local currentHour = g_currentMission.environment.currentHour\n\n        if currentHour > = self.openingHours.startTime and currentHour < self.openingHours.endTime then\n            if not self.openingHours.isOpen then\n                if self.isServer then\n                    self.animation.direction = 1\n                    self:raiseActive()\n                end\n                self.openingHours.isOpen = true\n            end\n            if self.openingHours.disableIfClosed then\n                self.isEnabled = true\n            end\n        else\n                if self.openingHours.isOpen then\n                    if self.isServer then\n                        self.animation.direction = - 1\n                        self:raiseActive()\n                    end\n                    self.openingHours.isOpen = false\n                end\n                if self.openingHours.disableIfClosed then\n                    self.isEnabled = false\n                end\n            end\n        end\n    end\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"load",children:"load"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Load animated object from object with given configuration file"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"load(entityId|table rootNode, XMLFile xmlFile, string key, string xmlFilename, table? i3dMappings)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"entityId"}),(0,s.jsx)(e.th,{children:"table"}),(0,s.jsx)(e.th,{children:"rootNode"}),(0,s.jsx)(e.th,{children:"id of object"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"XMLFile"}),(0,s.jsx)(e.td,{children:"xmlFile"}),(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"string"}),(0,s.jsx)(e.td,{children:"key"}),(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"string"}),(0,s.jsx)(e.td,{children:"xmlFilename"}),(0,s.jsx)(e.td,{children:"Path of the xml configuration"}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"table?"}),(0,s.jsx)(e.td,{children:"i3dMappings"}),(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(e.table,{children:(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"table?"}),(0,s.jsx)(e.th,{children:"success"}),(0,s.jsx)(e.th,{children:"success"})]})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:'function AnimatedObject:load(rootNode, xmlFile, key, xmlFilename, i3dMappings)\n    self.xmlFilename = xmlFilename\n\n    local modName, baseDirectory = Utils.getModNameAndBaseDirectory(xmlFilename)\n    self.baseDirectory = baseDirectory\n    self.customEnvironment = modName\n\n    self.nodeId = rootNode\n    if type(rootNode) = = "table" then\n        self.nodeId = rootNode[ 1 ].node\n    end\n\n    local success = true\n    self.saveId = xmlFile:getString(key .. "#saveId" ) or "AnimatedObject_" .. getName( self.nodeId)\n\n    local animKey = key .. ".animation"\n\n    self.animation = { }\n    self.animation.parts = { }\n    self.animation.shaderAnims = nil\n    self.animation.clipRootNode = nil\n    self.animation.clipName = nil\n    self.animation.clipTrack = nil\n    self.animation.duration = xmlFile:getFloat(animKey .. "#duration" )\n    self.animation.time = 0\n    self.animation.direction = 0\n    self.animation.maxTime = 0\n\n    for _, partKey in xmlFile:iterator(animKey .. ".part" ) do\n        local node = xmlFile:getNode(partKey .. "#node" , nil , rootNode, i3dMappings)\n        if node ~ = nil then\n            local checkStaticCol = function (nodeToCheck)\n                if getRigidBodyType(nodeToCheck) = = RigidBodyType.STATIC and getHasClassId(nodeToCheck, ClassIds.SHAPE) then -- check for classId as transformGroups can be static as well\n                    Logging.xmlWarning(xmlFile, "Animated node %q at %q is a static rigid body, ignoring" , I3DUtil.getNodePath(nodeToCheck, self.nodeId), partKey)\n                    return false\n                end\n                return\n            end\n            if I3DUtil.iterateRecursively(node, checkStaticCol, true ) = = false then\n                continue -- do not add as animated part if check failed\n                end\n\n                local part = { }\n                part.node = node\n                part.frames = { }\n\n                for _, frameKey in xmlFile:iterator(partKey .. ".keyFrame" ) do\n                    local keyframe = { self:loadFrameValues(xmlFile, frameKey, node) }\n                    keyframe.time = xmlFile:getFloat(frameKey .. "#time" )\n                    self.animation.maxTime = math.max(keyframe.time , self.animation.maxTime)\n\n                    table.insert(part.frames, keyframe)\n                end\n\n                if #part.frames > 0 then\n                    table.insert( self.animation.parts, part)\n                end\n            end\n        end\n\n        for _, shaderKey in xmlFile:iterator(animKey .. ".shader" ) do\n            local node = xmlFile:getNode(shaderKey .. "#node" , nil , rootNode, i3dMappings)\n            if node ~ = nil then\n                local parameterName = xmlFile:getString(shaderKey .. "#parameterName" )\n                if parameterName ~ = nil and getHasShaderParameter(node, parameterName) then\n                    local shader = { }\n\n                    shader.node = node\n                    shader.parameterName = parameterName\n                    shader.frames = { }\n\n                    for _, frameKey in xmlFile:iterator(shaderKey .. ".keyFrame" ) do\n                        local keyTime = xmlFile:getFloat(frameKey .. "#time" )\n\n                        local shaderValuesStr = xmlFile:getString(frameKey .. "#values" , nil )\n                        if shaderValuesStr ~ = nil then\n                            local values = string.split(shaderValuesStr, " " )\n                            if #values > 4 then\n                                Logging.xmlWarning(xmlFile, "More than 4 values(%q) given for shader parameters at %q" , shaderValuesStr, frameKey .. "#values" )\n                                end\n                                for i = 1 , 4 do -- x,y,z,w\n                                    values[i] = tonumber(values[i])\n                                end\n\n                                local keyframe = values\n                                keyframe.time = keyTime\n                                table.insert(shader.frames, keyframe)\n                            end\n                        end\n\n                        if #shader.frames > 0 then\n                            self.animation.shaderAnims = self.animation.shaderAnims or { }\n                            table.insert( self.animation.shaderAnims, shader)\n                        end\n                    end\n                end\n            end\n\n            -- convert loaded parts to anim curve\n            for _, part in ipairs( self.animation.parts) do\n                part.animCurve = AnimCurve.new(linearInterpolatorN)\n\n                for _, frame in ipairs(part.frames) do\n                    frame.time = frame.time / self.animation.maxTime -- normalize frame timtes 0 .. 1\n\n                    part.animCurve:addKeyframe(frame)\n                end\n\n                part.frames = nil\n            end\n\n            if self.animation.shaderAnims ~ = nil then\n                for _, shader in ipairs( self.animation.shaderAnims) do\n                    shader.animCurve = AnimCurve.new(linearInterpolatorN)\n\n                    for _, frame in ipairs(shader.frames) do\n                        frame.time = frame.time / self.animation.maxTime -- normalize frame timtes 0 .. 1\n\n                        shader.animCurve:addKeyframe(frame)\n                    end\n\n                    shader.frames = nil\n                end\n            end\n\n            local clipRootNode = xmlFile:getNode(animKey .. ".clip#rootNode" , nil , rootNode, i3dMappings)\n            local clipName = xmlFile:getString(animKey .. ".clip#name" )\n\n            if clipRootNode ~ = nil and clipName ~ = nil then\n                local clipFilename = xmlFile:getString(animKey .. ".clip#filename" )\n\n                self.animation.clipRootNode = clipRootNode\n                self.animation.clipName = clipName\n                self.animation.clipTrack = 0\n\n                if clipFilename ~ = nil then\n                    clipFilename = Utils.getFilename(clipFilename, self.baseDirectory)\n                    self.animation.sharedLoadRequestId = g_i3DManager:loadSharedI3DFileAsync(clipFilename, false , false , self.onSharedAnimationFileLoaded, self , nil )\n                    self.animation.clipFilename = clipFilename\n                else\n                        self:applyAnimation()\n                    end\n                end\n\n                self.rollingGateAnimations = { }\n                for _, rollingGateAnimationKey in xmlFile:iterator(animKey .. ".rollingGateAnimation" ) do\n                    local rollingGateAnimation = RollingGateAnimation.new()\n                    if rollingGateAnimation:load(xmlFile, rollingGateAnimationKey, rootNode, i3dMappings) then\n                        if self.rollingGateAnimations = = nil then\n                            self.rollingGateAnimations = { }\n                        end\n\n                        table.insert( self.rollingGateAnimations, rollingGateAnimation)\n                    end\n                end\n\n                if self.animation.duration = = nil then\n                    self.animation.duration = self.animation.maxTime\n                end\n                self.animation.duration = self.animation.duration * 1000\n\n                local initialTime = xmlFile:getFloat(animKey .. "#initialTime" , 0 ) * 1000\n                local time = 0\n                if self.animation.duration ~ = 0 then\n                    time = initialTime / self.animation.duration\n                end\n                self:setAnimTime( time , true )\n\n                local startTime = xmlFile:getFloat(key .. ".openingHours#startTime" )\n                local endTime = xmlFile:getFloat(key .. ".openingHours#endTime" )\n                if startTime ~ = nil and endTime ~ = nil then\n                    local disableIfClosed = xmlFile:getBool(key .. ".openingHours#disableIfClosed" , false )\n                    local closedText = xmlFile:getI18NValue(key .. ".openingHours#closedText" , nil , self.customEnvironment)\n                    self.openingHours = { startTime = startTime, endTime = endTime, disableIfClosed = disableIfClosed, closedText = closedText }\n                    g_messageCenter:subscribe(MessageType.HOUR_CHANGED, self.hourChanged, self )\n                end\n\n                self.isEnabled = true\n\n                local triggerId = xmlFile:getNode(key .. ".controls#triggerNode" , nil , rootNode, i3dMappings)\n                if triggerId ~ = nil then\n                    self.triggerNode = triggerId\n\n                    addTrigger( self.triggerNode, "triggerCallback" , self )\n                    for i = 0 , getNumOfChildren( self.triggerNode) - 1 do\n                        addTrigger(getChildAt( self.triggerNode, i), "triggerCallback" , self )\n                    end\n\n                    if InputAction ~ = nil then\n                        local posAction = xmlFile:getString(key .. ".controls#posAction" )\n                        if posAction ~ = nil then\n                            if InputAction[posAction] then\n                                self.controls.posAction = posAction\n\n                                local posText = xmlFile:getString(key .. ".controls#posText" )\n                                if posText ~ = nil then\n                                    if g_i18n:hasText(posText, self.customEnvironment) then\n                                        posText = g_i18n:getText(posText, self.customEnvironment)\n                                    end\n                                    self.controls.posActionText = posText\n                                end\n\n                                local negText = xmlFile:getString(key .. ".controls#negText" )\n                                if negText ~ = nil then\n                                    if g_i18n:hasText(negText, self.customEnvironment) then\n                                        negText = g_i18n:getText(negText, self.customEnvironment)\n                                    end\n                                    self.controls.negActionText = negText\n                                end\n\n                                local negAction = xmlFile:getString(key .. ".controls#negAction" )\n                                if negAction ~ = nil then\n                                    if InputAction[negAction] then\n                                        self.controls.negAction = negAction\n                                    else\n                                            printWarning( "Warning:Negative direction action \'" .. negAction .. "\' not defined!" )\n                                        end\n                                    end\n                                else\n                                        printWarning( "Warning:Positive direction action \'" .. posAction .. "\' not defined!" )\n                                    end\n                                end\n                            end\n                        end\n\n                        if g_client ~ = nil then\n                            local soundsKey = key .. ".sounds"\n                            self.samplesMoving = g_soundManager:loadSamplesFromXML(xmlFile, soundsKey, "moving" , self.baseDirectory, rootNode, 1 , AudioGroup.ENVIRONMENT, i3dMappings, nil )\n                            self.samplePosEnd = g_soundManager:loadSampleFromXML(xmlFile, soundsKey, "posEnd" , self.baseDirectory, rootNode, 1 , AudioGroup.ENVIRONMENT, i3dMappings, nil )\n                            self.sampleNegEnd = g_soundManager:loadSampleFromXML(xmlFile, soundsKey, "negEnd" , self.baseDirectory, rootNode, 1 , AudioGroup.ENVIRONMENT, i3dMappings, nil )\n                        end\n\n                        self.animatedObjectDirtyFlag = self:getNextDirtyFlag()\n\n                        return success\n                    end\n\n'})}),"\n",(0,s.jsx)(e.h3,{id:"loadframevalues",children:"loadFrameValues"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Load frame values from xml"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"loadFrameValues(XMLFile xmlFile, string key, integer node)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"XMLFile"}),(0,s.jsx)(e.th,{children:"xmlFile"}),(0,s.jsx)(e.th,{children:"XMLFile instance"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"string"}),(0,s.jsx)(e.td,{children:"key"}),(0,s.jsx)(e.td,{children:"key"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"node"}),(0,s.jsx)(e.td,{children:"node id"})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"integer"}),(0,s.jsx)(e.th,{children:"x"}),(0,s.jsx)(e.th,{children:"x translation"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"y"}),(0,s.jsx)(e.td,{children:"y translation"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"z"}),(0,s.jsx)(e.td,{children:"z translation"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"rx"}),(0,s.jsx)(e.td,{children:"x rotation"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"ry"}),(0,s.jsx)(e.td,{children:"y rotation"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"rz"}),(0,s.jsx)(e.td,{children:"z rotation"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"sx"}),(0,s.jsx)(e.td,{children:"x scale"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"sy"}),(0,s.jsx)(e.td,{children:"y scale"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"sz"}),(0,s.jsx)(e.td,{children:"z scale"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"visibility"}),(0,s.jsx)(e.td,{children:"visibility"})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:'function AnimatedObject:loadFrameValues(xmlFile, key, node)\n    local rx, ry, rz = xmlFile:getRotation(key .. "#rotation" )\n    if rx = = nil then\n        rx, ry, rz = getRotation(node)\n    end\n    local x, y, z = xmlFile:getTranslation(key .. "#translation" )\n    if x = = nil then\n        x, y, z = getTranslation(node)\n    end\n    local sx, sy, sz = xmlFile:getScale(key .. "#scale" )\n    if sx = = nil then\n        sx, sy, sz = getScale(node)\n    end\n    local isVisible = xmlFile:getBool(key .. "#visibility" , true )\n\n    local visibility = 1\n    if not isVisible then\n        -- check if node has visibility condition which would interfere with visibility animation\n            --#debug local required, prevent = getVisibilityConditionWeatherMask(node)\n            --#debug if required ~ = 0 or prevent ~ = 0 then\n                --#debug Logging.i3dWarning(node, "animated object has visibility keyframes while node also has visibility conditions applied")\n                    --#debug end\n\n                    visibility = 0\n                end\n\n                return x, y, z, rx, ry, rz, sx, sy, sz, visibility\n            end\n\n'})}),"\n",(0,s.jsx)(e.h3,{id:"loadfromxmlfile",children:"loadFromXMLFile"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Loading from attributes and nodes"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"loadFromXMLFile(XMLFile xmlFile, string key)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"XMLFile"}),(0,s.jsx)(e.th,{children:"xmlFile"}),(0,s.jsx)(e.th,{children:"XMLFile instance"})]})}),(0,s.jsx)(e.tbody,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"string"}),(0,s.jsx)(e.td,{children:"key"}),(0,s.jsx)(e.td,{children:"key"})]})})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(e.table,{children:(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"string"}),(0,s.jsx)(e.th,{children:"success"}),(0,s.jsx)(e.th,{children:"success"})]})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:'function AnimatedObject:loadFromXMLFile(xmlFile, key)\n    local animTime = xmlFile:getFloat(key .. "#time" )\n    if animTime ~ = nil then\n        self.animation.direction = xmlFile:getInt(key .. "#direction" , 0 )\n        self:setAnimTime(animTime, true )\n    end\n\n    AnimatedObject.hourChanged( self )\n\n    return true\nend\n\n'})}),"\n",(0,s.jsx)(e.h3,{id:"new",children:"new"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Creating new instance of animated object class"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"new(boolean isServer, boolean isClient, table? customMt)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"boolean"}),(0,s.jsx)(e.th,{children:"isServer"}),(0,s.jsx)(e.th,{children:"is server"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"boolean"}),(0,s.jsx)(e.td,{children:"isClient"}),(0,s.jsx)(e.td,{children:"is client"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"table?"}),(0,s.jsx)(e.td,{children:"customMt"}),(0,s.jsx)(e.td,{children:"custom metatable"})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(e.table,{children:(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"table?"}),(0,s.jsx)(e.th,{children:"self"}),(0,s.jsx)(e.th,{children:"new instance of object"})]})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject.new(isServer, isClient, customMt)\n    local self = Object.new(isServer, isClient, customMt or AnimatedObject _mt)\n    self.nodeId = 0\n    self.isMoving = false\n\n    -- input controls fields:\n    self.controls = { }\n    self.controls.wasPressed = false\n    self.controls.posAction = nil\n    self.controls.negAction = nil\n    self.controls.posText = nil\n    self.controls.negText = nil\n    self.controls.posActionEventId = nil\n    self.controls.negActionEventId = nil\n\n    self.networkTimeInterpolator = InterpolationTime.new( 1.2 )\n    self.networkAnimTimeInterpolator = InterpolatorValue.new( 0 )\n\n    self.activatable = AnimatedObjectActivatable.new( self )\n\n    return self\nend\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"readstream",children:"readStream"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Called on client side on join"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"readStream(integer streamId, table connection)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"integer"}),(0,s.jsx)(e.th,{children:"streamId"}),(0,s.jsx)(e.th,{children:"stream ID"})]})}),(0,s.jsx)(e.tbody,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"table"}),(0,s.jsx)(e.td,{children:"connection"}),(0,s.jsx)(e.td,{children:"connection"})]})})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:readStream(streamId, connection)\n    AnimatedObject:superClass().readStream( self , streamId, connection)\n    if connection:getIsServer() then\n        local animTime = streamReadFloat32(streamId)\n        self:setAnimTime(animTime, true )\n        local direction = streamReadUIntN(streamId, 2 ) - 1\n        self.animation.direction = direction\n\n        self.networkAnimTimeInterpolator:setValue(animTime)\n\n        self.networkTimeInterpolator:reset()\n    end\nend\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"readupdatestream",children:"readUpdateStream"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Called on client side on update"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"readUpdateStream(integer streamId, integer timestamp, table connection)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"integer"}),(0,s.jsx)(e.th,{children:"streamId"}),(0,s.jsx)(e.th,{children:"stream ID"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"timestamp"}),(0,s.jsx)(e.td,{children:"timestamp"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"table"}),(0,s.jsx)(e.td,{children:"connection"}),(0,s.jsx)(e.td,{children:"connection"})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:readUpdateStream(streamId, timestamp, connection)\n    AnimatedObject:superClass().readUpdateStream( self , streamId, timestamp, connection)\n    if connection:getIsServer() then\n        if streamReadBool(streamId) then\n            self.networkTimeInterpolator:startNewPhaseNetwork()\n            local animTime = streamReadFloat32(streamId)\n            self.networkAnimTimeInterpolator:setTargetValue(animTime)\n            local direction = streamReadUIntN(streamId, 2 ) - 1\n            self.animation.direction = direction\n        end\n    end\nend\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"registersavegamexmlpaths",children:"registerSavegameXMLPaths"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"registerSavegameXMLPaths()"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"any"}),(0,s.jsx)(e.th,{children:"schema"})]})}),(0,s.jsx)(e.tbody,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"any"}),(0,s.jsx)(e.td,{children:"basePath"})]})})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:'function AnimatedObject.registerSavegameXMLPaths(schema, basePath)\n    schema:register(XMLValueType.FLOAT, basePath .. "#time" , "Animated object time" )\n    schema:register(XMLValueType.INT, basePath .. "#direction" , "Animated object direction" , 0 )\nend\n\n'})}),"\n",(0,s.jsx)(e.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"any"}),(0,s.jsx)(e.th,{children:"schema"})]})}),(0,s.jsx)(e.tbody,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"any"}),(0,s.jsx)(e.td,{children:"basePath"})]})})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:'function AnimatedObject.registerXMLPaths(schema, basePath)\n    schema:setXMLSharedRegistration( "AnimatedObject" , basePath)\n\n    basePath = basePath .. ".animatedObject(?)"\n    schema:register(XMLValueType.STRING, basePath .. "#saveId" , "Save identifier" , "AnimatedObject_[nodeName]" )\n    schema:register(XMLValueType.FLOAT, basePath .. ".animation#duration" , "Animation duration(sec.)" , 3 )\n    schema:register(XMLValueType.NODE_INDEX, basePath .. ".animation.part(?)#node" , "Part node" )\n    schema:register(XMLValueType.FLOAT, basePath .. ".animation.part(?).keyFrame(?)#time" , "Key time" )\n    schema:register(XMLValueType.VECTOR_ROT, basePath .. ".animation.part(?).keyFrame(?)#rotation" , "Key rotation" , "values read from i3d node" )\n    schema:register(XMLValueType.VECTOR_TRANS, basePath .. ".animation.part(?).keyFrame(?)#translation" , "Key translation" , "values read from i3d node" )\n    schema:register(XMLValueType.VECTOR_SCALE, basePath .. ".animation.part(?).keyFrame(?)#scale" , "Key scale" , "values read from i3d node" )\n    schema:register(XMLValueType.BOOL, basePath .. ".animation.part(?).keyFrame(?)#visibility" , "Key visibility" , true )\n\n    schema:register(XMLValueType.NODE_INDEX, basePath .. ".animation.shader(?)#node" , "Shader node" )\n    schema:register(XMLValueType.STRING, basePath .. ".animation.shader(?)#parameterName" , "Shader parameter name" )\n    schema:register(XMLValueType.FLOAT, basePath .. ".animation.shader(?).keyFrame(?)#time" , "Key time" )\n    schema:register(XMLValueType.STRING, basePath .. ".animation.shader(?).keyFrame(?)#values" , "Key shader parameter values.Use \'-\' to force using existing shader parameter value" )\n\n    schema:register(XMLValueType.NODE_INDEX, basePath .. ".animation.clip#rootNode" , "I3d animation rootnode" )\n    schema:register(XMLValueType.STRING, basePath .. ".animation.clip#name" , "I3d animation clipName" )\n    schema:register(XMLValueType.STRING, basePath .. ".animation.clip#filename" , "I3d animation external animation" )\n\n    RollingGateAnimation.registerXMLPaths(schema, basePath .. ".animation.rollingGateAnimation(?)" )\n\n    schema:register(XMLValueType.FLOAT, basePath .. ".animation#initialTime" , "Animation time after loading" , 0 )\n    schema:register(XMLValueType.FLOAT, basePath .. ".openingHours#startTime" , "Start day time" )\n    schema:register(XMLValueType.FLOAT, basePath .. ".openingHours#endTime" , "End day time" )\n    schema:register(XMLValueType.BOOL, basePath .. ".openingHours#disableIfClosed" , "Disabled if closed" )\n        schema:register(XMLValueType.L10N_STRING, basePath .. ".openingHours#closedText" , "Closed text" )\n\n        schema:register(XMLValueType.NODE_INDEX, basePath .. ".controls#triggerNode" , "Player trigger node" )\n\n        schema:register(XMLValueType.STRING, basePath .. ".controls#posAction" , "Positive direction action event name" )\n        schema:registerAutoCompletionDataSource(basePath .. ".controls#posAction" , "$dataS/inputActions.xml" , "actions.action#name" )\n        schema:register(XMLValueType.STRING, basePath .. ".controls#posText" , "Positive direction text" )\n        schema:register(XMLValueType.STRING, basePath .. ".controls#negText" , "Negative direction text" )\n        schema:register(XMLValueType.STRING, basePath .. ".controls#negAction" , "Negative direction action event name" )\n        schema:registerAutoCompletionDataSource(basePath .. ".controls#negAction" , "$dataS/inputActions.xml" , "actions.action#name" )\n\n        if SoundManager ~ = nil then\n            SoundManager.registerSampleXMLPaths(schema, basePath .. ".sounds" , "moving(?)" )\n            SoundManager.registerSampleXMLPaths(schema, basePath .. ".sounds" , "posEnd" )\n            SoundManager.registerSampleXMLPaths(schema, basePath .. ".sounds" , "negEnd" )\n        end\n\n        schema:resetXMLSharedRegistration( "AnimatedObject" , basePath)\n    end\n\n'})}),"\n",(0,s.jsx)(e.h3,{id:"setanimtime",children:"setAnimTime"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Set animation time"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"setAnimTime(float t, )"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"float"}),(0,s.jsx)(e.th,{children:"t"}),(0,s.jsx)(e.th,{children:"time"})]})}),(0,s.jsx)(e.tbody,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"any"}),(0,s.jsx)(e.td,{children:"omitSound"}),(0,s.jsx)(e.td,{})]})})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:setAnimTime(t, omitSound)\n    t = math.clamp(t, 0 , 1 )\n\n    for _, part in pairs( self.animation.parts) do\n        local x, y, z, rx, ry, rz, sx, sy, sz, vis = part.animCurve:get(t)\n\n        setTranslation(part.node, x, y, z)\n        setRotation(part.node, rx, ry, rz)\n        setScale(part.node, sx, sy, sz)\n        setVisibility(part.node, vis = = 1 )\n    end\n\n    if self.animation.shaderAnims ~ = nil then\n        for _, shader in pairs( self.animation.shaderAnims) do\n            local x, y, z, w = shader.animCurve:get(t)\n            local parameterName = shader.parameterName\n\n            setShaderParameter(shader.node, parameterName, x, y, z, w, false )\n        end\n    end\n\n    local characterSet = self.animation.clipCharacterSet\n    if characterSet ~ = nil then\n        enableAnimTrack(characterSet, self.animation.clipTrack)\n        setAnimTrackTime(characterSet, self.animation.clipTrack, t * self.animation.clipDuration, true )\n        disableAnimTrack(characterSet, self.animation.clipTrack)\n    end\n\n    if self.rollingGateAnimations ~ = nil then\n        for _, rollingGateAnimation in pairs( self.rollingGateAnimations) do\n            rollingGateAnimation:setState(t)\n        end\n    end\n\n    self.animation.time = t\n    self.isMoving = true\n\n    return t\nend\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"setframevalues",children:"setFrameValues"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Set frame values"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"setFrameValues(integer node, table v)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"integer"}),(0,s.jsx)(e.th,{children:"node"}),(0,s.jsx)(e.th,{children:"node id"})]})}),(0,s.jsx)(e.tbody,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"table"}),(0,s.jsx)(e.td,{children:"v"}),(0,s.jsx)(e.td,{children:"values"})]})})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:setFrameValues(node, v)\n    setTranslation(node, v[ 1 ], v[ 2 ], v[ 3 ])\n    setRotation(node, v[ 4 ], v[ 5 ], v[ 6 ])\n    setScale(node, v[ 7 ], v[ 8 ], v[ 9 ])\n    setVisibility(node, v[ 10 ] = = 1 )\nend\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"triggercallback",children:"triggerCallback"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Trigger callback"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"triggerCallback(integer triggerId, integer otherId, boolean onEnter, boolean onLeave, boolean onStay)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"integer"}),(0,s.jsx)(e.th,{children:"triggerId"}),(0,s.jsx)(e.th,{children:"id of trigger"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"otherId"}),(0,s.jsx)(e.td,{children:"id of object that calls callback"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"boolean"}),(0,s.jsx)(e.td,{children:"onEnter"}),(0,s.jsx)(e.td,{children:"called on enter"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"boolean"}),(0,s.jsx)(e.td,{children:"onLeave"}),(0,s.jsx)(e.td,{children:"called on leave"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"boolean"}),(0,s.jsx)(e.td,{children:"onStay"}),(0,s.jsx)(e.td,{children:"called on stay"})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:triggerCallback(triggerId, otherId, onEnter, onLeave, onStay)\n    if g_currentMission.missionInfo:isa(FSCareerMissionInfo) then\n        if onEnter or onLeave then\n            if g_localPlayer ~ = nil and otherId = = g_localPlayer.rootNode then\n                if onEnter then\n                    g_currentMission.activatableObjectsSystem:addActivatable( self.activatable)\n                else\n                        g_currentMission.activatableObjectsSystem:removeActivatable( self.activatable)\n                    end\n\n                    self:raiseActive()\n                end\n            end\n        end\n    end\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"update",children:"update"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Called on update"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"update(float dt)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(e.table,{children:(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"float"}),(0,s.jsx)(e.th,{children:"dt"}),(0,s.jsx)(e.th,{children:"time since last call in ms"})]})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:update(dt)\n    AnimatedObject:superClass().update( self , dt)\n\n    local finishedAnimation = false\n\n    -- former updateTick()\n    if self.isServer then\n        if self.animation.direction ~ = 0 then\n            local newAnimTime = 0\n            if self.animation.duration ~ = 0 then\n                newAnimTime = math.clamp( self.animation.time + ( self.animation.direction * dt) / self.animation.duration, 0 , 1 )\n            end\n\n            self:setAnimTime(newAnimTime)\n            if newAnimTime = = 0 or newAnimTime = = 1 then\n                self.animation.direction = 0\n                finishedAnimation = true\n\n                -- unblock AI region when gate if fully opened\n                    if self.aiBlockingRegion ~ = nil then\n                        g_currentMission.aiSystem:setBlockingRegionState( self.aiBlockingRegion.blockingRegionId, newAnimTime = = 0 )\n                    end\n                end\n            end\n\n            if self.animation.time ~ = self.animation.timeSend then\n                self.animation.timeSend = self.animation.time\n                self:raiseDirtyFlags( self.animatedObjectDirtyFlag)\n            end\n        else\n                self.networkTimeInterpolator:update(dt)\n                local interpolationAlpha = self.networkTimeInterpolator:getAlpha()\n                local animTime = self.networkAnimTimeInterpolator:getInterpolatedValue(interpolationAlpha)\n                local newAnimTime = self:setAnimTime(animTime)\n\n                if self.animation.direction ~ = 0 then\n                    if self.animation.direction > 0 then\n                        if newAnimTime = = 1 then\n                            self.animation.direction = 0\n                            finishedAnimation = true\n                        end\n                    else\n                            if newAnimTime = = 0 then\n                                self.animation.direction = 0\n                                finishedAnimation = true\n                            end\n                        end\n                    end\n\n                    if self.networkTimeInterpolator:isInterpolating() then\n                        self:raiseActive()\n                    end\n                end\n\n                if self.samplesMoving ~ = nil then\n                    if self.isMoving and self.animation.direction ~ = 0 then\n                        if not self.samplesMovingArePlaying then\n                            g_soundManager:playSamples( self.samplesMoving)\n                            self.samplesMovingArePlaying = true\n                        end\n                    else\n                            if self.samplesMovingArePlaying then\n                                g_soundManager:stopSamples( self.samplesMoving)\n                                self.samplesMovingArePlaying = false\n                            end\n                        end\n                    end\n\n                    if finishedAnimation and self.animation.direction = = 0 then\n                        if self.samplePosEnd ~ = nil and self.animation.time = = 1 then\n                            g_soundManager:playSample( self.samplePosEnd)\n                        elseif self.sampleNegEnd ~ = nil and self.animation.time = = 0 then\n                                g_soundManager:playSample( self.sampleNegEnd)\n                            end\n                        end\n\n                        self.isMoving = false\n\n                        if self.animation.direction ~ = 0 then\n                            self:raiseActive()\n                        end\n                    end\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"writestream",children:"writeStream"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Called on server side on join"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"writeStream(integer streamId, table connection)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"integer"}),(0,s.jsx)(e.th,{children:"streamId"}),(0,s.jsx)(e.th,{children:"stream ID"})]})}),(0,s.jsx)(e.tbody,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"table"}),(0,s.jsx)(e.td,{children:"connection"}),(0,s.jsx)(e.td,{children:"connection"})]})})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:writeStream(streamId, connection)\n    AnimatedObject:superClass().writeStream( self , streamId, connection)\n    if not connection:getIsServer() then\n        streamWriteFloat32(streamId, self.animation.time )\n        streamWriteUIntN(streamId, self.animation.direction + 1 , 2 )\n    end\nend\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"writeupdatestream",children:"writeUpdateStream"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Called on server side on update"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"writeUpdateStream(integer streamId, table connection, integer dirtyMask)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"integer"}),(0,s.jsx)(e.th,{children:"streamId"}),(0,s.jsx)(e.th,{children:"stream ID"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"table"}),(0,s.jsx)(e.td,{children:"connection"}),(0,s.jsx)(e.td,{children:"connection"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"integer"}),(0,s.jsx)(e.td,{children:"dirtyMask"}),(0,s.jsx)(e.td,{children:"dirty mask"})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function AnimatedObject:writeUpdateStream(streamId, connection, dirtyMask)\n    AnimatedObject:superClass().writeUpdateStream( self , streamId, connection, dirtyMask)\n    if not connection:getIsServer() then\n        if streamWriteBool(streamId, bit32.band(dirtyMask, self.animatedObjectDirtyFlag) ~ = 0 ) then\n            streamWriteFloat32(streamId, self.animation.timeSend)\n            streamWriteUIntN(streamId, self.animation.direction + 1 , 2 )\n        end\n    end\nend\n\n"})})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}}}]);