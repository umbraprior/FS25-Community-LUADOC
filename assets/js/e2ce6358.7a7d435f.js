"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[59940],{14497(e,n,l){l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"script/Specializations/ConveyorBelt","title":"ConveyorBelt","description":"ConveyorBelt","source":"@site/../docs/script/Specializations/ConveyorBelt.md","sourceDirName":"script/Specializations","slug":"/script/Specializations/ConveyorBelt","permalink":"/FS25-Community-LUADOC/script/Specializations/ConveyorBelt","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"ConnectionHoses","permalink":"/FS25-Community-LUADOC/script/Specializations/ConnectionHoses"},"next":{"title":"Cover","permalink":"/FS25-Community-LUADOC/script/Specializations/Cover"}}');var i=l(74848),r=l(28453);const s={},c=void 0,o={},d=[{value:"ConveyorBelt",id:"conveyorbelt",level:2},{value:"getConveyorBeltFillLevel",id:"getconveyorbeltfilllevel",level:3},{value:"getConveyorBeltTargetObject",id:"getconveyorbelttargetobject",level:3},{value:"getDischargeNodeEmptyFactor",id:"getdischargenodeemptyfactor",level:3},{value:"getFillUnitAllowsFillType",id:"getfillunitallowsfilltype",level:3},{value:"getFillUnitFreeCapacity",id:"getfillunitfreecapacity",level:3},{value:"getHasConveyorBeltLoop",id:"gethasconveyorbeltloop",level:3},{value:"getIsEnterable",id:"getisenterable",level:3},{value:"getLoadTriggerMaxFillSpeed",id:"getloadtriggermaxfillspeed",level:3},{value:"handleDischarge",id:"handledischarge",level:3},{value:"handleDischargeOnEmpty",id:"handledischargeonempty",level:3},{value:"initSpecialization",id:"initspecialization",level:3},{value:"onDelete",id:"ondelete",level:3},{value:"onFillUnitFillLevelChanged",id:"onfillunitfilllevelchanged",level:3},{value:"onLoad",id:"onload",level:3},{value:"onMovingToolChanged",id:"onmovingtoolchanged",level:3},{value:"onPostLoad",id:"onpostload",level:3},{value:"onReadUpdateStream",id:"onreadupdatestream",level:3},{value:"onUpdateTick",id:"onupdatetick",level:3},{value:"onWriteUpdateStream",id:"onwriteupdatestream",level:3},{value:"prerequisitesPresent",id:"prerequisitespresent",level:3},{value:"registerEventListeners",id:"registereventlisteners",level:3},{value:"registerFunctions",id:"registerfunctions",level:3},{value:"registerOverwrittenFunctions",id:"registeroverwrittenfunctions",level:3},{value:"updateDebugValues",id:"updatedebugvalues",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"conveyorbelt",children:"ConveyorBelt"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Class for conveyor belts to control unloading start time and unloading effects"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Functions"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#getconveyorbeltfilllevel",children:"getConveyorBeltFillLevel"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#getconveyorbelttargetobject",children:"getConveyorBeltTargetObject"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#getdischargenodeemptyfactor",children:"getDischargeNodeEmptyFactor"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#getfillunitallowsfilltype",children:"getFillUnitAllowsFillType"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#getfillunitfreecapacity",children:"getFillUnitFreeCapacity"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#gethasconveyorbeltloop",children:"getHasConveyorBeltLoop"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#getisenterable",children:"getIsEnterable"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#getloadtriggermaxfillspeed",children:"getLoadTriggerMaxFillSpeed"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#handledischarge",children:"handleDischarge"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#handledischargeonempty",children:"handleDischargeOnEmpty"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#initspecialization",children:"initSpecialization"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#ondelete",children:"onDelete"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onfillunitfilllevelchanged",children:"onFillUnitFillLevelChanged"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onload",children:"onLoad"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onmovingtoolchanged",children:"onMovingToolChanged"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onpostload",children:"onPostLoad"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onreadupdatestream",children:"onReadUpdateStream"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onupdatetick",children:"onUpdateTick"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onwriteupdatestream",children:"onWriteUpdateStream"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#prerequisitespresent",children:"prerequisitesPresent"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registereventlisteners",children:"registerEventListeners"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registerfunctions",children:"registerFunctions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registeroverwrittenfunctions",children:"registerOverwrittenFunctions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#updatedebugvalues",children:"updateDebugValues"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"getconveyorbeltfilllevel",children:"getConveyorBeltFillLevel"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"getConveyorBeltFillLevel()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:getConveyorBeltFillLevel()\n    local spec = self.spec_conveyorBelt\n    local fillLevel = self:getFillUnitFillLevel(spec.fillUnitIndex)\n    if self.getCurrentDischargeNode ~ = nil then\n        local currentDischargeNode = self:getCurrentDischargeNode()\n        local object = currentDischargeNode.dischargeHitObject\n        if object ~ = nil and object.getConveyorBeltFillLevel ~ = nil then\n            fillLevel = fillLevel + object:getConveyorBeltFillLevel()\n        end\n    end\n\n    return fillLevel\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getconveyorbelttargetobject",children:"getConveyorBeltTargetObject"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"getConveyorBeltTargetObject()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:getConveyorBeltTargetObject()\n    if self.getCurrentDischargeNode ~ = nil then\n        local currentDischargeNode = self:getCurrentDischargeNode()\n        local object, targetFillUnitIndex = currentDischargeNode.dischargeHitObject, currentDischargeNode.dischargeHitObjectUnitIndex\n        if object ~ = nil then\n            if object.getConveyorBeltTargetObject ~ = nil then\n                return object:getConveyorBeltTargetObject()\n            else\n                    return object, targetFillUnitIndex\n                end\n            end\n        end\n\n        return nil\n    end\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getdischargenodeemptyfactor",children:"getDischargeNodeEmptyFactor"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"getDischargeNodeEmptyFactor()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"superFunc"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"dischargeNode"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:getDischargeNodeEmptyFactor(superFunc, dischargeNode)\n    local spec = self.spec_conveyorBelt\n    local parentFactor = superFunc( self , dischargeNode)\n\n    if spec.dischargeNodeIndex = = dischargeNode.index then\n        if spec.morphEndPos = = 1 then\n            return spec.emptyFactor\n        else\n                return 0\n            end\n        end\n\n        return parentFactor\n    end\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getfillunitallowsfilltype",children:"getFillUnitAllowsFillType"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"getFillUnitAllowsFillType()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"superFunc"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"fillUnitIndex"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"fillType"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:getFillUnitAllowsFillType(superFunc, fillUnitIndex, fillType)\n    if not superFunc( self , fillUnitIndex, fillType) then\n        return false\n    end\n\n    if not ConveyorBelt.getHasConveyorBeltLoop( self , self , fillUnitIndex) then\n        if self.getCurrentDischargeNode ~ = nil then\n            local currentDischargeNode = self:getCurrentDischargeNode()\n            if currentDischargeNode.fillUnitIndex = = fillUnitIndex then\n                local object, targetFillUnitIndex = currentDischargeNode.dischargeHitObject, currentDischargeNode.dischargeHitObjectUnitIndex\n                if object ~ = nil and object.getFillUnitAllowsFillType ~ = nil and targetFillUnitIndex ~ = nil then\n                    if currentDischargeNode.fillTypeConverter ~ = nil then\n                        local conversion = currentDischargeNode.fillTypeConverter[fillType]\n                        if conversion ~ = nil then\n                            if object:getFillUnitAllowsFillType(targetFillUnitIndex, conversion.targetFillTypeIndex) then\n                                return true\n                            end\n                        end\n                    end\n\n                    return object:getFillUnitAllowsFillType(targetFillUnitIndex, fillType)\n                end\n            end\n        end\n    end\n\n    return true\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getfillunitfreecapacity",children:"getFillUnitFreeCapacity"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"getFillUnitFreeCapacity()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"superFunc"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"fillUnitIndex"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"fillTypeIndex"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"farmId"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:getFillUnitFreeCapacity(superFunc, fillUnitIndex, fillTypeIndex, farmId)\n    local freeCapacity = superFunc( self , fillUnitIndex, fillTypeIndex, farmId)\n\n    if not ConveyorBelt.getHasConveyorBeltLoop( self , self , fillUnitIndex) then\n        if self.getCurrentDischargeNode ~ = nil then\n            local currentDischargeNode = self:getCurrentDischargeNode()\n            if currentDischargeNode.fillUnitIndex = = fillUnitIndex then\n                local object, targetFillUnitIndex = currentDischargeNode.dischargeHitObject, currentDischargeNode.dischargeHitObjectUnitIndex\n                if object ~ = nil and object.getFillUnitFreeCapacity ~ = nil and targetFillUnitIndex ~ = nil then\n                    return freeCapacity + object:getFillUnitFreeCapacity(targetFillUnitIndex, fillTypeIndex, farmId)\n                end\n            end\n        end\n    end\n\n    return freeCapacity\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"gethasconveyorbeltloop",children:"getHasConveyorBeltLoop"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"getHasConveyorBeltLoop()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"rootVehicle"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"vehicle"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"fillUnitIndex"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt.getHasConveyorBeltLoop(rootVehicle, vehicle, fillUnitIndex)\n    if vehicle.getCurrentDischargeNode ~ = nil then\n        local currentDischargeNode = vehicle:getCurrentDischargeNode()\n        if currentDischargeNode.fillUnitIndex = = fillUnitIndex then\n            local object, targetFillUnitIndex = currentDischargeNode.dischargeHitObject, currentDischargeNode.dischargeHitObjectUnitIndex\n            if object ~ = nil and object.spec_conveyorBelt ~ = nil and targetFillUnitIndex ~ = nil then\n                if object = = rootVehicle then\n                    return true\n                end\n\n                return ConveyorBelt.getHasConveyorBeltLoop(rootVehicle, object, targetFillUnitIndex)\n            end\n        end\n    end\n\n    return false\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getisenterable",children:"getIsEnterable"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"getIsEnterable()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"superFunc"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:getIsEnterable(superFunc)\n    return( self.getAttacherVehicle = = nil or self:getAttacherVehicle() = = nil ) and superFunc( self )\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getloadtriggermaxfillspeed",children:"getLoadTriggerMaxFillSpeed"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"getLoadTriggerMaxFillSpeed()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:getLoadTriggerMaxFillSpeed()\n    local maxSpeed = math.huge\n    if self.getCurrentDischargeNode ~ = nil then\n        local currentDischargeNode = self:getCurrentDischargeNode()\n        maxSpeed = currentDischargeNode.emptySpeed\n        local object = currentDischargeNode.dischargeHitObject\n        if object ~ = nil then\n            if object.getLoadTriggerMaxFillSpeed ~ = nil then\n                maxSpeed = math.min(object:getLoadTriggerMaxFillSpeed(), maxSpeed)\n            end\n        end\n    end\n\n    return maxSpeed\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"handledischarge",children:"handleDischarge"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"handleDischarge()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"superFunc"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"dischargeNode"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"dischargedLiters"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"minDropReached"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"hasMinDropFillLevel"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:handleDischarge(superFunc, dischargeNode, dischargedLiters, minDropReached, hasMinDropFillLevel)\n    local spec = self.spec_conveyorBelt\n    -- do nothing if it is conveyor dischargenode\n        if dischargeNode.index ~ = spec.dischargeNodeIndex then\n            superFunc( self , dischargeNode, dischargedLiters, minDropReached, hasMinDropFillLevel)\n        end\n    end\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"handledischargeonempty",children:"handleDischargeOnEmpty"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"handleDischargeOnEmpty()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"superFunc"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"dischargeNode"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:handleDischargeOnEmpty(superFunc, dischargeNode)\n    local spec = self.spec_conveyorBelt\n    -- do nothing if conveyorBelt dischargenode is empty\n        if dischargeNode.index ~ = spec.dischargeNodeIndex then\n            superFunc( self , dischargeNode)\n        end\n    end\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"initspecialization",children:"initSpecialization"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"initSpecialization()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function ConveyorBelt.initSpecialization()\n    local schema = Vehicle.xmlSchema\n    schema:setXMLSpecializationType( "ConveyorBelt" )\n\n    AnimationManager.registerAnimationNodesXMLPaths(schema, "vehicle.conveyorBelt.animationNodes" )\n    EffectManager.registerEffectXMLPaths(schema, "vehicle.conveyorBelt.effects" )\n\n    schema:register(XMLValueType.INT, "vehicle.conveyorBelt#dischargeNodeIndex" , "Discharge node index" , 1 )\n    schema:register(XMLValueType.FLOAT, "vehicle.conveyorBelt#startPercentage" , "Start unloading percentage" , 0.9 )\n\n    schema:register(XMLValueType.NODE_INDEX, "vehicle.conveyorBelt.offset(?)#movingToolNode" , "Moving tool node" )\n    schema:register(XMLValueType.INT, "vehicle.conveyorBelt.offset(?).effect(?)#index" , "Index of effect" , 0 )\n    schema:register(XMLValueType.FLOAT, "vehicle.conveyorBelt.offset(?).effect(?)#minOffset" , "Min.offset" , 0 )\n    schema:register(XMLValueType.FLOAT, "vehicle.conveyorBelt.offset(?).effect(?)#maxOffset" , "Max.offset" , 1 )\n    schema:register(XMLValueType.BOOL, "vehicle.conveyorBelt.offset(?).effect(?)#inverted" , "Is inverted" , false )\n\n    SoundManager.registerSampleXMLPaths(schema, "vehicle.conveyorBelt.sounds" , "belt" )\n\n    schema:setXMLSpecializationType()\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"ondelete",children:"onDelete"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Called on deleting"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onDelete()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:onDelete()\n    local spec = self.spec_conveyorBelt\n    g_effectManager:deleteEffects(spec.effects)\n    g_animationManager:deleteAnimations(spec.animationNodes)\n    g_soundManager:deleteSamples(spec.samples)\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"onfillunitfilllevelchanged",children:"onFillUnitFillLevelChanged"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onFillUnitFillLevelChanged()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"fillUnitIndex"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"fillLevelDelta"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"fillType"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"toolType"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"fillPositionData"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"appliedDelta"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:onFillUnitFillLevelChanged(fillUnitIndex, fillLevelDelta, fillType, toolType, fillPositionData, appliedDelta)\n    local spec = self.spec_conveyorBelt\n    if spec.fillUnitIndex = = fillUnitIndex then\n        local fillLevel = self:getFillUnitFillLevel(fillUnitIndex)\n\n        if self.isServer then\n            local isFilling, isScrolling = false , false\n            if fillLevelDelta > 0 then\n                spec.morphStartPos = 0\n                spec.morphEndPos = math.max(spec.morphEndPos, fillLevel / self:getFillUnitCapacity(fillUnitIndex))\n                spec.isEffectDirty = true\n                isFilling = true\n            end\n\n            if fillLevelDelta ~ = 0 then\n                spec.scrollUpdateTime = 100\n                isScrolling = true\n            end\n\n            if isFilling ~ = spec.isFilling or isScrolling ~ = spec.isScrolling then\n                spec.isFilling = isFilling\n                spec.isScrolling = isScrolling\n                self:raiseDirtyFlags(spec.dirtyFlag)\n            end\n        end\n\n        if fillLevel = = 0 then\n            g_effectManager:stopEffects(spec.effects)\n            spec.morphStartPos = 0\n            spec.morphEndPos = 0\n            spec.isEffectDirty = true\n        else\n                g_effectManager:setEffectTypeInfo(spec.effects, fillType)\n                for _, effect in pairs(spec.effects) do\n                    g_effectManager:startEffect(effect, true )\n                end\n            end\n        end\n    end\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"onload",children:"onLoad"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Called on loading"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onLoad(table savegame)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table"}),(0,i.jsx)(n.th,{children:"savegame"}),(0,i.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function ConveyorBelt:onLoad(savegame)\n    local spec = self.spec_conveyorBelt\n\n    if self.isClient then\n        spec.animationNodes = g_animationManager:loadAnimations( self.xmlFile, "vehicle.conveyorBelt.animationNodes" , self.components, self , self.i3dMappings)\n\n        spec.samples = { }\n        spec.samples.belt = g_soundManager:loadSampleFromXML( self.xmlFile, "vehicle.conveyorBelt.sounds" , "belt" , self.baseDirectory, self.components, 0 , AudioGroup.VEHICLE, self.i3dMappings, self )\n    end\n\n    spec.effects = g_effectManager:loadEffect( self.xmlFile, "vehicle.conveyorBelt.effects" , self.components, self , self.i3dMappings)\n    spec.currentDelay = 0.0001\n    table.sort(spec.effects, function (effect1, effect2) return effect1.startDelay < effect2.startDelay end )\n\n    for _, effect in pairs(spec.effects) do\n        if effect.planeFadeTime ~ = nil then\n            spec.currentDelay = spec.currentDelay + effect.planeFadeTime\n        end\n        if effect.setScrollUpdate ~ = nil then\n            effect:setScrollUpdate( false )\n        end\n    end\n    spec.maxDelay = spec.currentDelay\n\n    spec.morphStartPos = 0\n    spec.morphEndPos = 0\n    spec.isEffectDirty = true\n    spec.emptyFactor = 1\n    spec.scrollUpdateTime = 0\n    spec.lastScrollUpdate = false\n\n    spec.fillUnitIndex = 1\n    spec.startFillLevel = 0\n\n    spec.dischargeNodeIndex = self.xmlFile:getValue( "vehicle.conveyorBelt#dischargeNodeIndex" , 1 )\n    self:setCurrentDischargeNodeIndex(spec.dischargeNodeIndex)\n    local dischargeNode = self:getDischargeNodeByIndex(spec.dischargeNodeIndex)\n    if dischargeNode ~ = nil then\n        local capacity = self:getFillUnitCapacity(dischargeNode.fillUnitIndex)\n        spec.fillUnitIndex = dischargeNode.fillUnitIndex\n        spec.startFillLevel = capacity * self.xmlFile:getValue( "vehicle.conveyorBelt#startPercentage" , 0.9 )\n    end\n\n    local i = 0\n    while true do\n        local key = string.format( "vehicle.conveyorBelt.offset(%d)" , i)\n        if not self.xmlFile:hasProperty(key) then\n            break\n        end\n\n        local movingToolNode = self.xmlFile:getValue(key .. "#movingToolNode" , nil , self.components, self.i3dMappings)\n        if movingToolNode ~ = nil then\n            if spec.offsets = = nil then\n                spec.offsets = { }\n            end\n\n            local offset = { }\n            offset.lastState = nil\n            offset.movingToolNode = movingToolNode\n            offset.effects = { }\n            local j = 0\n            while true do\n                local effectKey = string.format(key .. ".effect(%d)" , j)\n                if not self.xmlFile:hasProperty(effectKey) then\n                    break\n                end\n\n                local effectIndex = self.xmlFile:getValue(effectKey .. "#index" , 0 )\n                local effect = spec.effects[effectIndex]\n                if effect ~ = nil and effect.setOffset ~ = nil then\n                    local entry = { }\n                    entry.effect = effect\n                    entry.minValue = self.xmlFile:getValue(effectKey .. "#minOffset" , 0 ) * 1000\n                    entry.maxValue = self.xmlFile:getValue(effectKey .. "#maxOffset" , 1 ) * 1000\n                    entry.inverted = self.xmlFile:getValue(effectKey .. "#inverted" , false )\n                    table.insert(offset.effects, entry)\n                else\n                        Logging.xmlWarning( self.xmlFile, "Effect index \'%d\' not found at \'%s\'!" , effectIndex, effectKey)\n                    end\n                    j = j + 1\n                end\n\n                table.insert(spec.offsets, offset)\n            else\n                    Logging.xmlWarning( self.xmlFile, "Missing movingToolNode for conveyor offset \'%s\'!" , key)\n                    end\n                    i = i + 1\n                end\n\n                spec.isFilling = false\n                spec.isScrolling = false\n\n                spec.dirtyFlag = self:getNextDirtyFlag()\n            end\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"onmovingtoolchanged",children:"onMovingToolChanged"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onMovingToolChanged()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"movingTool"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"speed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"dt"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:onMovingToolChanged(movingTool, speed, dt)\n    local spec = self.spec_conveyorBelt\n    if spec.offsets ~ = nil and spec.movingToolToOffset ~ = nil then\n        local offset = spec.movingToolToOffset[movingTool]\n\n        if offset ~ = nil then\n            local state = Cylindered.getMovingToolState( self , movingTool)\n            if state ~ = offset.lastState then\n                local updateDelay = false\n\n                for _, entry in pairs(offset.effects) do\n                    local effectState = state\n                    if entry.inverted then\n                        effectState = 1 - effectState\n                    end\n\n                    entry.effect:setOffset( MathUtil.lerp(entry.minValue, entry.maxValue, effectState))\n                    updateDelay = true\n                    spec.isEffectDirty = true\n                end\n\n                if updateDelay then\n                    spec.currentDelay = 0\n                    for _, effect in pairs(spec.effects) do\n                        if effect.planeFadeTime ~ = nil then\n                            spec.currentDelay = spec.currentDelay + effect.planeFadeTime - effect.offset\n                        end\n                    end\n                end\n\n                offset.lastState = state\n            end\n        end\n    end\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"onpostload",children:"onPostLoad"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onPostLoad()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:onPostLoad(savegame)\n    local spec = self.spec_conveyorBelt\n\n    -- we need to check movingTool in post load to avoid order dependencies\n    if spec.offsets ~ = nil then\n        if self.getMovingToolByNode ~ = nil then\n            spec.movingToolToOffset = { }\n            for i = #spec.offsets, 1 , - 1 do\n                local offset = spec.offsets[i]\n                local movingTool = self:getMovingToolByNode(offset.movingToolNode)\n                if movingTool ~ = nil then\n                    offset.movingTool = movingTool\n                    spec.movingToolToOffset[movingTool] = offset\n                    ConveyorBelt.onMovingToolChanged( self , movingTool, 0 , 0 )\n                else\n                        Logging.xmlWarning( self.xmlFile, \"No movingTool node '%s' defined for conveyor offset '%d'!\" , getName(offset.movingToolNode), i)\n                            table.remove(spec.offsets, i)\n                        end\n                    end\n\n                    if #spec.offsets = = 0 then\n                        spec.offsets = nil\n                        spec.movingToolToOffset = nil\n                    end\n                else\n                        Logging.xmlError( self.xmlFile, \"'Cylindered' specialization is required to use conveyorBelt offsets!\" )\n                        spec.offsets = nil\n                    end\n                end\n            end\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"onreadupdatestream",children:"onReadUpdateStream"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Called on on update"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onReadUpdateStream(integer streamId, integer timestamp, table connection)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"integer"}),(0,i.jsx)(n.th,{children:"streamId"}),(0,i.jsx)(n.th,{children:"stream ID"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"integer"}),(0,i.jsx)(n.td,{children:"timestamp"}),(0,i.jsx)(n.td,{children:"timestamp"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"table"}),(0,i.jsx)(n.td,{children:"connection"}),(0,i.jsx)(n.td,{children:"connection"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:onReadUpdateStream(streamId, timestamp, connection)\n    if connection:getIsServer() then\n        if streamReadBool(streamId) then\n            local spec = self.spec_conveyorBelt\n            spec.isFilling = streamReadBool(streamId)\n            spec.isScrolling = streamReadBool(streamId)\n        end\n    end\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"onupdatetick",children:"onUpdateTick"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Called on update tick"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onUpdateTick(float dt, boolean isActiveForInput, boolean isSelected, )"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"float"}),(0,i.jsx)(n.th,{children:"dt"}),(0,i.jsx)(n.th,{children:"time since last call in ms"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"isActiveForInput"}),(0,i.jsx)(n.td,{children:"true if vehicle is active for input"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"isSelected"}),(0,i.jsx)(n.td,{children:"true if vehicle is selected"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"isSelected"}),(0,i.jsx)(n.td,{})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function ConveyorBelt:onUpdateTick(dt, isActiveForInput, isActiveForInputIgnoreSelection, isSelected)\n    local spec = self.spec_conveyorBelt\n\n    if not self.isServer then\n        if spec.isFilling then\n            spec.morphStartPos = 0\n            spec.morphEndPos = math.max(spec.morphEndPos, self:getFillUnitFillLevelPercentage(spec.fillUnitIndex))\n            spec.isEffectDirty = true\n        end\n\n        if spec.isScrolling then\n            spec.scrollUpdateTime = 100\n        end\n    end\n\n    local doScrollUpdate = spec.scrollUpdateTime > 0\n    if doScrollUpdate ~ = spec.lastScrollUpdate then\n        if self.isClient then\n            if doScrollUpdate then\n                g_animationManager:startAnimations(spec.animationNodes)\n                g_soundManager:playSample(spec.samples.belt)\n            else\n                    g_animationManager:stopAnimations(spec.animationNodes)\n                    g_soundManager:stopSample(spec.samples.belt)\n                end\n\n                for _, effect in pairs(spec.effects) do\n                    if effect.setScrollUpdate ~ = nil then\n                        effect:setScrollUpdate(doScrollUpdate)\n                    end\n                end\n            end\n\n            spec.lastScrollUpdate = doScrollUpdate\n        end\n        spec.scrollUpdateTime = math.max(spec.scrollUpdateTime - dt, 0 )\n\n        local isBeltActive = self:getDischargeState() ~ = Dischargeable.DISCHARGE_STATE_OFF\n        if isBeltActive then\n            local fillFactor = self:getFillUnitFillLevelPercentage(spec.fillUnitIndex)\n            if fillFactor > 0.0001 then\n                local movedFactor = dt / spec.currentDelay\n                spec.morphStartPos = math.clamp(spec.morphStartPos + movedFactor, 0 , 1 )\n                spec.morphEndPos = math.clamp(spec.morphEndPos + movedFactor, 0 , 1 )\n\n                -- we calculate the empty factor based on visual effect mesh and filllevel to get a smooth transition\n                local visualFactor = spec.morphEndPos - spec.morphStartPos\n\n                spec.emptyFactor = 1\n                if visualFactor > fillFactor then\n                    spec.emptyFactor = math.clamp(fillFactor / math.max(visualFactor, 0.001 ), 0 , 1 )\n                else\n                        local offset = fillFactor - visualFactor\n                        spec.offset = offset\n                        spec.morphStartPos = math.clamp(spec.morphStartPos - (offset / math.max(( 1 - spec.morphStartPos) * spec.currentDelay, 0.001 )) * dt, 0 , 1 )\n                    end\n\n                    spec.isEffectDirty = true\n                    spec.scrollUpdateTime = dt * 3\n                end\n            end\n\n            if doScrollUpdate then\n                self:raiseActive()\n            end\n\n            if self.isClient then\n                if spec.isEffectDirty then\n                    for _, effect in pairs(spec.effects) do\n                        if effect.setMorphPosition ~ = nil then\n                            local effectStart = effect.startDelay / spec.currentDelay\n                            local effectEnd = (effect.startDelay + effect.planeFadeTime - effect.offset) / spec.currentDelay\n                            local offsetFactor = effect.offset / effect.planeFadeTime\n\n                            local startMorphFactor = (spec.morphStartPos - effectStart) / (effectEnd - effectStart)\n                            local startMorph = math.clamp(offsetFactor + startMorphFactor * ( 1 - offsetFactor), offsetFactor, 1 )\n\n                            local endMorphFactor = (spec.morphEndPos - effectStart) / (effectEnd - effectStart)\n                            local endMorph = math.clamp(offsetFactor + endMorphFactor * ( 1 - offsetFactor), offsetFactor, 1 )\n\n                            --renderText(0.6, 0.8-i*0.015, 0.012, string.format("%d:effectStart %.4f effectEnd %.4f -> startMorph %.4f endMorph %.4f | offset %.4f | %.4f %.4f", i, effectStart, effectEnd, startMorph, endMorph, effect.offset/effect.planeFadeTime, (spec.morphStartPos-effectStart)/(effectEnd-effectStart), (spec.morphEndPos-effectStart)/(effectEnd-effectStart)))\n                            effect:setMorphPosition(startMorph, endMorph)\n                        end\n                    end\n                    spec.isEffectDirty = false\n                end\n            end\n        end\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"onwriteupdatestream",children:"onWriteUpdateStream"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Called on on update"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onWriteUpdateStream(integer streamId, table connection, integer dirtyMask)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"integer"}),(0,i.jsx)(n.th,{children:"streamId"}),(0,i.jsx)(n.th,{children:"stream ID"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"table"}),(0,i.jsx)(n.td,{children:"connection"}),(0,i.jsx)(n.td,{children:"connection"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"integer"}),(0,i.jsx)(n.td,{children:"dirtyMask"}),(0,i.jsx)(n.td,{children:"dirty mask"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt:onWriteUpdateStream(streamId, connection, dirtyMask)\n    if not connection:getIsServer() then\n        local spec = self.spec_conveyorBelt\n        if streamWriteBool(streamId, bit32.band(dirtyMask, spec.dirtyFlag) ~ = 0 ) then\n            streamWriteBool(streamId, spec.isFilling)\n            streamWriteBool(streamId, spec.isScrolling)\n        end\n    end\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"prerequisitespresent",children:"prerequisitesPresent"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Checks if all prerequisite specializations are loaded"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"prerequisitesPresent(table specializations)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table"}),(0,i.jsx)(n.th,{children:"specializations"}),(0,i.jsx)(n.th,{children:"specializations"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table"}),(0,i.jsx)(n.th,{children:"hasPrerequisite"}),(0,i.jsx)(n.th,{children:"true if all prerequisite specializations are loaded"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function ConveyorBelt.prerequisitesPresent(specializations)\n    return SpecializationUtil.hasSpecialization( Dischargeable , specializations)\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"registereventlisteners",children:"registerEventListeners"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerEventListeners()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"vehicleType"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function ConveyorBelt.registerEventListeners(vehicleType)\n    SpecializationUtil.registerEventListener(vehicleType, "onLoad" , ConveyorBelt )\n    SpecializationUtil.registerEventListener(vehicleType, "onPostLoad" , ConveyorBelt )\n    SpecializationUtil.registerEventListener(vehicleType, "onDelete" , ConveyorBelt )\n    SpecializationUtil.registerEventListener(vehicleType, "onReadUpdateStream" , ConveyorBelt )\n    SpecializationUtil.registerEventListener(vehicleType, "onWriteUpdateStream" , ConveyorBelt )\n    SpecializationUtil.registerEventListener(vehicleType, "onUpdateTick" , ConveyorBelt )\n    SpecializationUtil.registerEventListener(vehicleType, "onFillUnitFillLevelChanged" , ConveyorBelt )\n    SpecializationUtil.registerEventListener(vehicleType, "onMovingToolChanged" , ConveyorBelt )\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registerfunctions",children:"registerFunctions"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerFunctions()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"vehicleType"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function ConveyorBelt.registerFunctions(vehicleType)\n    SpecializationUtil.registerFunction(vehicleType, "getConveyorBeltFillLevel" , ConveyorBelt.getConveyorBeltFillLevel)\n    SpecializationUtil.registerFunction(vehicleType, "getConveyorBeltTargetObject" , ConveyorBelt.getConveyorBeltTargetObject)\n    SpecializationUtil.registerFunction(vehicleType, "getLoadTriggerMaxFillSpeed" , ConveyorBelt.getLoadTriggerMaxFillSpeed)\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registeroverwrittenfunctions",children:"registerOverwrittenFunctions"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerOverwrittenFunctions()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"vehicleType"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function ConveyorBelt.registerOverwrittenFunctions(vehicleType)\n    SpecializationUtil.registerOverwrittenFunction(vehicleType, "getDischargeNodeEmptyFactor" , ConveyorBelt.getDischargeNodeEmptyFactor)\n    SpecializationUtil.registerOverwrittenFunction(vehicleType, "handleDischargeOnEmpty" , ConveyorBelt.handleDischargeOnEmpty)\n    SpecializationUtil.registerOverwrittenFunction(vehicleType, "handleDischarge" , ConveyorBelt.handleDischarge)\n    SpecializationUtil.registerOverwrittenFunction(vehicleType, "getIsEnterable" , ConveyorBelt.getIsEnterable)\n    SpecializationUtil.registerOverwrittenFunction(vehicleType, "getFillUnitAllowsFillType" , ConveyorBelt.getFillUnitAllowsFillType)\n    SpecializationUtil.registerOverwrittenFunction(vehicleType, "getFillUnitFreeCapacity" , ConveyorBelt.getFillUnitFreeCapacity)\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"updatedebugvalues",children:"updateDebugValues"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"updateDebugValues()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"values"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function ConveyorBelt:updateDebugValues(values)\n    local spec = self.spec_conveyorBelt\n\n    table.insert(values, { name = "fillFactor" , value = self:getFillUnitFillLevelPercentage(spec.fillUnitIndex) } )\n    table.insert(values, { name = "visualFactor" , value = spec.morphEndPos - spec.morphStartPos } )\n    table.insert(values, { name = "currentDelay" , value = spec.currentDelay } )\n    table.insert(values, { name = "offset" , value = spec.offset } )\n    table.insert(values, { name = "morphStartPos" , value = spec.morphStartPos } )\n    table.insert(values, { name = "morphEndPos" , value = spec.morphEndPos } )\nend\n\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453(e,n,l){l.d(n,{R:()=>s,x:()=>c});var t=l(96540);const i={},r=t.createContext(i);function s(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);