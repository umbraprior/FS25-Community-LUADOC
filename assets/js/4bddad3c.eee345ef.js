"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[31420],{28453(e,n,i){i.d(n,{R:()=>r,x:()=>s});var l=i(96540);const a={},t=l.createContext(a);function r(e){const n=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),l.createElement(t.Provider,{value:n},e.children)}},62369(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>o,frontMatter:()=>r,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"script/Vehicles/VehicleCharacter","title":"VehicleCharacter","description":"VehicleCharacter","source":"@site/../docs/script/Vehicles/VehicleCharacter.md","sourceDirName":"script/Vehicles","slug":"/script/Vehicles/VehicleCharacter","permalink":"/FS25-Community-LUADOC/script/Vehicles/VehicleCharacter","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"VehicleCamera","permalink":"/FS25-Community-LUADOC/script/Vehicles/VehicleCamera"},"next":{"title":"VehicleLoadingData","permalink":"/FS25-Community-LUADOC/script/Vehicles/VehicleLoadingData"}}');var a=i(74848),t=i(28453);const r={},s=void 0,c={},d=[{value:"VehicleCharacter",id:"vehiclecharacter",level:2},{value:"characterLoaded",id:"characterloaded",level:3},{value:"delete",id:"delete",level:3},{value:"getAllowCharacterUpdate",id:"getallowcharacterupdate",level:3},{value:"getIKChainTargets",id:"getikchaintargets",level:3},{value:"getParentComponent",id:"getparentcomponent",level:3},{value:"getPlayerStyle",id:"getplayerstyle",level:3},{value:"load",id:"load",level:3},{value:"loadCharacter",id:"loadcharacter",level:3},{value:"new",id:"new",level:3},{value:"registerCharacterXMLPaths",id:"registercharacterxmlpaths",level:3},{value:"setAllowCharacterUpdate",id:"setallowcharacterupdate",level:3},{value:"setCharacterVisibility",id:"setcharactervisibility",level:3},{value:"setDirty",id:"setdirty",level:3},{value:"setIKChainPoseByTarget",id:"setikchainposebytarget",level:3},{value:"setIKChainTargets",id:"setikchaintargets",level:3},{value:"setSpineDirty",id:"setspinedirty",level:3},{value:"unloadCharacter",id:"unloadcharacter",level:3},{value:"update",id:"update",level:3},{value:"updateIKChains",id:"updateikchains",level:3},{value:"updateVisibility",id:"updatevisibility",level:3}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"vehiclecharacter",children:"VehicleCharacter"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"Copyright (C) GIANTS Software GmbH, Confidential, All Rights Reserved."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Functions"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#characterloaded",children:"characterLoaded"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#delete",children:"delete"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#getallowcharacterupdate",children:"getAllowCharacterUpdate"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#getikchaintargets",children:"getIKChainTargets"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#getparentcomponent",children:"getParentComponent"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#getplayerstyle",children:"getPlayerStyle"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#load",children:"load"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#loadcharacter",children:"loadCharacter"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#new",children:"new"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#registercharacterxmlpaths",children:"registerCharacterXMLPaths"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#setallowcharacterupdate",children:"setAllowCharacterUpdate"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#setcharactervisibility",children:"setCharacterVisibility"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#setdirty",children:"setDirty"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#setikchainposebytarget",children:"setIKChainPoseByTarget"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#setikchaintargets",children:"setIKChainTargets"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#setspinedirty",children:"setSpineDirty"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#unloadcharacter",children:"unloadCharacter"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#update",children:"update"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#updateikchains",children:"updateIKChains"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#updatevisibility",children:"updateVisibility"})}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"characterloaded",children:"characterLoaded"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"characterLoaded()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"loadingState"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"arguments"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function VehicleCharacter:characterLoaded(loadingState, arguments)\n    if loadingState = = HumanModelLoadingState.OK then\n        -- Model was unloaded before finishing loading\n        if self.playerModel.rootNode = = nil then\n            return\n        end\n\n        self.isStyleLoaded = false\n\n        -- Link to the vehicle\n        local linkNode = Utils.getNoNil( self.characterNode, self.vehicle.rootNode)\n        link(linkNode, self.playerModel.rootNode)\n\n        -- Update IK\n        for ikChainId, target in pairs( self.ikChainTargets) do\n            IKUtil.setTarget( self.playerModel:getIKChains(), ikChainId, target)\n        end\n\n        if self.playerModel.thirdPersonHipsNode ~ = nil then\n            local x, y, z = VehicleCharacter.SPINE_ROTATION[ 1 ], VehicleCharacter.SPINE_ROTATION[ 2 ], VehicleCharacter.SPINE_ROTATION[ 3 ]\n            if self.characterSpineRotationOffset ~ = nil then\n                x, y, z = self.characterSpineRotationOffset[ 1 ] + x, self.characterSpineRotationOffset[ 2 ] + y, self.characterSpineRotationOffset[ 3 ] + z\n            end\n\n            setRotation( self.playerModel.thirdPersonHipsNode, x, y, z)\n        end\n\n        self.characterDistanceRefNode = self.characterDistanceRefNodeCustom or self.playerModel.thirdPersonHeadNode\n\n        if self.playerModel.skeleton ~ = nil and getNumOfChildren( self.playerModel.skeleton) > 0 then\n            if self.useAnimation then\n                local skeleton = self.playerModel.skeleton\n                local animNode = g_animCache:getNode(AnimationCache.CHARACTER)\n                cloneAnimCharacterSet(getChildAt(animNode, 0 ), skeleton)\n                self.animationCharsetId = getAnimCharacterSet(getChildAt(skeleton, 0 ))\n                local animationPlayer = createConditionalAnimation()\n                if animationPlayer ~ = 0 then\n                    self.animationPlayer = animationPlayer\n                end\n\n                -- for i = 0, getAnimNumOfClips(self.animationCharsetId)-1 do\n                    -- print(getAnimClipName(self.animationCharsetId, i))\n                    -- end\n\n                    if self.animationCharsetId = = 0 then\n                        self.animationCharsetId = nil\n                        Logging.devError( "-- [VehicleCharacter:loadCharacter] Could not load animation CharSet from: [%s/%s]" , getName(getParent(skeleton)), getName(skeleton))\n                        printScenegraph(getParent(skeleton))\n                    end\n                elseif self.useIdleAnimation then\n                        local skeleton = self.playerModel.skeleton\n                        local animNode = g_animCache:getNode(AnimationCache.VEHICLE_CHARACTER)\n                        cloneAnimCharacterSet(getChildAt(animNode, 0 ), skeleton)\n                        self.animationCharsetId = getAnimCharacterSet(skeleton)\n                        if self.animationCharsetId ~ = 0 then\n                            self.idleClipIndex = getAnimClipIndex( self.animationCharsetId, "idle1Source" )\n                            clearAnimTrackClip( self.animationCharsetId, 0 )\n                            assignAnimTrackClip( self.animationCharsetId, 0 , self.idleClipIndex)\n                            setAnimTrackLoopState( self.animationCharsetId, 0 , true )\n\n                            self.idleAnimationState = false\n                        else\n                                self.useIdleAnimation = false\n                                self.animationCharsetId = nil\n                                Logging.devError( "-- [VehicleCharacter:loadCharacter] Could not load animation CharSet from: [%s/%s]" , getName(getParent(skeleton)), getName(skeleton))\n                            end\n                        end\n                    end\n\n                    local playerStyle = arguments.playerStyle\n                    self.playerModel:loadFromStyleAsync(playerStyle, function (target, loadingState, args)\n                        if loadingState = = HumanModelLoadingState.OK then\n                            self.isStyleLoaded = true\n                            self:setDirty( true )\n                            self:setCharacterVisibility( self.isVisible)\n                        end\n                    end , nil , nil )\n                else\n                        self.playerModel:delete()\n                        self.playerModel = nil\n\n                        Logging.error( "Failed to load vehicleCharacter" )\n                    end\n\n                    local asyncCallbackObject = arguments.asyncCallbackObject\n                    local asyncCallbackFunction = arguments.asyncCallbackFunction\n                    local asyncCallbackArguments = arguments.asyncCallbackArguments\n\n                    if asyncCallbackFunction ~ = nil then\n                        asyncCallbackFunction(asyncCallbackObject, loadingState, asyncCallbackArguments)\n                    end\n                end\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"delete",children:"delete"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"delete()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:delete()\n    self:unloadCharacter()\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"getallowcharacterupdate",children:"getAllowCharacterUpdate"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"getAllowCharacterUpdate()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:getAllowCharacterUpdate()\n    return self.allowUpdate\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"getikchaintargets",children:"getIKChainTargets"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"getIKChainTargets()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:getIKChainTargets()\n    return self.ikChainTargets\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"getparentcomponent",children:"getParentComponent"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"getParentComponent()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:getParentComponent()\n    return self.parentComponent\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"getplayerstyle",children:"getPlayerStyle"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"getPlayerStyle()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:getPlayerStyle()\n    if self.playerModel ~ = nil then\n        return self.playerModel.style\n    end\n\n    return nil\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"load",children:"load"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"load()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"xmlFile"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"xmlNode"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function VehicleCharacter:load(xmlFile, xmlNode)\n    XMLUtil.checkDeprecatedXMLElements(xmlFile, xmlNode .. "#index" , xmlNode .. "#node" ) --FS17 to FS19\n\n    self.characterNode = xmlFile:getValue(xmlNode .. "#node" , nil , self.vehicle.components, self.vehicle.i3dMappings)\n    if self.characterNode ~ = nil then\n        self.parentComponent = self.vehicle:getParentComponent( self.characterNode)\n        self.characterCameraMinDistance = xmlFile:getValue(xmlNode .. "#cameraMinDistance" , 1.5 )\n        self.characterDistanceRefNodeCustom = xmlFile:getValue(xmlNode .. "#distanceRefNode" , nil , self.vehicle.components, self.vehicle.i3dMappings)\n        self.characterDistanceRefNode = self.characterDistanceRefNodeCustom or self.characterNode\n        setVisibility( self.characterNode, false )\n        self.useAnimation = xmlFile:getValue(xmlNode .. "#useAnimation" , false )\n        self.useIdleAnimation = xmlFile:getValue(xmlNode .. "#useIdleAnimation" , not self.useAnimation and Platform.gameplay.hasVehicleCharacterIdleAnimations)\n\n        if not self.useAnimation then\n            self.ikChainTargets = { }\n            IKUtil.loadIKChainTargets(xmlFile, xmlNode, self.vehicle.components, self.ikChainTargets, self.vehicle.i3dMappings)\n        end\n        self.characterSpineRotationOffset = xmlFile:getValue(xmlNode .. "#spineRotationOffset" , nil , true )\n        self.characterSpineSpeedDepended = xmlFile:getValue(xmlNode .. "#speedDependedSpine" , false )\n        self.characterSpineNodeMinRot = xmlFile:getValue(xmlNode .. "#spineNodeMinRot" , 10 )\n        self.characterSpineNodeMaxRot = xmlFile:getValue(xmlNode .. "#spineNodeMaxRot" , - 10 )\n        self.characterSpineNodeMinAcc = xmlFile:getValue(xmlNode .. "#spineNodeMinAcc" , - 1 ) / ( 1000 * 1000 )\n        self.characterSpineNodeMaxAcc = xmlFile:getValue(xmlNode .. "#spineNodeMaxAcc" , 1 ) / ( 1000 * 1000 )\n        self.characterSpineNodeAccDeadZone = xmlFile:getValue(xmlNode .. "#spineNodeAccDeadZone" , 0.2 ) / ( 1000 * 1000 )\n        self.characterSpineLastRotation = 0\n        self:setCharacterVisibility( self.isVisible)\n\n        self.maxUpdateDistance = xmlFile:getValue(xmlNode .. "#maxUpdateDistance" , VehicleCharacter.DEFAULT_MAX_UPDATE_DISTANCE)\n        setClipDistance( self.characterNode, xmlFile:getValue(xmlNode .. "#clipDistance" , VehicleCharacter.DEFAULT_CLIP_DISTANCE))\n\n        return true\n    end\n    return false\nend\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"loadcharacter",children:"loadCharacter"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"loadCharacter()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"playerStyle"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"asyncCallbackObject"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"asyncCallbackFunction"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"asyncCallbackArguments"})]})]})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:loadCharacter(playerStyle, asyncCallbackObject, asyncCallbackFunction, asyncCallbackArguments)\n    if playerStyle = = nil then\n        asyncCallbackFunction(asyncCallbackObject, false , asyncCallbackArguments)\n        return\n    end\n\n    if self.playerModel ~ = nil then\n        self.playerModel:delete()\n    end\n\n    self.playerModel = HumanModel.new()\n\n    local arguments = {\n    asyncCallbackObject = asyncCallbackObject,\n    asyncCallbackFunction = asyncCallbackFunction,\n    asyncCallbackArguments = asyncCallbackArguments,\n    playerStyle = playerStyle\n    }\n    self.playerModel:load(playerStyle.xmlFilename, false , false , self.useAnimation, self.characterLoaded, self , arguments)\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"new",children:"new"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"new()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"vehicle"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"customMt"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter.new(vehicle, customMt)\n    local self = setmetatable( { } , customMt or VehicleCharacter _mt)\n\n    self.vehicle = vehicle\n    self.characterNode = nil\n    self.allowUpdate = true\n    self.ikChainTargets = { }\n    self.animationCharsetId = nil\n    self.animationPlayer = nil\n    self.useAnimation = false\n    self.isVisible = false\n\n    return self\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"registercharacterxmlpaths",children:"registerCharacterXMLPaths"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"registerCharacterXMLPaths()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"schema"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"basePath"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"name"})]})]})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function VehicleCharacter.registerCharacterXMLPaths(schema, basePath, name)\n    schema:register(XMLValueType.NODE_INDEX, basePath .. "#node" , "Character root node" )\n    schema:register(XMLValueType.FLOAT, basePath .. "#cameraMinDistance" , "Min.distance until character is hidden" , 1.5 )\n    schema:register(XMLValueType.NODE_INDEX, basePath .. "#distanceRefNode" , "Distance reference node" , "Character root node" )\n    schema:register(XMLValueType.BOOL, basePath .. "#useAnimation" , "Use animation instead of ik chains" , false )\n    schema:register(XMLValueType.BOOL, basePath .. "#useIdleAnimation" , "Apply character idle animation additionally to ik chain control" , "set if #useAnimation not set" )\n\n        schema:register(XMLValueType.VECTOR_ROT, basePath .. "#spineRotationOffset" , "Spine rotation offset" )\n        schema:register(XMLValueType.BOOL, basePath .. "#speedDependedSpine" , "Speed dependent spine" , false )\n        schema:register(XMLValueType.ANGLE, basePath .. "#spineNodeMinRot" , "Spine node min.rotation" , 10 )\n        schema:register(XMLValueType.ANGLE, basePath .. "#spineNodeMaxRot" , "Spine node max.rotation" , - 10 )\n        schema:register(XMLValueType.FLOAT, basePath .. "#spineNodeMinAcc" , "Spine node min.acceleration" , - 1 )\n        schema:register(XMLValueType.FLOAT, basePath .. "#spineNodeMaxAcc" , "Spine node max.acceleration" , 1 )\n        schema:register(XMLValueType.FLOAT, basePath .. "#spineNodeAccDeadZone" , "Spine node acceleration dead zone" , 0.2 )\n\n        schema:register(XMLValueType.FLOAT, basePath .. "#maxUpdateDistance" , "Max.distance to vehicle root to update ik chains of character" , VehicleCharacter.DEFAULT_MAX_UPDATE_DISTANCE)\n        schema:register(XMLValueType.FLOAT, basePath .. "#clipDistance" , "Clip distance of character" , VehicleCharacter.DEFAULT_CLIP_DISTANCE)\n\n        IKUtil.registerIKChainTargetsXMLPaths(schema, basePath)\n    end\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"setallowcharacterupdate",children:"setAllowCharacterUpdate"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"setAllowCharacterUpdate()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"state"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:setAllowCharacterUpdate(state)\n    self.allowUpdate = state\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"setcharactervisibility",children:"setCharacterVisibility"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"setCharacterVisibility()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"isVisible"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:setCharacterVisibility(isVisible)\n    if self.characterNode ~ = nil then\n        setVisibility( self.characterNode, isVisible)\n    end\n    if self.playerModel ~ = nil and self.playerModel.isLoaded then\n        self.playerModel:setVisibility(isVisible)\n    end\n\n    self.isVisible = isVisible\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"setdirty",children:"setDirty"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"setDirty()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"setAllDirty"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:setDirty(setAllDirty)\n    if self.playerModel ~ = nil then\n        for chainId, target in pairs( self.ikChainTargets) do\n            if target.setDirty or setAllDirty then\n                IKUtil.setIKChainDirty( self.playerModel:getIKChains(), chainId)\n            end\n        end\n    end\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"setikchainposebytarget",children:"setIKChainPoseByTarget"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"setIKChainPoseByTarget()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"target"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"poseId"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:setIKChainPoseByTarget(target, poseId)\n    if self.playerModel ~ = nil then\n        local ikChains = self.playerModel:getIKChains()\n\n        local chain = IKUtil.getIKChainByTarget(ikChains, target)\n        if chain ~ = nil then\n            IKUtil.setIKChainPose(ikChains, chain.id, poseId)\n        end\n    end\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"setikchaintargets",children:"setIKChainTargets"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"setIKChainTargets()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"targets"})]})}),(0,a.jsx)(n.tbody,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"any"}),(0,a.jsx)(n.td,{children:"force"})]})})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:setIKChainTargets(targets, force)\n    if self.ikChainTargets ~ = targets or force then\n        self.ikChainTargets = targets\n\n        if self.playerModel ~ = nil then\n            for ikChainId, target in pairs( self.ikChainTargets) do\n                IKUtil.setTarget( self.playerModel:getIKChains(), ikChainId, target)\n            end\n            self:setDirty( true )\n        end\n    end\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"setspinedirty",children:"setSpineDirty"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"setSpineDirty()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"acc"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:setSpineDirty(acc)\n    if math.abs(acc) < self.characterSpineNodeAccDeadZone then\n        acc = 0\n    end\n    local alpha = math.clamp((acc - self.characterSpineNodeMinAcc) / ( self.characterSpineNodeMaxAcc - self.characterSpineNodeMinAcc), 0 , 1 )\n    local rotation = MathUtil.lerp( self.characterSpineNodeMinRot, self.characterSpineNodeMaxRot, alpha)\n    if rotation ~ = self.characterSpineLastRotation then\n        self.characterSpineLastRotation = self.characterSpineLastRotation * 0.95 + rotation * 0.05\n        setRotation( self.player.spineNode, self.characterSpineLastRotation, 0 , 0 )\n        self:setDirty()\n    end\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"unloadcharacter",children:"unloadCharacter"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"unloadCharacter()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:unloadCharacter()\n    if self.playerModel ~ = nil then\n        self.characterDistanceRefNode = self.characterDistanceRefNodeCustom or self.characterNode\n\n        self.playerModel:delete()\n        self.playerModel = nil\n\n        if self.animationPlayer ~ = nil then\n            delete( self.animationPlayer)\n            self.animationPlayer = nil\n        end\n\n    end\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"update",children:"update"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"update()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,a.jsx)(n.table,{children:(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"any"}),(0,a.jsx)(n.th,{children:"dt"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function VehicleCharacter:update(dt)\n    --#profile RemoteProfiler.zoneBeginN("VehicleCharacter:update")\n    if self.playerModel ~ = nil and self.playerModel.isLoaded then\n\n        if Platform.gameplay.allowVehicleCharacterIKDirtyUpdate then\n            if self.vehicle.currentUpdateDistance < self.maxUpdateDistance and self.isVisible then\n                if self:getAllowCharacterUpdate() then\n                    self:setDirty( false )\n                end\n\n                self:updateIKChains()\n            end\n        end\n\n        if self.useIdleAnimation then\n            if self.vehicle.currentUpdateDistance < self.maxUpdateDistance then\n                if not self.idleAnimationState then\n                    self.idleAnimationState = true\n                    enableAnimTrack( self.animationCharsetId, 0 )\n                end\n            else\n                    if self.idleAnimationState then\n                        self.idleAnimationState = false\n                        disableAnimTrack( self.animationCharsetId, 0 )\n                    end\n                end\n            end\n        end\n        --#profile RemoteProfiler.zoneEnd()\n    end\n\n'})}),"\n",(0,a.jsx)(n.h3,{id:"updateikchains",children:"updateIKChains"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"updateIKChains()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:"function VehicleCharacter:updateIKChains()\n    IKUtil.updateIKChains( self.playerModel:getIKChains(), true )\nend\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"updatevisibility",children:"updateVisibility"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Description"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Definition"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"updateVisibility()"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Code"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function VehicleCharacter:updateVisibility()\n    --#profile RemoteProfiler.zoneBeginN("VehicleCharacter:updateVisibility")\n    if self.isStyleLoaded and entityExists( self.characterDistanceRefNode) and entityExists(g_cameraManager:getActiveCamera()) then\n        local dist = calcDistanceFrom( self.characterDistanceRefNode, g_cameraManager:getActiveCamera())\n        local visible = dist > = self.characterCameraMinDistance\n        self:setCharacterVisibility(visible)\n    end\n    --#profile RemoteProfiler.zoneEnd()\nend\n\n'})})]})}function o(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}}}]);