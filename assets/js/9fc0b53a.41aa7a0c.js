"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[72416],{28453(n,e,i){i.d(e,{R:()=>l,x:()=>r});var d=i(96540);const s={},t=d.createContext(s);function l(n){const e=d.useContext(t);return d.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),d.createElement(t.Provider,{value:e},n.children)}},52582(n,e,i){i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>d,toc:()=>c});const d=JSON.parse('{"id":"script/Specializations/WindBending","title":"WindBending","description":"WindBending","source":"@site/../docs/script/Specializations/WindBending.md","sourceDirName":"script/Specializations","slug":"/script/Specializations/WindBending","permalink":"/FS25-Community-LUADOC/script/Specializations/WindBending","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Wheels","permalink":"/FS25-Community-LUADOC/script/Specializations/Wheels"},"next":{"title":"Windrower","permalink":"/FS25-Community-LUADOC/script/Specializations/Windrower"}}');var s=i(74848),t=i(28453);const l={},r=void 0,o={},c=[{value:"WindBending",id:"windbending",level:2},{value:"initSpecialization",id:"initspecialization",level:3},{value:"onLoad",id:"onload",level:3},{value:"onUpdate",id:"onupdate",level:3},{value:"prerequisitesPresent",id:"prerequisitespresent",level:3},{value:"registerEventListeners",id:"registereventlisteners",level:3},{value:"registerFunctions",id:"registerfunctions",level:3}];function a(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h2,{id:"windbending",children:"WindBending"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Specialization for controlling wind bending nodes"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Functions"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#initspecialization",children:"initSpecialization"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#onload",children:"onLoad"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#onupdate",children:"onUpdate"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#prerequisitespresent",children:"prerequisitesPresent"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#registereventlisteners",children:"registerEventListeners"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"#registerfunctions",children:"registerFunctions"})}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"initspecialization",children:"initSpecialization"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"initSpecialization()"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:'function WindBending.initSpecialization()\n    local schema = Vehicle.xmlSchema\n    schema:setXMLSpecializationType( "WindBending" )\n\n    schema:register(XMLValueType.NODE_INDEX, "vehicle.windBending.windBendingNodes.windBendingNode(?)#node" , "Shader node" )\n    schema:register(XMLValueType.NODE_INDEX, "vehicle.windBending.windBendingNodes.windBendingNode(?)#decalNode" , "Extra node that gets the exact same shader parameters" )\n    schema:register(XMLValueType.NODE_INDEX, "vehicle.windBending.windBendingNodes.windBendingNode(?)#speedReferenceNode" , "Reference node to calculate speed of wind" )\n    schema:register(XMLValueType.FLOAT, "vehicle.windBending.windBendingNodes.windBendingNode(?)#maxBending" , "Bending in meters" , 0.15 )\n    schema:register(XMLValueType.FLOAT, "vehicle.windBending.windBendingNodes.windBendingNode(?)#maxBendingNeg" , "Negative bending in meters(used if the vehicle drives in reverse)" , "same as #maxBending" )\n        schema:register(XMLValueType.FLOAT, "vehicle.windBending.windBendingNodes.windBendingNode(?)#maxBendingSpeed" , "Speed at which max bending state is reached in kmph" , 20 )\n\n        schema:setXMLSpecializationType()\n    end\n\n'})}),"\n",(0,s.jsx)(e.h3,{id:"onload",children:"onLoad"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Called on loading"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"onLoad(table savegame)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(e.table,{children:(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"table"}),(0,s.jsx)(e.th,{children:"savegame"}),(0,s.jsx)(e.th,{children:"savegame"})]})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:'function WindBending:onLoad(savegame)\n    local spec = self.spec_windBending\n\n    if self.isClient then\n        spec.windBending = { }\n\n        self.xmlFile:iterate( "vehicle.windBending.windBendingNodes.windBendingNode" , function (_, key)\n            local entry = { }\n            entry.node = self.xmlFile:getValue(key .. "#node" , nil , self.components, self.i3dMappings)\n            if entry.node ~ = nil then\n                if getHasClassId(entry.node, ClassIds.SHAPE) and getHasShaderParameter(entry.node, "directionBend" ) then\n                    entry.speedReferenceNode = self.xmlFile:getValue(key .. "#speedReferenceNode" , entry.node, self.components, self.i3dMappings)\n                    entry.parentComponent = self:getParentComponent(entry.speedReferenceNode)\n\n                    entry.maxBending = self.xmlFile:getValue(key .. "#maxBending" , 0.15 )\n                    entry.maxBendingNeg = self.xmlFile:getValue(key .. "#maxBendingNeg" , entry.maxBending)\n                    entry.maxBendingSpeed = self.xmlFile:getValue(key .. "#maxBendingSpeed" , 20 )\n\n                    entry.decalNode = self.xmlFile:getValue(key .. "#decalNode" , nil , self.components, self.i3dMappings)\n\n                    entry.lastPosition = nil\n\n                    table.insert(spec.windBending, entry)\n                else\n                        Logging.xmlError( self.xmlFile, "Unable to load wind bending node from xml.Node has not shader parameter \'directionBend\'. \'%s\'" , key)\n                    end\n                else\n                        Logging.xmlError( self.xmlFile, "Unable to load wind bending node from xml.Node not found. \'%s\'" , key)\n                    end\n                end )\n            end\n\n            if not self.isClient or #spec.windBending = = 0 then\n                SpecializationUtil.removeEventListener( self , "onUpdate" , WindBending )\n            end\n        end\n\n'})}),"\n",(0,s.jsx)(e.h3,{id:"onupdate",children:"onUpdate"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Called on update"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"onUpdate(float dt, boolean isActiveForInput, boolean isSelected, )"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"float"}),(0,s.jsx)(e.th,{children:"dt"}),(0,s.jsx)(e.th,{children:"time since last call in ms"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"boolean"}),(0,s.jsx)(e.td,{children:"isActiveForInput"}),(0,s.jsx)(e.td,{children:"true if vehicle is active for input"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"boolean"}),(0,s.jsx)(e.td,{children:"isSelected"}),(0,s.jsx)(e.td,{children:"true if vehicle is selected"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"any"}),(0,s.jsx)(e.td,{children:"isSelected"}),(0,s.jsx)(e.td,{})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:'function WindBending:onUpdate(dt, isActiveForInput, isActiveForInputIgnoreSelection, isSelected)\n    local spec = self.spec_windBending\n\n    local lastSpeed = self:getLastSpeed()\n    for i = 1 , #spec.windBending do\n        local windBendingNode = spec.windBending[i]\n\n        local x, y, z = localToWorld(windBendingNode.speedReferenceNode, 0 , 0 , 0 )\n        if windBendingNode.lastPosition = = nil then\n            windBendingNode.lastPosition = { x, y, z }\n        end\n\n        local vx = (x - windBendingNode.lastPosition[ 1 ]) * 10\n        local vy = (y - windBendingNode.lastPosition[ 2 ]) * 10\n        local vz = (z - windBendingNode.lastPosition[ 3 ]) * 10\n\n        if vx ~ = 0 or vy ~ = 0 or vz ~ = 0 then\n            vx, vy, vz = worldDirectionToLocal(getParent(windBendingNode.node), vx, vy, vz)\n            vx, vy, vz = MathUtil.vector3Normalize(vx, vy, vz)\n\n            local maxBending = self.movingDirection > = 0 and windBendingNode.maxBending or windBendingNode.maxBendingNeg\n            local bendingAmount = maxBending * (lastSpeed / windBendingNode.maxBendingSpeed)\n            g_animationManager:setPrevShaderParameter(windBendingNode.node, "directionBend" , vx, vy, vz, bendingAmount, false , "prevDirectionBend" )\n\n            if windBendingNode.decalNode ~ = nil then\n                g_animationManager:setPrevShaderParameter(windBendingNode.decalNode, "directionBend" , vx, vy, vz, bendingAmount, false , "prevDirectionBend" )\n            end\n        end\n\n        windBendingNode.lastPosition[ 1 ] = x\n        windBendingNode.lastPosition[ 2 ] = y\n        windBendingNode.lastPosition[ 3 ] = z\n    end\nend\n\n'})}),"\n",(0,s.jsx)(e.h3,{id:"prerequisitespresent",children:"prerequisitesPresent"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Checks if all prerequisite specializations are loaded"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"prerequisitesPresent(table specializations)"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(e.table,{children:(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"table"}),(0,s.jsx)(e.th,{children:"specializations"}),(0,s.jsx)(e.th,{children:"specializations"})]})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,s.jsx)(e.table,{children:(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"table"}),(0,s.jsx)(e.th,{children:"hasPrerequisite"}),(0,s.jsx)(e.th,{children:"true if all prerequisite specializations are loaded"})]})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function WindBending.prerequisitesPresent(specializations)\n    return true\nend\n\n"})}),"\n",(0,s.jsx)(e.h3,{id:"registereventlisteners",children:"registerEventListeners"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"registerEventListeners()"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(e.table,{children:(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"any"}),(0,s.jsx)(e.th,{children:"vehicleType"})]})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:'function WindBending.registerEventListeners(vehicleType)\n    SpecializationUtil.registerEventListener(vehicleType, "onLoad" , WindBending )\n    SpecializationUtil.registerEventListener(vehicleType, "onUpdate" , WindBending )\nend\n\n'})}),"\n",(0,s.jsx)(e.h3,{id:"registerfunctions",children:"registerFunctions"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Description"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"registerFunctions()"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(e.table,{children:(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"any"}),(0,s.jsx)(e.th,{children:"vehicleType"})]})})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Code"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-lua",children:"function WindBending.registerFunctions(vehicleType)\nend\n\n"})})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}}}]);