"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[38368],{28453(e,n,t){t.d(n,{R:()=>a,x:()=>r});var s=t(96540);const i={},l=s.createContext(i);function a(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(l.Provider,{value:n},e.children)}},61468(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"script/Specializations/PlaceableConstructible","title":"PlaceableConstructible","description":"PlaceableConstructible","source":"@site/../docs/script/Specializations/PlaceableConstructible.md","sourceDirName":"script/Specializations","slug":"/script/Specializations/PlaceableConstructible","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableConstructible","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"PlaceableClearAreas","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableClearAreas"},"next":{"title":"PlaceableDeletedNodes","permalink":"/FS25-Community-LUADOC/script/Specializations/PlaceableDeletedNodes"}}');var i=t(74848),l=t(28453);const a={},r=void 0,c={},o=[{value:"PlaceableConstructible",id:"placeableconstructible",level:2},{value:"collectPickObjects",id:"collectpickobjects",level:3},{value:"loadFromXMLFile",id:"loadfromxmlfile",level:3},{value:"loadSpecValueFillTypes",id:"loadspecvaluefilltypes",level:3},{value:"onDelete",id:"ondelete",level:3},{value:"onFinalizePlacement",id:"onfinalizeplacement",level:3},{value:"onLoad",id:"onload",level:3},{value:"onReadStream",id:"onreadstream",level:3},{value:"onWriteStream",id:"onwritestream",level:3},{value:"prerequisitesPresent",id:"prerequisitespresent",level:3},{value:"registerEventListeners",id:"registereventlisteners",level:3},{value:"registerFunctions",id:"registerfunctions",level:3},{value:"registerOverwrittenFunctions",id:"registeroverwrittenfunctions",level:3},{value:"registerSavegameXMLPaths",id:"registersavegamexmlpaths",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"saveToXMLFile",id:"savetoxmlfile",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"placeableconstructible",children:"PlaceableConstructible"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Specialization for placeables"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Functions"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#collectpickobjects",children:"collectPickObjects"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#loadfromxmlfile",children:"loadFromXMLFile"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#loadspecvaluefilltypes",children:"loadSpecValueFillTypes"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#ondelete",children:"onDelete"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onfinalizeplacement",children:"onFinalizePlacement"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onload",children:"onLoad"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onreadstream",children:"onReadStream"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#onwritestream",children:"onWriteStream"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#prerequisitespresent",children:"prerequisitesPresent"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registereventlisteners",children:"registerEventListeners"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registerfunctions",children:"registerFunctions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registeroverwrittenfunctions",children:"registerOverwrittenFunctions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registersavegamexmlpaths",children:"registerSavegameXMLPaths"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#savetoxmlfile",children:"saveToXMLFile"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"collectpickobjects",children:"collectPickObjects"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"collectPickObjects()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"superFunc"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"node"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function PlaceableConstructible:collectPickObjects(superFunc, node)\n    local spec = self.spec_constructible\n\n    for i = 1 , #spec.unloadingStation.unloadTriggers do\n        local unloadTrigger = spec.unloadingStation.unloadTriggers[i]\n        if node = = unloadTrigger.exactFillRootNode then\n            return\n        end\n    end\n\n    superFunc( self , node)\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"loadfromxmlfile",children:"loadFromXMLFile"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"loadFromXMLFile()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"xmlFile"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"key"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible:loadFromXMLFile(xmlFile, key)\n    local spec = self.spec_constructible\n\n    local stateName = xmlFile:getValue(key .. ".state#name" )\n    spec.stateIndexPending = spec.stateNameToIndex[stateName] or 1\n\n    -- this needs to be delayed to avoid Placeable:finalize overwriting already disabled physics on nodes\n    spec.postFinalize = function ()\n        local state = spec.stateMachine[spec.stateIndexPending]\n        state:loadFromXMLFile(xmlFile, key)\n    end\n\n    spec.storage:loadFromXMLFile(xmlFile, key .. ".storage" )\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"loadspecvaluefilltypes",children:"loadSpecValueFillTypes"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"loadSpecValueFillTypes(XMLFile xmlFile, string? customEnvironment, string? baseDir, table? resultTable)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"XMLFile"}),(0,i.jsx)(n.th,{children:"xmlFile"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"string?"}),(0,i.jsx)(n.td,{children:"customEnvironment"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"string?"}),(0,i.jsx)(n.td,{children:"baseDir"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"table?"}),(0,i.jsx)(n.td,{children:"resultTable"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table?"}),(0,i.jsx)(n.th,{children:"fillTypeNames"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible.loadSpecValueFillTypes(xmlFile, customEnvironment, baseDir, resultTable)\n    if not xmlFile:hasProperty( "placeable.constructible" ) then\n        return resultTable\n    end\n\n    local fillTypeNames = resultTable or { }\n\n    for _, stateKey in xmlFile:iterator( "placeable.constructible.stateMachine.states.state" ) do\n        for _, inputKey in xmlFile:iterator(stateKey .. ".input" ) do\n            local fillTypeName = xmlFile:getString(inputKey .. "#fillType" )\n            fillTypeNames[fillTypeName] = true\n        end\n    end\n\n    return fillTypeNames\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"ondelete",children:"onDelete"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onDelete()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible:onDelete()\n    local spec = self.spec_constructible\n\n    removeConsoleCommand( "gsConstructibleFinishState" )\n\n    g_messageCenter:unsubscribeAll( self )\n\n    if spec.unloadingStation ~ = nil then\n        g_currentMission.storageSystem:removeUnloadingStation(spec.unloadingStation, self )\n        g_currentMission.economyManager:removeSellingStation(spec.unloadingStation)\n        spec.unloadingStation:delete()\n        spec.unloadingStation = nil\n    end\n\n    if spec.storage ~ = nil then\n        spec.storage:delete()\n        spec.storage = nil\n    end\n\n    if spec.stateMachine ~ = nil then\n        for _, state in ipairs(spec.stateMachine) do\n            state:delete()\n        end\n        spec.stateMachine = nil\n    end\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"onfinalizeplacement",children:"onFinalizePlacement"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onFinalizePlacement()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function PlaceableConstructible:onFinalizePlacement(savegame)\n    local spec = self.spec_constructible\n\n    local farmId = self:getOwnerFarmId()\n    if spec.unloadingStation ~ = nil then\n        spec.unloadingStation:setOwnerFarmId(farmId, true )\n    end\n    if spec.storage ~ = nil then\n        spec.storage:setOwnerFarmId(farmId, true )\n    end\n\n    if self.isServer then\n        -- do this after finalize placement as addToPhysics for whole placeable is called there\n            if spec.stateIndexPending ~ = nil then\n                for i = 1 , spec.stateIndexPending do\n                    self:setConstructibleState(i)\n                end\n\n                if spec.postFinalize ~ = nil then\n                    spec.postFinalize()\n                end\n\n                spec.stateIndexPending = nil\n                spec.postFinalize = nil\n            else\n                    self:setConstructibleState(spec.startStateIndex)\n                end\n\n                self:raiseActive()\n            end\n        end\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"onload",children:"onLoad"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Called on loading"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onLoad(table savegame)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table"}),(0,i.jsx)(n.th,{children:"savegame"}),(0,i.jsx)(n.th,{children:"savegame"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible:onLoad(savegame)\n    local spec = self.spec_constructible\n\n    spec.unloadingStation = SellingStation.new( self.isServer, self.isClient)\n    spec.unloadingStation:load( self.components, self.xmlFile, "placeable.constructible.sellingStation" , self.customEnvironment, self.i3dMappings, self.components[ 1 ].node)\n    spec.unloadingStation.owningPlaceable = self\n    spec.unloadingStation.getStoreGoods = function (_, farmId, fillTypeIndex)\n        return true\n    end\n    spec.unloadingStation.getSkipSell = function (_, farmId, fillTypeIndex)\n        -- owned by a farm\n        local ownerFarmId = self:getOwnerFarmId()\n        if ownerFarmId ~ = AccessHandler.EVERYONE then\n            return true\n        end\n\n        return false\n    end\n    spec.unloadingStation:register( true )\n\n    spec.storage = Storage.new( self.isServer, self.isClient)\n    spec.storage:load( self.components, self.xmlFile, "placeable.constructible.storage" , self.i3dMappings, self.baseDirectory)\n    spec.storage:register( true )\n    spec.storage:addFillLevelChangedListeners( function () self:raiseActive() end ) -- trigger update loop after storage was changed\n    spec.fillTypesAndLevelsAuxiliary = { }\n    spec.fillTypeToFillTypeStorageTable = { }\n    spec.infoTriggerFillTypesAndLevels = { }\n\n    spec.infoTableEntryStorage = {\n    title = g_i18n:getText( "statistic_storage" ),\n    accentuate = true\n    }\n\n    spec.unloadingStation:addTargetStorage(spec.storage)\n\n    g_currentMission.storageSystem:addUnloadingStation(spec.unloadingStation, self )\n    g_currentMission.economyManager:addSellingStation(spec.unloadingStation)\n\n    -- load statemachine after animation so it can be passed for initialization\n        spec.stateMachine = { }\n        spec.stateNameToIndex = { }\n        spec.stateTransitions = { }\n        spec.stateIndex = - 1\n        spec.startStateIndex = 1\n        spec.previewStateIndex = 1\n\n        spec.statesDirtyMask = 0 -- dirty mask for all state dirty flags to easily check if a state needs updating\n            local maxNumStates = ( 2 ^ 8 ) - 1\n            local dirtyFlags = { }\n            local maxNumDirtyFlags = 10\n            local stateMachineNextIndex = 1\n            for _, stateKey in self.xmlFile:iterator( "placeable.constructible.stateMachine.states.state" ) do\n                if stateMachineNextIndex > maxNumStates then\n                    Logging.xmlWarning( self.xmlFile, "Maximum number of states reached(%d)" , maxNumStates)\n                    break\n                end\n\n                local stateName = string.upper( self.xmlFile:getValue(stateKey .. "#name" , "" ))\n                if spec.stateNameToIndex[stateName] ~ = nil then\n                    Logging.xmlError( self.xmlFile, "State \'%s\' already defined" , stateName, stateKey)\n                    break\n                end\n\n                local stateClassName = self.xmlFile:getValue(stateKey .. "#class" , "" )\n                local class = ClassUtil.getClassObject(stateClassName)\n                if class = = nil then\n                    Logging.xmlError( self.xmlFile, "State class \'%s\' at \'%s\' not defined" , stateClassName, stateKey)\n                    break\n                end\n\n                if not class:isa(ConstructibleState) then\n                    Logging.xmlError( self.xmlFile, "State class \'%s\' is not a ConstructibleState at \'%s\'" , stateClassName, stateKey)\n                    break\n                end\n\n                if #dirtyFlags < maxNumDirtyFlags then\n                    table.insert(dirtyFlags, self:getNextDirtyFlag())\n                end\n\n                local stateIndex = stateMachineNextIndex\n                spec.stateNameToIndex[stateName] = stateIndex\n\n                -- wrap around dirty flags to avoid using too many flags\n                local dirtyFlagIndex = ((stateMachineNextIndex - 1 ) % maxNumDirtyFlags) + 1\n                local dirtyFlag = dirtyFlags[dirtyFlagIndex]\n\n                local state = class.new( self , dirtyFlag)\n                state:load( self.xmlFile, stateKey)\n                spec.stateMachine[stateIndex] = state\n                spec.statesDirtyMask = bit32.bor(spec.statesDirtyMask, dirtyFlag) -- accumulate all flags from states to one mask\n\n                if self.xmlFile:getValue(stateKey .. "#isStartState" ) then\n                    spec.startStateIndex = stateIndex\n                end\n\n                if self.xmlFile:getValue(stateKey .. "#isPreviewState" ) then\n                    spec.previewStateIndex = stateIndex\n                end\n\n                stateMachineNextIndex = stateMachineNextIndex + 1\n            end\n\n            for _, transitionKey in self.xmlFile:iterator( "placeable.constructible.stateMachine.transitions.transition" ) do\n                local stateFromName = string.upper( self.xmlFile:getValue(transitionKey .. "#from" , "" ))\n                local stateFromIndex = spec.stateNameToIndex[stateFromName]\n                if stateFromIndex = = nil then\n                    Logging.xmlError( self.xmlFile, "Invalid state.Transition from name \'%s\' not defined for \'%s\'" , stateFromName, transitionKey)\n                        break\n                    end\n\n                    local stateToName = string.upper( self.xmlFile:getValue(transitionKey .. "#to" , "" ))\n                    local stateToIndex = spec.stateNameToIndex[stateToName]\n                    if stateToIndex = = nil then\n                        Logging.xmlError( self.xmlFile, "Invalid state.Transition to name \'%s\' not defined for \'%s\'" , stateToName, transitionKey)\n                            break\n                        end\n\n                        spec.stateTransitions[stateFromIndex] = stateToIndex\n                    end\n\n                    -- ensure setup state is applied in preview, e.g.that things are hidden\n                    if self.propertyState = = PlaceablePropertyState.CONSTRUCTION_PREVIEW then\n                        self:setConstructiblePreviewState()\n                    end\n                end\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"onreadstream",children:"onReadStream"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onReadStream()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"streamId"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"connection"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function PlaceableConstructible:onReadStream(streamId, connection)\n    local spec = self.spec_constructible\n\n    -- unloading station\n    local unloadingStationId = NetworkUtil.readNodeObjectId(streamId)\n    spec.unloadingStation:readStream(streamId, connection)\n    g_client:finishRegisterObject(spec.unloadingStation, unloadingStationId)\n\n    -- storage\n    local storageId = NetworkUtil.readNodeObjectId(streamId)\n    spec.storage:readStream(streamId, connection)\n    g_client:finishRegisterObject(spec.storage, storageId)\n\n    -- state\n    local stateIndex = streamReadUInt8(streamId)\n    for i = 1 , stateIndex do\n        self:setConstructibleState(i)\n    end\n\n    local state = spec.stateMachine[stateIndex]\n    state:onReadStream(streamId, connection)\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"onwritestream",children:"onWriteStream"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"onWriteStream()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"streamId"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"connection"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function PlaceableConstructible:onWriteStream(streamId, connection)\n    local spec = self.spec_constructible\n\n    -- unloading station\n    NetworkUtil.writeNodeObjectId(streamId, NetworkUtil.getObjectId(spec.unloadingStation))\n    spec.unloadingStation:writeStream(streamId, connection)\n    g_server:registerObjectInStream(connection, spec.unloadingStation)\n\n    -- storage\n    NetworkUtil.writeNodeObjectId(streamId, NetworkUtil.getObjectId(spec.storage))\n    spec.storage:writeStream(streamId, connection)\n    g_server:registerObjectInStream(connection, spec.storage)\n\n    -- state\n    streamWriteUInt8(streamId, spec.stateIndex)\n    local state = spec.stateMachine[spec.stateIndex]\n    state:onWriteStream(streamId, connection)\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"prerequisitespresent",children:"prerequisitesPresent"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Checks if all prerequisite specializations are loaded"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"prerequisitesPresent(table specializations)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table"}),(0,i.jsx)(n.th,{children:"specializations"}),(0,i.jsx)(n.th,{children:"specializations"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Return Values"})}),"\n\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"table"}),(0,i.jsx)(n.th,{children:"hasPrerequisite"}),(0,i.jsx)(n.th,{children:"true if all prerequisite specializations are loaded"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:"function PlaceableConstructible.prerequisitesPresent(specializations)\n    return true\nend\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"registereventlisteners",children:"registerEventListeners"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerEventListeners()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible.registerEventListeners(placeableType)\n    SpecializationUtil.registerEventListener(placeableType, "onLoad" , PlaceableConstructible )\n    SpecializationUtil.registerEventListener(placeableType, "onFinalizePlacement" , PlaceableConstructible )\n    SpecializationUtil.registerEventListener(placeableType, "onDelete" , PlaceableConstructible )\n    SpecializationUtil.registerEventListener(placeableType, "onUpdate" , PlaceableConstructible )\n    SpecializationUtil.registerEventListener(placeableType, "onReadStream" , PlaceableConstructible )\n    SpecializationUtil.registerEventListener(placeableType, "onWriteStream" , PlaceableConstructible )\n    SpecializationUtil.registerEventListener(placeableType, "onReadUpdateStream" , PlaceableConstructible )\n    SpecializationUtil.registerEventListener(placeableType, "onWriteUpdateStream" , PlaceableConstructible )\n    SpecializationUtil.registerEventListener(placeableType, "onInfoTriggerEnter" , PlaceableConstructible )\n    SpecializationUtil.registerEventListener(placeableType, "onInfoTriggerLeave" , PlaceableConstructible )\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registerfunctions",children:"registerFunctions"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerFunctions()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible.registerFunctions(placeableType)\n    SpecializationUtil.registerFunction(placeableType, "setConstructibleState" , PlaceableConstructible.setConstructibleState)\n    SpecializationUtil.registerFunction(placeableType, "finalizeConstruction" , PlaceableConstructible.finalizeConstruction)\n    SpecializationUtil.registerFunction(placeableType, "getConstructibleFillLevel" , PlaceableConstructible.getConstructibleFillLevel)\n    SpecializationUtil.registerFunction(placeableType, "getConstructibleSupportsFillType" , PlaceableConstructible.getConstructibleSupportsFillType)\n    SpecializationUtil.registerFunction(placeableType, "removeConstructibleFillLevel" , PlaceableConstructible.removeConstructibleFillLevel)\n    SpecializationUtil.registerFunction(placeableType, "getConstructibleStateIndexByName" , PlaceableConstructible.getConstructibleStateIndexByName)\n    SpecializationUtil.registerFunction(placeableType, "setConstructiblePreviewState" , PlaceableConstructible.setConstructiblePreviewState)\n    SpecializationUtil.registerFunction(placeableType, "getConstructibleStateIndex" , PlaceableConstructible.getConstructibleStateIndex)\n    SpecializationUtil.registerFunction(placeableType, "resetConstructibleToState" , PlaceableConstructible.resetConstructibleToState)\n    SpecializationUtil.registerFunction(placeableType, "consoleCommandFinishConstructionState" , PlaceableConstructible.consoleCommandFinishConstructionState)\n    SpecializationUtil.registerFunction(placeableType, "getNumFinishedConstructibleStates" , PlaceableConstructible.getNumFinishedConstructibleStates)\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registeroverwrittenfunctions",children:"registerOverwrittenFunctions"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerOverwrittenFunctions()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,i.jsx)(n.table,{children:(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"placeableType"})]})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible.registerOverwrittenFunctions(placeableType)\n    SpecializationUtil.registerOverwrittenFunction(placeableType, "collectPickObjects" , PlaceableConstructible.collectPickObjects)\n    SpecializationUtil.registerOverwrittenFunction(placeableType, "updateInfo" , PlaceableConstructible.updateInfo)\n    SpecializationUtil.registerOverwrittenFunction(placeableType, "setOwnerFarmId" , PlaceableConstructible.setOwnerFarmId)\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registersavegamexmlpaths",children:"registerSavegameXMLPaths"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerSavegameXMLPaths()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"schema"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"basePath"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible.registerSavegameXMLPaths(schema, basePath)\n    schema:register(XMLValueType.INT, basePath .. ".state#index" , "" )\n    schema:register(XMLValueType.STRING, basePath .. ".state#name" , "" )\n    ConstructibleStateBuilding.registerSavegameXMLPaths(schema, basePath)\n    Storage.registerSavegameXMLPaths(schema, basePath .. ".storage" )\nend\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"schema"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"basePath"})]})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible.registerXMLPaths(schema, basePath)\n    schema:setXMLSpecializationType( "Constructible" )\n\n    schema:register(XMLValueType.STRING, basePath .. ".constructible.stateMachine.states.state(?)#name" , "State name" )\n    schema:register(XMLValueType.STRING, basePath .. ".constructible.stateMachine.states.state(?)#class" , "State class" )\n    schema:register(XMLValueType.BOOL, basePath .. ".constructible.stateMachine.states.state(?)#isStartState" , "Marks a state as starting state" )\n    schema:register(XMLValueType.BOOL, basePath .. ".constructible.stateMachine.states.state(?)#isPreviewState" , "State is shown while placing the placeable or used in the icon generator" )\n        ConstructibleState.registerXMLPaths(schema, basePath .. ".constructible.stateMachine.states.state(?)" )\n        ConstructibleStateBuilding.registerXMLPaths(schema, basePath .. ".constructible.stateMachine.states.state(?)" )\n        ConstructibleStateFinalize.registerXMLPaths(schema, basePath .. ".constructible.stateMachine.states.state(?)" )\n\n        schema:register(XMLValueType.STRING, basePath .. ".constructible.stateMachine.transitions.transition(?)#from" , "State name from" )\n        schema:register(XMLValueType.STRING, basePath .. ".constructible.stateMachine.transitions.transition(?)#to" , "State name to" )\n\n        SellingStation.registerXMLPaths(schema, basePath .. ".constructible.sellingStation" )\n        Storage.registerXMLPaths(schema, basePath .. ".constructible.storage" )\n\n        schema:setXMLSpecializationType()\n    end\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"savetoxmlfile",children:"saveToXMLFile"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Definition"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"saveToXMLFile()"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"any"}),(0,i.jsx)(n.th,{children:"xmlFile"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"key"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"usedModNames"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Code"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lua",children:'function PlaceableConstructible:saveToXMLFile(xmlFile, key, usedModNames)\n    local spec = self.spec_constructible\n\n    if spec.stateIndex ~ = nil and spec.stateIndex > 0 then\n        local state = spec.stateMachine[spec.stateIndex]\n        xmlFile:setValue(key .. ".state#name" , state.name)\n\n        state:saveToXMLFile(xmlFile, key, usedModNames)\n    end\n\n    spec.storage:saveToXMLFile(xmlFile, key .. ".storage" )\nend\n\n'})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);