"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[13533],{28453(e,n,r){r.d(n,{R:()=>i,x:()=>d});var s=r(96540);const t={},l=s.createContext(t);function i(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(l.Provider,{value:n},e.children)}},35625(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"script/Wheels/WheelSteering","title":"WheelSteering","description":"WheelSteering","source":"@site/../docs/script/Wheels/WheelSteering.md","sourceDirName":"script/Wheels","slug":"/script/Wheels/WheelSteering","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelSteering","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"WheelPhysics","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelPhysics"},"next":{"title":"WheelVisual","permalink":"/FS25-Community-LUADOC/script/Wheels/WheelVisual"}}');var t=r(74848),l=r(28453);const i={},d=void 0,o={},c=[{value:"WheelSteering",id:"wheelsteering",level:2},{value:"loadFromXML",id:"loadfromxml",level:3},{value:"new",id:"new",level:3},{value:"registerXMLPaths",id:"registerxmlpaths",level:3},{value:"setSteeringValues",id:"setsteeringvalues",level:3},{value:"update",id:"update",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"wheelsteering",children:"WheelSteering"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Description"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Handles the steering related nodes (steering nodes, fender nodes)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Functions"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#loadfromxml",children:"loadFromXML"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#new",children:"new"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#registerxmlpaths",children:"registerXMLPaths"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#setsteeringvalues",children:"setSteeringValues"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#update",children:"update"})}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"loadfromxml",children:"loadFromXML"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Description"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Definition"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"loadFromXML()"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,t.jsx)(n.table,{children:(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"any"}),(0,t.jsx)(n.th,{children:"xmlObject"})]})})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Code"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'function WheelSteering:loadFromXML(xmlObject)\n    self.steeringNode = xmlObject:getValue( ".steering#node" , nil , self.vehicle.components, self.vehicle.i3dMappings)\n    self.steeringRotNode = xmlObject:getValue( ".steering#rotNode" , nil , self.vehicle.components, self.vehicle.i3dMappings)\n    self.steeringNodeMinTransX = xmlObject:getValue( ".steering#nodeMinTransX" )\n    self.steeringNodeMaxTransX = xmlObject:getValue( ".steering#nodeMaxTransX" )\n    self.steeringNodeMinRotY = xmlObject:getValue( ".steering#nodeMinRotY" )\n    self.steeringNodeMaxRotY = xmlObject:getValue( ".steering#nodeMaxRotY" )\n\n    self.fenders = { }\n\n    local i = 0\n    while true do\n        local fenderKey = string.format( ".fender(%d)" , i)\n        local xmlFile, _ = xmlObject:getXMLFileAndPropertyKey(fenderKey)\n        if xmlFile = = nil then\n            break\n        end\n\n        local entry = { }\n        entry.node = xmlObject:getValue(fenderKey .. "#node" , nil , self.vehicle.components, self.vehicle.i3dMappings)\n        if entry.node ~ = nil then\n            entry.rotMax = xmlObject:getValue(fenderKey .. "#rotMax" )\n            entry.rotMin = xmlObject:getValue(fenderKey .. "#rotMin" )\n\n            table.insert( self.fenders, entry)\n        end\n\n        i = i + 1\n    end\n\n    self.steeringAxleScale = xmlObject:getValue( ".steeringAxle#scale" , 0 )\n    self.steeringAxleRotMax = xmlObject:getValue( ".steeringAxle#rotMax" , 0 )\n    self.steeringAxleRotMin = xmlObject:getValue( ".steeringAxle#rotMin" , - 0 )\n\n    return true\nend\n\n'})}),"\n",(0,t.jsx)(n.h3,{id:"new",children:"new"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Description"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Definition"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"new()"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,t.jsx)(n.table,{children:(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"any"}),(0,t.jsx)(n.th,{children:"wheel"})]})})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Code"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"function WheelSteering.new(wheel)\n    local self = setmetatable( { } , { __index = WheelSteering } )\n\n    self.wheel = wheel\n    self.vehicle = wheel.vehicle\n\n    self.steeringNodeMaxRot = 1\n    self.steeringNodeMinRot = - 1\n\n    return self\nend\n\n"})}),"\n",(0,t.jsx)(n.h3,{id:"registerxmlpaths",children:"registerXMLPaths"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Description"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Definition"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"registerXMLPaths()"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"any"}),(0,t.jsx)(n.th,{children:"schema"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"key"})]})})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Code"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'function WheelSteering.registerXMLPaths(schema, key)\n    schema:register(XMLValueType.NODE_INDEX, key .. ".steering#node" , "Steering node" )\n    schema:register(XMLValueType.NODE_INDEX, key .. ".steering#rotNode" , "Steering rot node" )\n    schema:register(XMLValueType.FLOAT, key .. ".steering#nodeMinTransX" , "Min.X translation" )\n    schema:register(XMLValueType.FLOAT, key .. ".steering#nodeMaxTransX" , "Max.X translation" )\n    schema:register(XMLValueType.ANGLE, key .. ".steering#nodeMinRotY" , "Min.Y rotation" )\n    schema:register(XMLValueType.ANGLE, key .. ".steering#nodeMaxRotY" , "Max.Y rotation" )\n\n    schema:register(XMLValueType.NODE_INDEX, key .. ".fender(?)#node" , "Fender node" )\n    schema:register(XMLValueType.ANGLE, key .. ".fender(?)#rotMax" , "Max.rotation" )\n    schema:register(XMLValueType.ANGLE, key .. ".fender(?)#rotMin" , "Min.rotation" )\n\n    schema:register(XMLValueType.FLOAT, key .. ".steeringAxle#scale" , "Steering axle scale" )\n    schema:register(XMLValueType.ANGLE, key .. ".steeringAxle#rotMax" , "Max.rotation" )\n    schema:register(XMLValueType.ANGLE, key .. ".steeringAxle#rotMin" , "Min.rotation" )\nend\n\n'})}),"\n",(0,t.jsx)(n.h3,{id:"setsteeringvalues",children:"setSteeringValues"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Description"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Definition"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"setSteeringValues()"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"any"}),(0,t.jsx)(n.th,{children:"rotMin"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"rotMax"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"rotSpeed"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"rotSpeedNeg"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"inverted"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Code"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"function WheelSteering:setSteeringValues(rotMin, rotMax, rotSpeed, rotSpeedNeg, inverted)\n    if self.steeringAxleScale ~ = 0 then\n        if inverted then\n            self.steeringAxleScale = - self.steeringAxleScale\n        end\n\n        self.steeringAxleRotMax = rotMax\n        self.steeringAxleRotMin = rotMin\n    end\n\n    for i = 1 , # self.fenders do\n        local fender = self.fenders[i]\n\n        fender.rotMax = fender.rotMax or rotMax\n        fender.rotMin = fender.rotMin or rotMin\n    end\n\n    self.steeringNodeMaxRot = math.max(rotMax, self.steeringAxleRotMax)\n    self.steeringNodeMinRot = math.min(rotMin, self.steeringAxleRotMin)\nend\n\n"})}),"\n",(0,t.jsx)(n.h3,{id:"update",children:"update"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Description"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Definition"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"update()"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"any"}),(0,t.jsx)(n.th,{children:"x"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"y"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"z"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"xDrive"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"suspensionLength"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"steeringAngle"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"any"}),(0,t.jsx)(n.td,{children:"changed"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Code"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"function WheelSteering:update(x, y, z, xDrive, suspensionLength, steeringAngle, changed)\n    if self.steeringNode ~ = nil then\n        local refAngle = self.steeringNodeMaxRot\n        local refTrans = self.steeringNodeMaxTransX\n        local refRot = self.steeringNodeMaxRotY\n        if steeringAngle < 0 then\n            refAngle = self.steeringNodeMinRot\n            refTrans = self.steeringNodeMinTransX\n            refRot = self.steeringNodeMinRotY\n        end\n\n        local steeringValue = 0\n        if refAngle ~ = 0 then\n            steeringValue = steeringAngle / refAngle\n        end\n\n        if self.steeringNodeMinTransX ~ = nil then\n            local _, sny, snz = getTranslation( self.steeringNode)\n            local snx = refTrans * steeringValue\n            setTranslation( self.steeringNode, snx, sny, snz)\n        end\n\n        if self.steeringNodeMinRotY ~ = nil then\n            local rotX, _, rotZ = getRotation( self.steeringRotNode or self.steeringNode)\n            local rotY = refRot * steeringValue\n            setRotation( self.steeringRotNode or self.steeringNode, rotX, rotY, rotZ)\n        end\n    end\n\n    for i = 1 , # self.fenders do\n        local fender = self.fenders[i]\n\n        local angleDif = 0\n        if steeringAngle > fender.rotMax then\n            angleDif = fender.rotMax - steeringAngle\n        elseif steeringAngle < fender.rotMin then\n                angleDif = fender.rotMin - steeringAngle\n            end\n\n            setRotation(fender.node, 0 , angleDif, 0 )\n        end\n    end\n\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);