"use strict";(globalThis.webpackChunkfs25_community_luadoc=globalThis.webpackChunkfs25_community_luadoc||[]).push([[61680],{28453(e,n,i){i.d(n,{R:()=>r,x:()=>a});var l=i(96540);const s={},t=l.createContext(s);function r(e){const n=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),l.createElement(t.Provider,{value:n},e.children)}},46248(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"script/Jobs/AIJobDeliver","title":"AIJobDeliver","description":"AIJobDeliver","source":"@site/../docs/script/Jobs/AIJobDeliver.md","sourceDirName":"script/Jobs","slug":"/script/Jobs/AIJobDeliver","permalink":"/FS25-Community-LUADOC/script/Jobs/AIJobDeliver","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1767161192000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"AIJobConveyor","permalink":"/FS25-Community-LUADOC/script/Jobs/AIJobConveyor"},"next":{"title":"AIJobFieldWork","permalink":"/FS25-Community-LUADOC/script/Jobs/AIJobFieldWork"}}');var s=i(74848),t=i(28453);const r={},a=void 0,d={},o=[{value:"AIJobDeliver",id:"aijobdeliver",level:2},{value:"applyCurrentState",id:"applycurrentstate",level:3},{value:"canContinueWork",id:"cancontinuework",level:3},{value:"getCanSkipTask",id:"getcanskiptask",level:3},{value:"getDescription",id:"getdescription",level:3},{value:"getHasLoadedValidFillType",id:"gethasloadedvalidfilltype",level:3},{value:"getIsAvailableForVehicle",id:"getisavailableforvehicle",level:3},{value:"getIsLooping",id:"getislooping",level:3},{value:"getIsStartable",id:"getisstartable",level:3},{value:"getIsStartErrorText",id:"getisstarterrortext",level:3},{value:"getNextTaskIndex",id:"getnexttaskindex",level:3},{value:"getStartTaskIndex",id:"getstarttaskindex",level:3},{value:"getTitle",id:"gettitle",level:3},{value:"new",id:"new",level:3},{value:"setValues",id:"setvalues",level:3},{value:"skipCurrentTask",id:"skipcurrenttask",level:3},{value:"start",id:"start",level:3},{value:"startTask",id:"starttask",level:3},{value:"stop",id:"stop",level:3},{value:"validate",id:"validate",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"aijobdeliver",children:"AIJobDeliver"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parent"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"?version=script&category=54&class=543",children:"AIJob"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Functions"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#applycurrentstate",children:"applyCurrentState"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#cancontinuework",children:"canContinueWork"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getcanskiptask",children:"getCanSkipTask"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getdescription",children:"getDescription"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#gethasloadedvalidfilltype",children:"getHasLoadedValidFillType"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getisavailableforvehicle",children:"getIsAvailableForVehicle"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getislooping",children:"getIsLooping"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getisstartable",children:"getIsStartable"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getisstarterrortext",children:"getIsStartErrorText"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getnexttaskindex",children:"getNextTaskIndex"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#getstarttaskindex",children:"getStartTaskIndex"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#gettitle",children:"getTitle"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#new",children:"new"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#setvalues",children:"setValues"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#skipcurrenttask",children:"skipCurrentTask"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#start",children:"start"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#starttask",children:"startTask"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#stop",children:"stop"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#validate",children:"validate"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"applycurrentstate",children:"applyCurrentState"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"applyCurrentState()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"vehicle"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"any"}),(0,s.jsx)(n.td,{children:"mission"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"any"}),(0,s.jsx)(n.td,{children:"farmId"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"any"}),(0,s.jsx)(n.td,{children:"isDirectStart"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:applyCurrentState(vehicle, mission, farmId, isDirectStart)\n    AIJobDeliver:superClass().applyCurrentState( self , vehicle, mission, farmId, isDirectStart)\n\n    self.vehicleParameter:setVehicle(vehicle)\n    self.loopingParameter:setIsLooping( true )\n\n    local x, z, angle, _\n    if vehicle.getLastJob ~ = nil then\n        local lastJob = vehicle:getLastJob()\n        if lastJob ~ = nil and lastJob:isa( AIJobDeliver ) then\n            self.unloadingStationParameter:setUnloadingStation(lastJob.unloadingStationParameter:getUnloadingStation())\n            self.loopingParameter:setIsLooping(lastJob.loopingParameter:getIsLooping())\n            x, z = lastJob.positionAngleParameter:getPosition()\n            angle = lastJob.positionAngleParameter:getAngle()\n        end\n    end\n\n    if x = = nil or z = = nil then\n        x, _, z = getWorldTranslation(vehicle.rootNode)\n    end\n    if angle = = nil then\n        local dirX, _, dirZ = localDirectionToWorld(vehicle.rootNode, 0 , 0 , 1 )\n        angle = MathUtil.getYRotationFromDirection(dirX, dirZ)\n    end\n\n    self.positionAngleParameter:setPosition(x, z)\n    self.positionAngleParameter:setAngle(angle)\n\n    local unloadingStations = { }\n    for _, unloadingStation in pairs(g_currentMission.storageSystem:getUnloadingStations()) do\n        if g_currentMission.accessHandler:canPlayerAccess(unloadingStation) and unloadingStation:isa( UnloadingStation ) then\n            local fillTypes = unloadingStation:getAISupportedFillTypes()\n            if next(fillTypes) ~ = nil then\n                table.insert(unloadingStations, unloadingStation)\n            end\n        end\n    end\n\n    table.sort(unloadingStations, function (a, b) return a:getName() < b:getName() end )\n    self.unloadingStationParameter:setValidUnloadingStations(unloadingStations)\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"cancontinuework",children:"canContinueWork"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"canContinueWork()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:canContinueWork()\n    local vehicle = self.vehicleParameter:getVehicle()\n    if vehicle = = nil then\n        return false , AIMessageErrorVehicleDeleted.new()\n    end\n\n    local unloadingStation = self.unloadingStationParameter:getUnloadingStation()\n    if unloadingStation = = nil then\n        return false , AIMessageErrorUnloadingStationDeleted.new()\n    end\n\n    -- check if unloading station is full\n        if self.currentTaskIndex = = self.waitForFillingTask.taskIndex then\n            local hasSpace = false\n\n            for _, dischargeNodeInfo in ipairs( self.dischargeNodeInfos) do\n                local dischargeVehicle = dischargeNodeInfo.vehicle\n                local fillUnitIndex = dischargeNodeInfo.dischargeNode.fillUnitIndex\n                if dischargeVehicle:getFillUnitFillLevel(fillUnitIndex) > 1 then\n                    local fillTypeIndex = dischargeVehicle:getFillUnitFillType(fillUnitIndex)\n                    if unloadingStation:getFreeCapacity(fillTypeIndex, self.startedFarmId) > 0 then\n                        hasSpace = true\n                        break\n                    end\n                end\n            end\n\n            if not hasSpace then\n                return false , AIMessageErrorUnloadingStationFull.new()\n            end\n        end\n\n        return true , nil\n    end\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getcanskiptask",children:"getCanSkipTask"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getCanSkipTask()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:getCanSkipTask()\n    if self.currentTaskIndex = = self.waitForFillingTask.taskIndex and not self.waitForFillingTask.isFinished then\n        if self:getHasLoadedValidFillType() then\n            return true\n        end\n    end\n\n    return false\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getdescription",children:"getDescription"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getDescription()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function AIJobDeliver:getDescription()\n    local desc = AIJobDeliver:superClass().getDescription( self )\n\n    local nextTask = self:getTaskByIndex( self.currentTaskIndex)\n    if nextTask = = self.driveToLoadingTask then\n        desc = desc .. " - " .. g_i18n:getText( "ai_taskDescriptionDriveToLoadingStation" )\n    elseif nextTask = = self.waitForFillingTask then\n            desc = desc .. " - " .. g_i18n:getText( "ai_taskDescriptionWaitForFilling" )\n        elseif nextTask = = self.driveToUnloadingTask then\n                desc = desc .. " - " .. g_i18n:getText( "ai_taskDescriptionDriveToUnloadingStation" )\n            elseif nextTask = = self.dischargeTask then\n                    desc = desc .. " - " .. g_i18n:getText( "ai_taskDescriptionUnloading" )\n                end\n\n                return desc\n            end\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"gethasloadedvalidfilltype",children:"getHasLoadedValidFillType"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getHasLoadedValidFillType()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:getHasLoadedValidFillType()\n    local unloadingStation = self.unloadingStationParameter:getUnloadingStation()\n\n    for _, dischargeNodeInfo in ipairs( self.dischargeNodeInfos) do\n        local vehicle = dischargeNodeInfo.vehicle\n        local fillUnitIndex = dischargeNodeInfo.dischargeNode.fillUnitIndex\n        if vehicle:getFillUnitFillLevel(fillUnitIndex) > 1 then\n            local fillType = vehicle:getFillUnitFillType(fillUnitIndex)\n            if unloadingStation:getIsFillTypeAISupported(fillType) then\n                return true\n            end\n        end\n    end\n\n    return false\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getisavailableforvehicle",children:"getIsAvailableForVehicle"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getIsAvailableForVehicle()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"vehicle"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:getIsAvailableForVehicle(vehicle)\n    if vehicle.createAgent = = nil or vehicle.setAITarget = = nil or not vehicle:getCanStartAIVehicle() then\n        return false\n    end\n\n    if not vehicle:getIsAIJobSupported(ClassUtil.getClassNameByObject( self )) then\n        return false\n    end\n\n    if vehicle.getAIDischargeNodes ~ = nil then\n        local nodes = vehicle:getAIDischargeNodes()\n        if next(nodes) ~ = nil then\n            return true\n        end\n    end\n\n    local vehicles = vehicle:getChildVehicles()\n    for _, childVehicle in ipairs(vehicles) do\n        if childVehicle.getAIDischargeNodes ~ = nil then\n            local nodes = childVehicle:getAIDischargeNodes()\n            if next(nodes) ~ = nil then\n                return true\n            end\n        end\n    end\n\n    return false\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getislooping",children:"getIsLooping"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getIsLooping()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:getIsLooping()\n    return self.loopingParameter:getIsLooping()\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getisstartable",children:"getIsStartable"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getIsStartable()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"connection"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function AIJobDeliver:getIsStartable(connection)\n    if g_currentMission.aiSystem:getAILimitedReached() then\n        return false , AIJobDeliver.START_ERROR_LIMIT_REACHED\n    end\n\n    local vehicle = self.vehicleParameter:getVehicle()\n    if vehicle = = nil then\n        return false , AIJobDeliver.START_ERROR_VEHICLE_DELETED\n    end\n\n    if not g_currentMission:getHasPlayerPermission( "hireAssistant" , connection, vehicle:getOwnerFarmId()) then\n        return false , AIJobDeliver.START_ERROR_NO_PERMISSION\n    end\n\n    if vehicle:getIsInUse(connection) then\n        return false , AIJobDeliver.START_ERROR_VEHICLE_IN_USE\n    end\n\n    return true , AIJob.START_SUCCESS\nend\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"getisstarterrortext",children:"getIsStartErrorText"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getIsStartErrorText()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"state"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function AIJobDeliver.getIsStartErrorText(state)\n    if state = = AIJobDeliver.START_ERROR_LIMIT_REACHED then\n        return g_i18n:getText( "ai_startStateLimitReached" )\n    elseif state = = AIJobDeliver.START_ERROR_VEHICLE_DELETED then\n            return g_i18n:getText( "ai_startStateVehicleDeleted" )\n        elseif state = = AIJobDeliver.START_ERROR_NO_PERMISSION then\n                return g_i18n:getText( "ai_startStateNoPermission" )\n            elseif state = = AIJobDeliver.START_ERROR_VEHICLE_IN_USE then\n                    return g_i18n:getText( "ai_startStateVehicleInUse" )\n                end\n\n                return g_i18n:getText( "ai_startStateSuccess" )\n            end\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"getnexttaskindex",children:"getNextTaskIndex"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getNextTaskIndex()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"isSkipTask"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function AIJobDeliver:getNextTaskIndex(isSkipTask)\n    if self.currentTaskIndex = = self.waitForFillingTask.taskIndex or self.currentTaskIndex = = self.dischargeTask.taskIndex then\n        local lastUnloadTrigger\n        if self.currentTaskIndex = = self.dischargeTask.taskIndex then\n            lastUnloadTrigger = self.dischargeTask.unloadTrigger\n        end\n\n        -- check if there are more dischargeNodes that need discharge to the last unloadtrigger\n            local nextFillType = nil\n            local nextDischargeNodeInfo = nil\n            local unloadingStation = self.unloadingStationParameter:getUnloadingStation()\n            for _, dischargeNodeInfo in ipairs( self.dischargeNodeInfos) do\n                if dischargeNodeInfo.dirty then\n                    local vehicle = dischargeNodeInfo.vehicle\n                    local fillUnitIndex = dischargeNodeInfo.dischargeNode.fillUnitIndex\n                    if vehicle:getFillUnitFillLevel(fillUnitIndex) > 1 then\n                        local currentFillType = vehicle:getFillUnitFillType(fillUnitIndex)\n                        if lastUnloadTrigger ~ = nil and lastUnloadTrigger:getIsFillTypeSupported(currentFillType) then\n                            self.dischargeTask:setDischargeNode(vehicle, dischargeNodeInfo.dischargeNode, dischargeNodeInfo.offsetZ)\n                            dischargeNodeInfo.dirty = false\n                            --#debug log("drive to discharge next trailer")\n                            return self.currentTaskIndex\n\n                        elseif nextFillType = = nil then\n                                local _, _, _, _, trigger = unloadingStation:getAITargetPositionAndDirection(currentFillType)\n                                if trigger ~ = nil then\n                                    nextFillType = currentFillType\n                                    nextDischargeNodeInfo = dischargeNodeInfo\n                                else\n                                        -- unloading station does not support fill type.mark node as handled\n                                        dischargeNodeInfo.dirty = false\n                                    end\n                                end\n                            end\n                        end\n                    end\n\n                    if nextFillType ~ = nil then\n                        --#debug log("Next index drive to uinloading", g_fillTypeManager:getFillTypeNameByIndex(nextFillType))\n                        local x, z, dirX, dirZ, trigger = unloadingStation:getAITargetPositionAndDirection(nextFillType)\n                        self.driveToUnloadingTask:setTargetPosition(x, z)\n                        self.driveToUnloadingTask:setTargetDirection(dirX, dirZ)\n                        self.dischargeTask:setUnloadTrigger(trigger)\n                        self.dischargeTask:setDischargeNode(nextDischargeNodeInfo.vehicle, nextDischargeNodeInfo.dischargeNode, nextDischargeNodeInfo.offsetZ)\n                        nextDischargeNodeInfo.dirty = false\n\n                        return self.driveToUnloadingTask.taskIndex\n                    end\n                end\n\n                local nextTaskIndex = AIJobDeliver:superClass().getNextTaskIndex( self , isSkipTask)\n                --#debug log("Other: ", self.currentTaskIndex, "->", nextTaskIndex)\n                return nextTaskIndex\n            end\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"getstarttaskindex",children:"getStartTaskIndex"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getStartTaskIndex()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:getStartTaskIndex()\n    local hasOneEmptyFillUnit = false\n    for _, dischargeNodeInfo in ipairs( self.dischargeNodeInfos) do\n        local vehicle = dischargeNodeInfo.vehicle\n        local fillUnitIndex = dischargeNodeInfo.dischargeNode.fillUnitIndex\n        if vehicle:getFillUnitFillLevel(fillUnitIndex) = = 0 then\n            hasOneEmptyFillUnit = true\n            break\n        end\n    end\n\n    -- check if already at target position\n        local vehicle = self.vehicleParameter:getVehicle()\n        local x, _, z = getWorldTranslation(vehicle.rootNode)\n        local tx, tz = self.positionAngleParameter:getPosition()\n        local targetReached = math.abs(x - tx) < 1 and math.abs(z - tz) < 1\n        if targetReached then\n            if not hasOneEmptyFillUnit then\n                self.waitForFillingTask:skip()\n            end\n            return self.waitForFillingTask.taskIndex\n        end\n\n        if not hasOneEmptyFillUnit then\n            self.driveToLoadingTask:skip()\n            self.waitForFillingTask:skip()\n        end\n\n        return self.driveToLoadingTask.taskIndex\n    end\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"gettitle",children:"getTitle"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"getTitle()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function AIJobDeliver:getTitle()\n    local vehicle = self.vehicleParameter:getVehicle()\n    if vehicle ~ = nil then\n        return vehicle:getName()\n    end\n\n    return ""\nend\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"new",children:"new"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"new()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"isServer"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"any"}),(0,s.jsx)(n.td,{children:"customMt"})]})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function AIJobDeliver.new(isServer, customMt)\n    local self = AIJob.new(isServer, customMt or AIJobDeliver _mt)\n\n    self.dischargeNodeInfos = { }\n\n    self.driveToLoadingTask = AITaskDriveTo.new(isServer, self )\n    self.waitForFillingTask = AITaskWaitForFilling.new(isServer, self )\n    self.driveToUnloadingTask = AITaskDriveTo.new(isServer, self )\n    self.dischargeTask = AITaskDischarge.new(isServer, self )\n\n    self:addTask( self.driveToLoadingTask)\n    self:addTask( self.waitForFillingTask)\n    self:addTask( self.driveToUnloadingTask)\n    self:addTask( self.dischargeTask)\n\n    self.vehicleParameter = AIParameterVehicle.new()\n    self.unloadingStationParameter = AIParameterUnloadingStation.new()\n    self.loopingParameter = AIParameterLooping.new()\n    self.positionAngleParameter = AIParameterPositionAngle.new( math.rad( 5 ))\n\n    self:addNamedParameter( "vehicle" , self.vehicleParameter)\n    self:addNamedParameter( "unloadingStation" , self.unloadingStationParameter)\n    self:addNamedParameter( "looping" , self.loopingParameter)\n    self:addNamedParameter( "positionAngle" , self.positionAngleParameter)\n\n    local vehicleGroup = AIParameterGroup.new(g_i18n:getText( "ai_parameterGroupTitleVehicle" ))\n    vehicleGroup:addParameter( self.vehicleParameter)\n\n    local unloadTargetGroup = AIParameterGroup.new(g_i18n:getText( "ai_parameterGroupTitleUnloadingStation" ))\n    unloadTargetGroup:addParameter( self.unloadingStationParameter)\n\n    local positionGroup = AIParameterGroup.new(g_i18n:getText( "ai_parameterGroupTitleLoadingPosition" ))\n    positionGroup:addParameter( self.positionAngleParameter)\n\n    local loopingGroup = AIParameterGroup.new(g_i18n:getText( "ai_parameterGroupTitleLooping" ))\n    loopingGroup:addParameter( self.loopingParameter)\n\n    table.insert( self.groupedParameters, vehicleGroup)\n    table.insert( self.groupedParameters, unloadTargetGroup)\n    table.insert( self.groupedParameters, positionGroup)\n    table.insert( self.groupedParameters, loopingGroup)\n\n    return self\nend\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"setvalues",children:"setValues"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"setValues()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:setValues()\n    self:resetTasks()\n\n    local vehicle = self.vehicleParameter:getVehicle()\n    if vehicle = = nil then\n        return\n    end\n    local unloadingStation = self.unloadingStationParameter:getUnloadingStation()\n    if unloadingStation = = nil then\n        return\n    end\n\n    self.driveToUnloadingTask:setVehicle(vehicle)\n    self.driveToLoadingTask:setVehicle(vehicle)\n    self.dischargeTask:setVehicle(vehicle)\n    self.waitForFillingTask:setVehicle(vehicle)\n\n    self.dischargeNodeInfos = { }\n\n    -- apply allowed fill types based on unloading trigger\n    for fillType, _ in pairs(unloadingStation:getAISupportedFillTypes()) do\n        self.waitForFillingTask:addAllowedFillType(fillType)\n    end\n\n    if vehicle.getAIDischargeNodes ~ = nil then\n        for _, dischargeNode in ipairs(vehicle:getAIDischargeNodes()) do\n\n            local _, _, z = vehicle:getAIDischargeNodeZAlignedOffset(dischargeNode, vehicle)\n            table.insert( self.dischargeNodeInfos, { vehicle = vehicle, dischargeNode = dischargeNode, offsetZ = z, dirty = true } )\n        end\n    end\n\n    local childVehicles = vehicle:getChildVehicles()\n    for _, childVehicle in ipairs(childVehicles) do\n        if childVehicle.getAIDischargeNodes ~ = nil then\n            for _, dischargeNode in ipairs(childVehicle:getAIDischargeNodes()) do\n                local _, _, z = childVehicle:getAIDischargeNodeZAlignedOffset(dischargeNode, vehicle)\n                table.insert( self.dischargeNodeInfos, { vehicle = childVehicle, dischargeNode = dischargeNode, offsetZ = z, dirty = true } )\n            end\n        end\n    end\n\n    if # self.dischargeNodeInfos = = 0 then\n        return\n    end\n\n    table.sort( self.dischargeNodeInfos, function (a, b)\n        return a.offsetZ > b.offsetZ\n    end )\n\n    for _, dischargeNodeInfo in ipairs( self.dischargeNodeInfos) do\n        self.waitForFillingTask:addFillUnits(dischargeNodeInfo.vehicle, dischargeNodeInfo.dischargeNode.fillUnitIndex)\n    end\n\n    local maxOffset = self.dischargeNodeInfos[# self.dischargeNodeInfos].offsetZ\n    self.driveToLoadingTask:setTargetOffset( - maxOffset)\n    self.driveToUnloadingTask:setTargetOffset( - maxOffset)\n\n    local x, z = self.positionAngleParameter:getPosition()\n    if x ~ = nil then\n        self.driveToLoadingTask:setTargetPosition(x, z)\n    end\n    local xDir, zDir = self.positionAngleParameter:getDirection()\n    if xDir ~ = nil then\n        self.driveToLoadingTask:setTargetDirection(xDir, zDir)\n    end\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"skipcurrenttask",children:"skipCurrentTask"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"skipCurrentTask()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:skipCurrentTask()\n    if self.currentTaskIndex = = self.waitForFillingTask.taskIndex then\n        self.waitForFillingTask:skip()\n    end\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"start",children:"start"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"start()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"farmId"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:start(farmId)\n    -- Client start notification will be done by vehicle\n    AIJobDeliver:superClass().start( self , farmId)\n\n    if self.isServer then\n        local vehicle = self.vehicleParameter:getVehicle()\n        vehicle:createAgent( self.helperIndex)\n        vehicle:aiJobStarted( self , self.helperIndex, farmId)\n    end\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"starttask",children:"startTask"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"startTask()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"task"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:startTask(task)\n    -- mark all discharge infos as dirty\n    if task = = self.waitForFillingTask then\n        for _, dischargeNodeInfo in ipairs( self.dischargeNodeInfos) do\n            dischargeNodeInfo.dirty = true\n        end\n    end\n\n    AIJobDeliver:superClass().startTask( self , task)\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"stop",children:"stop"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"stop()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"aiMessage"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function AIJobDeliver:stop(aiMessage)\n    -- Client stop notifcation will be done by vehicle\n    if self.isServer then\n        local vehicle = self.vehicleParameter:getVehicle()\n        vehicle:deleteAgent()\n        vehicle:aiJobFinished()\n    end\n\n    AIJobDeliver:superClass().stop( self , aiMessage)\n\n    self.dischargeNodeInfos = { }\nend\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"validate",children:"validate"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Description"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Definition"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"validate()"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Arguments"})}),"\n\n\n\n\n\n\n\n",(0,s.jsx)(n.table,{children:(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"any"}),(0,s.jsx)(n.th,{children:"farmId"})]})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function AIJobDeliver:validate(farmId)\n    self:setParameterValid( true )\n\n    local isVehicleValid, vehicleErrorMessage = self.vehicleParameter:validate()\n    if isVehicleValid then\n        if # self.dischargeNodeInfos = = 0 then\n            isVehicleValid = false\n            vehicleErrorMessage = g_i18n:getText( "ai_validationErrorNoAIDischargeNodesFound" )\n        end\n    end\n    if not isVehicleValid then\n        self.vehicleParameter:setIsValid( false )\n    end\n\n    local isUnloadingStationValid, unloadingStationErrorMessage = self.unloadingStationParameter:validate()\n    if not isUnloadingStationValid then\n        self.unloadingStationParameter:setIsValid( false )\n    end\n\n    local isPositionValid, positionErrorMessage = self.positionAngleParameter:validate()\n    if not isPositionValid then\n        positionErrorMessage = g_i18n:getText( "ai_validationErrorNoLoadingPoint" )\n        self.positionAngleParameter:setIsValid( false )\n    end\n\n    local isValid = isVehicleValid and isUnloadingStationValid and isPositionValid\n    local errorMessage = vehicleErrorMessage or unloadingStationErrorMessage or positionErrorMessage\n\n    return isValid, errorMessage\nend\n\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);